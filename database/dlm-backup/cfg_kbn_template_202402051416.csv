"template_id","template_module","template_no","template_name","template_content","enabled","update_user","update_time"
"9S-NFYvYSF67gllnGKVFo6",mes-sole,sole_style6,Type6:現場-投產狀況(by 模號),"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""target"":{""limit"":100,""matchAny"":false,""tags"":[],""type"":""dashboard""},""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":1341,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":15,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\r\n    <p class=\""active\"" id =\""sole\""></p>\r\n    <p id =\""clock\""></p>\r\n</ul>\r\n\r\n\r\n\r\n<script>\r\n  \r\n  var WorkShift = \""$WorkShift\"";\r\n  var n = 8; // 取前三位\r\n  var resultWorkShift = WorkShift.slice(-n);\r\n  document.getElementById(\""sole\"").innerText =\""\\xa0\\xa0\"" + \""${lang_mold_production_status} /\"" + \""\\xa0\\xa0\"" +  \""${ProductKind}_\"" + resultWorkShift;\r\n\r\n    ///右側時間\r\n    $(\""#clock\"").ready(function(){\r\n        updateClock();\r\n    });\r\n\r\n    function updateClock(){\r\n        let d = new Date();\r\n        let year = d.getFullYear();\r\n        let month = pad(d.getMonth()+1);\r\n        let day = pad(d.getDate());\r\n        $(\""#clock\"").html(year+\""/\""+month+\""/\""+day+\"" \""+\""\\xa0\\xa0\\xa0\"");\r\n    }\r\n\r\n    function pad(v){\r\n        return (v<10)?'0'+v:v\r\n    }    \r\n\r\n\r\n</script>\r\n\r\n\r\n\r\n\r\n<style type=\""text/css\"">\r\n    .example {\r\n        overflow: hidden;\r\n        background: #A7B6E2;\r\n        height: 160px;\r\n        padding: 0;\r\n        line-height: 160px;\r\n        color: #2B4182;\r\n        font-weight:bold;\r\n        font-size:60px;\r\n        margin:0px 0px 0px -24px; /*上右下左*/\r\n    }\r\n\r\n    .example > p {\r\n        float: left;\r\n        position: relative;\r\n        width: 50%;\r\n        text-align: right;\r\n        list-style: none;\r\n        height: 100%;\r\n    }\r\n\r\n    .example > p:before, .example > p:after {\r\n        position: absolute;\r\n        top: 0;\r\n    }\r\n\r\n    .example > p:before {\r\n        width: 160px;\r\n        height: 160px;\r\n        right: -159px;\r\n        background: inherit;\r\n    }\r\n\r\n    .example > p:after {\r\n        right: -160px;\r\n        border: 80px solid;\r\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\r\n        \r\n    }\r\n\r\n    .example > p.active {\r\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\r\n        text-align: left;\r\n        color:#FCEC03;\r\n    }\r\n\r\n    .example > p.active:before, .example > p.active:after {\r\n        content: '';\r\n        \r\n    }\r\n</style>\r\n"",""mode"":""html""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":4,""y"":5},""id"":13,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:85px; color:White; background-color:#FACC2E;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_over_target}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":9,""y"":5},""id"":16,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:90px; color:White; background-color:#04B404; text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_completed}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":14,""y"":5},""id"":17,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:100px; color:White; background-color:rgb(84, 112, 198);  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_ongoing}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":19,""y"":5},""id"":18,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:92px; color:White; background-color:#BDBDBD;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_not_start}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""gridPos"":{""h"":23,""w"":24,""x"":0,""y"":10},""id"":24,""options"":{""content"":""<table class=\""PcgTable\"">\r\n  <tr class=\""Pcgcolumn\"">\r\n    <td>{{ variable \""lang_mold\"" }}</td>\r\n    <td>{{ variable \""lang_target_qty\"" }} </td>\r\n    <td>{{ variable \""lang_shortage\"" }}</td>\r\n    <td>{{ variable \""lang_achieve_rate\"" }}</td>\r\n    <td>{{ variable \""lang_product_progress\"" }}</td>\r\n  </tr>\r\n\r\n  {{#each data}}\r\n  <tr class=\""Pcgcolumn1\"">\r\n    <td>{{mold}}</td>\r\n    <td>{{formatnumber target}}</td>\r\n    <td>{{formatnumber shortage}}</td>\r\n    <td>{{formatpercent archieverate}}</td>\r\n    <td>\r\n      <div class=\""bar-chart-cell\"">\r\n        <div\r\n          class=\""bar-chart-bar {{#if (eq outputs target)}}green{{else}}{{#if (gt outputs target)}}yellow{{else}}blue{{/if}}{{/if}}\""\r\n          style=\""--progress: {{outputs}} / {{target}};\"">\r\n          {{#if outputs}}\r\n          <div class=\""bar-chart-value\"">{{outputs}}</div>\r\n          {{/if}}\r\n        </div>\r\n      </div>\r\n    </td>\r\n  </tr>\r\n  {{/each}}\r\n\r\n</table>\r\n\r\n<style>\r\n  /* 設定表格的樣式 */\r\n  table {\r\n    font-size: 100px;\r\n    width: auto;\r\n    border-collapse: collapse;\r\n  }\r\n\r\n  /* 設定表格頭部和資料行的共用樣式 */\r\n  th,\r\n  td {\r\n    border: 3px solid white;\r\n    border-collapse: collapse;\r\n    width: auto;\r\n    font-weight: bold;\r\n    padding: 8px;\r\n    text-align: center;\r\n  }\r\n\r\n  /* 設定整個表格的樣式 */\r\n  .PcgTable {\r\n    width: 100%;\r\n    height: auto;\r\n    font-size: 80px;\r\n    text-align: center;\r\n  }\r\n\r\n  /* 設定表格頭部的樣式 */\r\n  .Pcgcolumn {\r\n    background-color: rgb(84, 112, 198);\r\n    color: white;\r\n    height: auto;\r\n  }\r\n\r\n  /* 設定表格資料行的樣式 */\r\n  .Pcgcolumn1 {\r\n    color: white;\r\n    height: auto;\r\n  }\r\n\r\n  /* 設定長條圖區塊的樣式 */\r\n  .bar-chart-cell {\r\n    position: relative;\r\n    display: flex;\r\n    align-items: center;\r\n    height: 60px;\r\n    background-color: gray;\r\n    border-radius: 10px;\r\n  }\r\n\r\n  /* 設定長條圖的樣式 */\r\n  .bar-chart-bar {\r\n    position: relative;\r\n    height: 100%;\r\n    background-color: #3498db;\r\n    width: 0;\r\n    transition: width 0.5s ease-in-out;\r\n    animation: fillBar 1s ease-in-out forwards;\r\n  }\r\n\r\n  /* 設定長條圖數值的樣式 */\r\n  .bar-chart-value {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    font-weight: bold;\r\n    color: white;\r\n    transition: left 0.5s ease-in-out;\r\n  }\r\n\r\n  /* 設定長條圖為綠色的樣式 */\r\n  .bar-chart-bar.green {\r\n    background-color: #2ecc71;\r\n  }\r\n\r\n  /* 設定長條圖為黃色的樣式 */\r\n  .bar-chart-bar.yellow {\r\n    background-color: #f1c40f;\r\n  }\r\n\r\n  /* 設定長條圖為藍色的樣式 */\r\n  .bar-chart-bar.blue {\r\n    background-color: #3498db;\r\n  }\r\n\r\n  /* 調整 Productprogress 欄位寬度 */\r\n\r\n  td:nth-child(5) {\r\n    width: 50%;\r\n  }\r\n\r\n  /* 調整 Mold 欄位寬度 */\r\n  /*\r\n  td:nth-child(1) {\r\n    width: 15%;\r\n  }\r\n\r\n  td:nth-child(4) {\r\n    width: 25%;\r\n  }\r\n  */\r\n\r\n\r\n  @keyframes fillBar {\r\n    from {\r\n      width: 0;\r\n    }\r\n\r\n    to {\r\n      width: calc(var(--progress) * 100%);\r\n    }\r\n  }\r\n</style>"",""defaultContent"":""<div direction=\""right\"" height=\""150px\"" behavior=\""alternate\"">\r\n  <p style=\""font-size:100px; color:black; background-color:red;  text-align:center; font-weight:bold;\"">\r\n  No Produce Data</p>\r\n</div>"",""editor"":{""format"":""auto"",""height"":240,""language"":""html""},""everyRow"":false,""helpers"":""// 實現千分位\r\nhandlebars.registerHelper('formatnumber', function (num) {\r\n     if (num === undefined) {\r\n          return '';\r\n     }\r\n     num = num + '';\r\n     return num.replace(/(?=(?!^)(?:\\d{3})+(?:\\.|$))(\\d{3}(\\.\\d+$)?)/g, ',$1');\r\n});\r\n\r\n//實現%\r\nhandlebars.registerHelper('formatpercent', function (num) {\r\n     num = num + '%';\r\n     return num;\r\n});""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""WITH Temp1 as(\r\n  select mold,SPLIT_PART(workshift, '_', 3) AS workshift, sum(target)target  from kbn_sole_target where\r\n     workdate=(select to_char(current_date, 'YYYYMMDD'))\r\n     and datagroup IN ($Datagroup)\r\n     and workshift IN ($WorkShift)\r\n     and  stepname IN ($StepName)\r\n     and resourcegroup IN ($Resourcegroup)\r\n     group by mold,SPLIT_PART(workshift, '_', 3)\r\n   ),\r\n    Temp2 as(\r\n  select mold,SPLIT_PART(workshift, '_', 3) AS workshift, sum(outputs)outputs from kbn_sole_output where \r\n     workdate=(select to_char(current_date, 'YYYYMMDD'))\r\n     and datagroup IN ($Datagroup)\r\n     and workshift IN ($WorkShift)\r\n     and  stepname IN ($StepName)\r\n     and resourcegroup IN ($Resourcegroup)\r\n     group by mold, SPLIT_PART(workshift, '_', 3)\r\n   ) ,\r\n\r\n   Temp3 as (\r\n    select Temp1.workshift,\r\n    Temp1.mold,\r\n    coalesce(Temp1.target,0)as target ,\r\n    coalesce(Temp2.outputs,0)as outputs , \r\n    coalesce((Temp1.target-Temp2.outputs),0)as shortage,\r\n    coalesce(round(Temp2.outputs/Temp1.target*100,1),0) as ArchieveRate\r\n    from Temp1 left join temp2 on Temp1.workshift=Temp2.workshift and temp1.mold=temp2.mold\r\n   )select *from Temp3\r\norder by mold asc\r\nlimit 5"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""},{""collapsed"":false,""gridPos"":{""h"":1,""w"":24,""x"":0,""y"":33},""id"":9,""panels"":[],""type"":""row""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[{Datagroupvariable.ToString()}],""value"":[{Datagroupvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct data_group from parm_line_m"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Datagroup"",""options"":[],""query"":""select distinct data_group from parm_line_m"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":[{shiftvariable.ToString()}],""value"":[{shiftvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct shift from parm_time_std"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""WorkShift"",""options"":[],""query"":""select distinct shift from parm_time_std"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Stepnamevariable.ToString()}],""value"":[{Stepnamevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""StepName"",""options"":[],""query"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Resourcevariable.ToString()}],""value"":[{Resourcevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Resourcegroup"",""options"":[],""query"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{language}"",""value"":""{language}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""各底模生产进度"",""value"":""各底模生产进度""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_mold_production_status'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_mold_production_status"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_mold_production_status'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""超产"",""value"":""超产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_over_target"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""完工"",""value"":""完工""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_completed"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产中"",""value"":""生产中""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_ongoing"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""未投产"",""value"":""未投产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_not_start"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""Mold"",""value"":""Mold""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_mold'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_mold"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_mold'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""欠数"",""value"":""欠数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_shortage'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_shortage"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_shortage'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""达成率"",""value"":""达成率""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_achieve_rate'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_achieve_rate"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_achieve_rate'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产进度"",""value"":""生产进度""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_product_progress'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_product_progress"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_product_progress'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""目标数"",""value"":""目标数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":[""HE""],""value"":[""HE""]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""ProductKind"",""options"":[],""query"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""now-6h"",""to"":""now""},""timepicker"":{""refresh_intervals"":[""5s"",""10s"",""30s"",""1m"",""5m"",""15m"",""30m"",""1h"",""2h"",""1d""]},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}}",Y,20210800000428,1704959105064
"9S-NFYvYSF67gllnGKVFo7",mes-sole,sole_style7,Type7:時段累績產量,"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""target"":{""limit"":100,""matchAny"":false,""tags"":[],""type"":""dashboard""},""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":1346,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":27,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""sole\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n\n\n<script>\n  \n  var WorkShift = \""$WorkShift\"";\n  var n = 8; // 取前三位\n  var resultWorkShift = WorkShift.slice(-n);\n  document.getElementById(\""sole\"").innerText =\""\\xa0\\xa0\"" + \""${lang_cumulative_output_qty} /\"" + \""\\xa0\\xa0\"" +  \""${ProductKind}_\"" + resultWorkShift;\n\n   //右側時間\n    $(\""#clock\"").ready(function(){\n        updateClock();\n    });\n\n    function updateClock(){\n        let d = new Date();\n        let year = d.getFullYear();\n        let month = pad(d.getMonth()+1);\n        let day = pad(d.getDate());\n        $(\""#clock\"").html(year+\""/\""+month+\""/\""+day+\"" \""+\""\\xa0\\xa0\\xa0\"");\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n\n\n</script>\n\n\n\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:65px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":33,""w"":24,""x"":0,""y"":5},""id"":26,""options"":{""baidu"":{""callback"":""bmapReady"",""key"":""""},""editor"":{""format"":""none"",""height"":1845},""gaode"":{""key"":"""",""plugin"":""AMap.Scale,AMap.ToolBar""},""getOption"":""let time_no = [];\nlet targets = [];\nlet outputs = [];\nlet sumoutputs = [];\nlet colorvalues = [];\nlet colortargets = [];\nlet nowtimes = [];\n\n\n\n\n\ndata.series.forEach((s) => {\n  const fieldtime_no = s.fields.find((f) => f.name === 'time_no');\n  const fieldtargets = s.fields.find((f) => f.name === 'target');\n  const fieldoutputs = s.fields.find((f) => f.name === 'outputs');\n  const fieldnowtimes = s.fields.find((f) => f.name === 'nowtime');\n \n\n  if (fieldtime_no && fieldtargets && fieldoutputs && fieldnowtimes) {\n    time_no = time_no.concat(fieldtime_no.values);\n    targets = targets.concat(fieldtargets.values);\n    outputs = outputs.concat(fieldoutputs.values);\n    nowtimes = nowtimes.concat(fieldnowtimes.values);\n  }\n});\n\n\nif (time_no) {\n \nsumoutputs.push(\n  outputs[0],\n  outputs[0] + (nowtimes[1] > time_no[1] ? outputs[1] : 0),\n  outputs[0] + (nowtimes[2] > time_no[2] ? outputs[1] + outputs[2] : 0),\n  outputs[0] + (nowtimes[3] > time_no[3] ? outputs[1] + outputs[2] + outputs[3] : 0),\n  outputs[0] + (nowtimes[4] > time_no[4] ? outputs[1] + outputs[2] + outputs[3] + outputs[4] : 0),\n  outputs[0] + (nowtimes[5] > time_no[5] ? outputs[1] + outputs[2] + outputs[3] + outputs[4] + outputs[5] : 0),\n  outputs[0] + (nowtimes[6] > time_no[6] ? outputs[1] + outputs[2] + outputs[3] + outputs[4] + outputs[5] + outputs[6] : 0),\n  outputs[0] + (nowtimes[7] > time_no[7] ? outputs[1] + outputs[2] + outputs[3] + outputs[4] + outputs[5] + outputs[6] + outputs[7] : 0),\n  outputs[0] + (nowtimes[8] > time_no[8] ? outputs[1] + outputs[2] + outputs[3] + outputs[4] + outputs[5] + outputs[6] + outputs[7] + outputs[8] : 0)\n);\n}\n\n\n          \n          \n          \n         \n     \n\n //千分位 Function\nfunction totalFormat(params) {\n  const str = params.toString();\n  const reg = str.indexOf('.') > -1 ? /(\\d)(?=(\\d{3})+\\.)/g : /(\\d)(?=(?:\\d{3})+$)/g;\n  return str.replace(reg, '$1,');\n};\n\n //顏色 Function=====================================================================================\nfunction colorFormat(params) {    \n for (i = 0; i < params.length; i++) {\n if(params[i]>targets[i])  \n    {  \n     colorvalues[i]='rgba(252,206,16,1)'    //yellow\n    }\n\n  else if(params[i]<targets[i])\n    {\n       colorvalues[i]='rgba(30,144,255,1)'      //blue\n    }\n  else if(params[i]==targets[i])\n    {\n      colorvalues[i]=   'rgba(181,195,52,1)'     //greem\n    }\n\n }\n  return colorvalues\n                            };\n//=============================================================================================================\n\nfunction colorFormattarget(params) {    \n for (i = 0; i < params.length; i++) {\n if(params[i]==0)  \n    {  \n         //因為sum=0 先艮目標值\n     colortargets[i]='rgba(120,120,120,0.5)'   //gray\n    }\n else if(params[i]>targets[i])  \n    {  \n     colortargets[i]='rgba(252,206,16,0.5)'    //yellow\n    }\n  else if(params[i]<targets[i])\n    {\n       colortargets[i]='rgba(30,144,255,0.5)'   //blue\n    }\n  else if(params[i]==targets[i])\n    {\n      colortargets[i]=  'rgba(181,195,52,0.5)'     //greem\n    }\n\n }\n  return colortargets\n  };\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//長條顯示label Function=====================================================================================\n\n    function aaa (params) {\n       for (i = 0; i < params.length; i++) {\n      if(params[i]==0){  //為0時不顯示\n      return ''\n                      }\n   \n      else{\n           return totalFormat(params.value) //千分位 Function\n          }\n                                          }\n    }\n\n\nif (targets.length === 0) {\n  return {\n    backgroundColor: '#111217', // 設置背景色為灰色，您可以根據需求更改顏色值\n    title: {\n      text: 'No Data',\n      x: 'center',\n      y: 'center',\n      textStyle: {\n        fontSize: 70,\n        fontWeight: 'normal',\n      },\n    },\n  };\n}\n\n\n\n\n\n\n\n\nreturn  {\n    backgroundColor: 'black',//背景色\n    title: {\n        text: '',\n    },\n\n    // legend: {\n    //     data:['target','outputs']\n    // },\n\n    xAxis : [\n        {\n            type : 'category',\n            data : time_no,\n            axisLabel: {\n            formatter: '{value}',\n            textStyle: {\n            color: \""white\"",\n            fontSize: '65',\n            fontWeight: 'bolder',\n                       },\n                   }   \n        },\n\n         {\n      axisLine: { show: true },\n      axisTick: { show: true },\n      axisLabel: { show: false },\n      splitArea: { show: true },\n      splitLine: { show: true },\n      data: time_no,\n    },\n\n    ],\n\n    yAxis : [\n        {\n        type : 'value',\n        axisLabel: {\n            formatter: '{value}',\n            textStyle: {\n            color: \""white\"",\n            fontSize: '65',\n            fontWeight: 'bolder',\n                       },\n                   }   \n        }\n    ],\n    series : [\n     \n        {   type:'bar',\n            name:'outputs',\n            data: sumoutputs,\n            stack: '總量',\n            itemStyle : {\n            color: function (params) {\n            var colorList = colorFormat(sumoutputs);\n            return colorList[params.dataIndex]\n          },\n            },\n            label: {\n            show: true, fontSize: '65', fontWeight: 'bolder', position: 'top',\n            color: 'white',\n              formatter:function (data) {\n                   if(data.value==0){  //為0時不顯示\n                       return ''\n                   }else{\n                         return totalFormat(data.value) //千分位 Function\n                        }\n                                        }\n                   }\n\n        },\n\n        {\n            type: 'bar',\n            xAxisIndex: 1,\n            name:'target',\n            data:[targets[0], targets[1], targets[2], targets[3], targets[4], targets[5], targets[6], targets[7], targets[8]],\n            itemStyle: {\n                           color: function (params) {\n                           var colorList = colorFormattarget(sumoutputs);\n                           return colorList[params.dataIndex]\n          },\n                       },\n            label: {\n            show: false, fontSize: '65', fontWeight: 'bolder', position: 'top',\n            color: 'white',\n                   }\n        \n         \n        }\n    ]\n};\n                    "",""google"":{""callback"":""gmapReady"",""key"":""""},""map"":""json"",""renderer"":""svg"",""themeEditor"":{""config"":""{}"",""height"":400,""name"":""default""}},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select S.time_no , coalesce (M.outputs,0)as outputs \r\n,   (select sum(t.target)as outputs\r\n\tfrom kbn_sole_target t\r\n  where     datagroup IN ($Datagroup)\r\n\tand       t.workdate= (select to_char(current_date, 'YYYYMMDD'))\r\n\tand       t.workshift IN ($WorkShift)\r\n\tand       t.stepname IN ($StepName)\r\n\tand t.resourcegroup IN ($Resourcegroup)\r\n\t)as Target,\r\nTO_CHAR(NOW(), 'HH24') AS nowtime\r\nfrom kbn_shift_time S\r\n\r\nleft join \r\n(select o.time_no,sum(o.outputs)as outputs\r\n\tfrom kbn_sole_output o \r\n  where     datagroup IN ($Datagroup)\r\n\tand       o.workdate= (select to_char(current_date, 'YYYYMMDD'))\r\n\tand       o.workshift IN ($WorkShift)\r\n\tand       o.stepname IN ($StepName)\r\n\tand o.resourcegroup IN ($Resourcegroup)\r\n\tgroup by  o.time_no\r\n)M on S.time_no=M.time_no\r\nwhere S.workshift IN ($WorkShift)\r\norder by S.time_no"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""transparent"":true,""type"":""volkovlabs-echarts-panel""},{""collapsed"":false,""gridPos"":{""h"":1,""w"":24,""x"":0,""y"":38},""id"":9,""panels"":[],""type"":""row""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[{Datagroupvariable.ToString()}],""value"":[{Datagroupvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct data_group from parm_line_m"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Datagroup"",""options"":[],""query"":""select distinct data_group from parm_line_m"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{shiftvariable.ToString()}],""value"":[{shiftvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct shift from parm_time_std"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""WorkShift"",""options"":[],""query"":""select distinct shift from parm_time_std"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Stepnamevariable.ToString()}],""value"":[{Stepnamevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""StepName"",""options"":[],""query"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Resourcevariable.ToString()}],""value"":[{Resourcevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Resourcegroup"",""options"":[],""query"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Productkindvariable.ToString()}],""value"":[{Productkindvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""ProductKind"",""options"":[],""query"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{language}"",""value"":""{language}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""累计产量"",""value"":""累计产量""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_cumulative_output_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_cumulative_output_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_cumulative_output_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""now-6h"",""to"":""now""},""timepicker"":{""refresh_intervals"":[""5s"",""10s"",""30s"",""1m"",""5m"",""15m"",""30m"",""1h"",""2h"",""1d""]},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20210800000428,1704959114441
"9S-NFYvYSF67gllnGKVFo8",mes-sole,sole_style8,Type8:當班不良統計,"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""target"":{""limit"":100,""matchAny"":false,""tags"":[],""type"":""dashboard""},""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":1352,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":13,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""sole\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n\n\n<script>\n  \n  var WorkShift = \""$WorkShift\"";\n  var n = 8; // 取前三位\n  var resultWorkShift = WorkShift.slice(-n);\n  document.getElementById(\""sole\"").innerText = \""\\xa0\\xa0\"" +  \""${ProductKind}_\"" + resultWorkShift;\n\n//右側時間\n    $(\""#clock\"").ready(function(){\n        updateClock();\n    });\n\n    function updateClock(){\n        let d = new Date();\n        let year = d.getFullYear();\n        let month = pad(d.getMonth()+1);\n        let day = pad(d.getDate());\n        $(\""#clock\"").html(year+\""/\""+month+\""/\""+day+\"" \""+\""\\xa0\\xa0\\xa0\"");\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n\n\n</script>\n\n\n\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:65px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":16,""x"":4,""y"":5},""id"":33,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div\n  style=\""border-radius:160px 10px; font-size:100px; color:white; text-align:center; font-weight:bold; background-image: linear-gradient(to right, #000046, #1CB5E0);\"">\n  <p>${lang_defect_reason_top5}</p>\n</div>\n\n\n\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""fieldConfig"":{""defaults"":{""color"":{""mode"":""continuous-RdYlGr""},""mappings"":[],""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]}},""overrides"":[]},""gridPos"":{""h"":3,""w"":4,""x"":2,""y"":10},""id"":24,""options"":{""colorMode"":""none"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""vertical"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":""/^defect$/"",""values"":true},""text"":{""valueSize"":45},""textMode"":""value""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select sum(de.defectqty) as Top ,de.defectdesczf ,im.defect ,im.image  from kbn_sole_defect de\r\n  left join   kbn_sole_defectimage im\r\n  on de.defectcode=im.defectcode\r\n  where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and resourcegroup IN ($Resourcegroup)\r\n  and   workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\ngroup by  facility, productkind,workdate,workshift,stepname,defectdesczf ,im.defect ,im,image\r\norder by top desc \r\nlimit 1 offset 0"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""fieldConfig"":{""defaults"":{""color"":{""mode"":""continuous-RdYlGr""},""mappings"":[],""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]}},""overrides"":[]},""gridPos"":{""h"":3,""w"":4,""x"":6,""y"":10},""id"":25,""options"":{""colorMode"":""none"",""graphMode"":""none"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":""/^defect$/"",""values"":true},""text"":{""valueSize"":45},""textMode"":""value""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select sum(de.defectqty) as Top ,de.defectdesczf ,im.defect ,im.image  from kbn_sole_defect de\r\n  left join   kbn_sole_defectimage im\r\n  on de.defectcode=im.defectcode\r\n  where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\ngroup by  facility, productkind,workdate,workshift,stepname,defectdesczf,im.defect ,im,image\r\norder by top desc \r\nlimit 1 offset 1"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""fieldConfig"":{""defaults"":{""color"":{""mode"":""continuous-RdYlGr""},""mappings"":[],""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]}},""overrides"":[]},""gridPos"":{""h"":3,""w"":4,""x"":10,""y"":10},""id"":26,""options"":{""colorMode"":""none"",""graphMode"":""none"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":""/^defect$/"",""values"":true},""text"":{""valueSize"":45},""textMode"":""value""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select sum(de.defectqty) as Top ,de.defectdesczf ,im.defect ,im.image  from kbn_sole_defect de\r\n  left join   kbn_sole_defectimage im\r\n  on de.defectcode=im.defectcode\r\n   where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\ngroup by  facility, productkind,workdate,workshift,stepname,defectdesczf,im.defect ,im,image\r\norder by top desc \r\nlimit 1 offset 2"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""fieldConfig"":{""defaults"":{""color"":{""mode"":""continuous-RdYlGr""},""mappings"":[],""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]}},""overrides"":[]},""gridPos"":{""h"":3,""w"":4,""x"":14,""y"":10},""id"":27,""options"":{""colorMode"":""none"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":""/^defect$/"",""values"":true},""text"":{""valueSize"":45},""textMode"":""value""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select sum(de.defectqty) as Top ,de.defectdesczf ,im.defect ,im.image  from kbn_sole_defect de\r\n  left join   kbn_sole_defectimage im\r\n  on de.defectcode=im.defectcode\r\n   where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\ngroup by  facility, productkind,workdate,workshift,stepname,defectdesczf,im.defect ,im,image\r\norder by top desc \r\nlimit 1 offset 3"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""fieldConfig"":{""defaults"":{""color"":{""mode"":""continuous-RdYlGr""},""mappings"":[],""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]}},""overrides"":[]},""gridPos"":{""h"":3,""w"":4,""x"":18,""y"":10},""id"":28,""options"":{""colorMode"":""none"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":""/^defect$/"",""values"":true},""text"":{""valueSize"":45},""textMode"":""value""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select sum(de.defectqty) as Top ,de.defectdesczf ,im.defect ,im.image  from kbn_sole_defect de\r\n  left join   kbn_sole_defectimage im\r\n  on de.defectcode=im.defectcode\r\n   where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\ngroup by  facility, productkind,workdate,workshift,stepname,defectdesczf,im.defect ,im,image\r\norder by top desc \r\nlimit 1 offset 4"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":2,""y"":13},""id"":18,""options"":{""autoPlay"":true,""controls"":true,""height"":0,""heightMode"":""auto"",""name"":""image"",""toolbar"":true,""width"":0,""widthMode"":""auto""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""with temp1 as\r\n(\r\nselect sum(de.defectqty) as Top ,defectdesczf,im.image \r\n  from kbn_sole_defect de\r\n  left join   kbn_sole_defectimage im\r\n  on de.defectcode=im.defectcode\r\n  where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\ngroup by  facility, productkind,workdate,workshift,stepname,defectdesczf,image\r\norder by top desc\r\n)select \r\n  (case\r\n     when (select count(*) from temp1)='0'                    then (select image from kbn_sole_defectimage where defect = 'No')\r\n     when (select  image from temp1 limit 1 offset 0) is not null  then (select  image from temp1 limit 1 offset 0)\r\n     else (select  image from  kbn_sole_defectimage where defect ='No')\r\n     end \r\n   )image"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""type"":""volkovlabs-image-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":6,""y"":13},""id"":20,""options"":{""autoPlay"":true,""controls"":true,""height"":0,""heightMode"":""auto"",""name"":""image"",""toolbar"":true,""width"":0,""widthMode"":""auto""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""with temp1 as\r\n(\r\nselect sum(de.defectqty) as Top ,defectdesczf,im.image \r\n  from kbn_sole_defect de\r\n  left join   kbn_sole_defectimage im\r\n  on de.defectcode=im.defectcode\r\n    where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\ngroup by  facility, productkind,workdate,workshift,stepname,defectdesczf,image\r\norder by top desc\r\n)select \r\n  (case\r\n     when (select count(*) from temp1)='0'                    then (select image from kbn_sole_defectimage where defect = 'No')\r\n     when (select  image from temp1 limit 1 offset 1) is not null  then (select  image from temp1 limit 1 offset 1)\r\n     else (select  image from  kbn_sole_defectimage where defect ='No')\r\n     end \r\n   )image"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""type"":""volkovlabs-image-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":10,""y"":13},""id"":22,""options"":{""autoPlay"":true,""controls"":true,""height"":0,""heightMode"":""auto"",""name"":""image"",""toolbar"":true,""width"":0,""widthMode"":""auto""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""with temp1 as\r\n(\r\nselect sum(de.defectqty) as Top ,defectdesczf,im.image \r\n  from kbn_sole_defect de\r\n  left join   kbn_sole_defectimage im\r\n  on de.defectcode=im.defectcode\r\n    where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\ngroup by  facility, productkind,workdate,workshift,stepname,defectdesczf,image\r\norder by top desc\r\n)select \r\n  (case\r\n     when (select count(*) from temp1)='0'                    then (select image from kbn_sole_defectimage where defect = 'No')\r\n     when (select  image from temp1 limit 1 offset 2) is not null  then (select  image from temp1 limit 1 offset 2)\r\n     else (select  image from  kbn_sole_defectimage where defect ='No')\r\n     end \r\n   )image"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""type"":""volkovlabs-image-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":14,""y"":13},""id"":19,""options"":{""autoPlay"":true,""controls"":true,""height"":0,""heightMode"":""auto"",""name"":""image"",""toolbar"":true,""width"":0,""widthMode"":""auto""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""with temp1 as\r\n(\r\nselect sum(de.defectqty) as Top ,defectdesczf,im.image \r\n  from kbn_sole_defect de\r\n  left join   kbn_sole_defectimage im\r\n  on de.defectcode=im.defectcode\r\n    where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\ngroup by  facility, productkind,workdate,workshift,stepname,defectdesczf,image\r\norder by top desc\r\n)select \r\n  (case\r\n     when (select count(*) from temp1)='0'                    then (select image from kbn_sole_defectimage where defect = 'No')\r\n     when (select  image from temp1 limit 1 offset 3) is not null  then (select  image from temp1 limit 1 offset 3)\r\n     else (select  image from  kbn_sole_defectimage where defect ='No')\r\n     end \r\n   )image"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""type"":""volkovlabs-image-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":18,""y"":13},""id"":21,""options"":{""autoPlay"":true,""controls"":true,""height"":0,""heightMode"":""auto"",""name"":""image"",""toolbar"":true,""width"":0,""widthMode"":""auto""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""with temp1 as\r\n(\r\nselect sum(de.defectqty) as Top ,defectdesczf,im.image \r\n  from kbn_sole_defect de\r\n  left join   kbn_sole_defectimage im\r\n  on de.defectcode=im.defectcode\r\n    where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\ngroup by  facility, productkind,workdate,workshift,stepname,defectdesczf,image\r\norder by top desc\r\n)select \r\n  (case\r\n     when (select count(*) from temp1)='0'                    then (select image from kbn_sole_defectimage where defect = 'No')\r\n     when (select  image from temp1 limit 1 offset 4) is not null  then (select  image from temp1 limit 1 offset 4)\r\n     else (select  image from  kbn_sole_defectimage where defect ='No')\r\n     end \r\n   )image"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""type"":""volkovlabs-image-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":2,""y"":25},""id"":7,""options"":{""content"":""<div class=\""card\"">\r\n  <div class=\""container1\"">\r\n    {{top}}\r\n  </div>\r\n  <div class=\""bookmark1\"">TOP 1</div>\r\n</div>\r\n\r\n<style type=\""text/css\"">\r\n  .card {\r\n    box-shadow: 0 4px 8px 0 rgba(254, 250, 231, 0.3);\r\n    transition: 0.3s;\r\n    width: 100%;\r\n    height: 85%;\r\n    background-color: rgb(254, 250, 231);\r\n    border-radius: 30px;\r\n  }\r\n\r\n  .card:hover {\r\n    box-shadow: 0 8px 16px 0 rgba(254, 250, 231, 0.3);\r\n  }\r\n\r\n  .container1 {\r\n    padding: 120px 50px 30px 20px;\r\n    /*上 右 下 左*/\r\n    font-size: 200px;\r\n    color: #B73E3E;\r\n    text-align: center;\r\n  }\r\n\r\n  .bookmark1 {\r\n    position: absolute;\r\n    top: 3%;\r\n    right: 10%;\r\n    height: 2.2em;\r\n    width: 5em;\r\n    background-color: hsl(1, 83%, 29%);\r\n    background-image:\r\n      linear-gradient(hsla(0, 0%, 100%, 0),\r\n        hsla(0, 0%, 100%, 0.5) 5px,\r\n        hsla(0, 0%, 100%, 0) 25px);\r\n    -webkit-filter: drop-shadow(0 2px 6px hsla(0, 0%, 0%, 0.75));\r\n    box-sizing: border-box;\r\n    padding-top: 35px;\r\n    text-align: center;\r\n    color: #F5F0DD;\r\n    font-size: 65px;\r\n    font-family: Arial Black;\r\n    text-shadow: 0 -1px 0 hsla(0, 0%, 0%, 0.5);\r\n  }\r\n\r\n  .bookmark1:before,\r\n  .bookmark1:after {\r\n    content: '';\r\n    display: block;\r\n    position: absolute;\r\n  }\r\n\r\n  .bookmark1:before {\r\n    bottom: -50%;\r\n    height: 100%;\r\n    width: 100%;\r\n    background-image:\r\n      linear-gradient(-10deg,\r\n        transparent 50%,\r\n        hsl(1, 83%, 29%) 50%),\r\n      linear-gradient(10deg,\r\n        transparent 50%,\r\n        hsl(1, 83%, 29%)50%);\r\n    z-index: -1;\r\n  }\r\n\r\n  .bookmark1:after {\r\n    height: 115%;\r\n    width: 86%;\r\n    left: 7%;\r\n    top: 1px;\r\n    border-style: solid;\r\n    /*solid*/\r\n    border-color: rgb(254, 250, 231);\r\n    border-width: 0 8px;\r\n    pointer-events: none;\r\n  }\r\n</style>"",""defaultContent"":"""",""editor"":{""format"":""auto"",""height"":200,""language"":""html""},""everyRow"":true,""helpers"":""""},""pluginVersion"":""2.0.4"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select  SUM(defectqty)as top\r\n from kbn_sole_defect \r\n   where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\n group by  facility, productkind,workdate,workshift,stepname,defectcode\r\norder by top desc \r\nlimit 1 offset 0"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":6,""y"":25},""id"":29,""options"":{""content"":""<div class=\""card\"">\r\n  <div class=\""container2\"">\r\n    {{top}}\r\n  </div>\r\n  <div class=\""bookmark2\"">TOP 2</div>\r\n</div>\r\n\r\n<style type=\""text/css\"">\r\n.card {\r\nbox-shadow: 0 4px 8px 0 rgba(254, 250, 231, 0.3);\r\ntransition: 0.3s;\r\nwidth: 100%;\r\nheight: 85%;\r\nbackground-color: rgb(254, 250, 231);\r\nborder-radius: 30px;\r\n}\r\n\r\n.card:hover {\r\nbox-shadow: 0 8px 16px 0 rgba(254, 250, 231, 0.3);\r\n}\r\n\r\n.container2 {\r\npadding: 120px 50px 30px 20px;\r\n/*上 右 下 左*/\r\nfont-size: 200px;\r\ncolor: #7A3E65;\r\ntext-align: center;\r\n}\r\n\r\n.bookmark2 {\r\nposition: absolute;\r\ntop: 3%;\r\nright: 10%;\r\nheight: 2.2em;\r\nwidth: 5em;\r\nbackground-color: hsl(291, 36%, 22%);\r\nbackground-image:\r\nlinear-gradient(hsla(0, 0%, 100%, 0),\r\nhsla(0, 0%, 100%, 0.5) 5px,\r\nhsla(0, 0%, 100%, 0) 25px);\r\n-webkit-filter: drop-shadow(0 2px 6px hsla(0, 0%, 0%, 0.75));\r\nbox-sizing: border-box;\r\npadding-top: 35px;\r\ntext-align: center;\r\ncolor: #F5F0DD;\r\nfont-size: 65px;\r\nfont-family: Arial Black;\r\ntext-shadow: 0 -1px 0 hsla(0, 0%, 0%, 0.5);\r\n}\r\n\r\n.bookmark2:before,\r\n.bookmark2:after {\r\ncontent: '';\r\ndisplay: block;\r\nposition: absolute;\r\n}\r\n\r\n.bookmark2:before {\r\nbottom: -50%;\r\nheight: 100%;\r\nwidth: 100%;\r\nbackground-image:\r\nlinear-gradient(-10deg,\r\ntransparent 50%,\r\nhsl(291, 36%, 22%) 50%),\r\nlinear-gradient(10deg,\r\ntransparent 50%,\r\nhsl(291, 36%, 22%) 50%);\r\nz-index: -1;\r\n}\r\n\r\n.bookmark2:after {\r\nheight: 115%;\r\nwidth: 86%;\r\nleft: 7%;\r\ntop: 1px;\r\nborder-style: solid;\r\n/*solid*/\r\nborder-color: rgb(254, 250, 231);\r\nborder-width: 0 8px;\r\npointer-events: none;\r\n}\r\n</style>"",""defaultContent"":"""",""editor"":{""format"":""auto"",""height"":200,""language"":""html""},""everyRow"":true,""helpers"":""""},""pluginVersion"":""2.0.4"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select  SUM(defectqty)as top\r\n from kbn_sole_defect \r\n    where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\n group by  facility, productkind,workdate,workshift,stepname,defectcode\r\norder by top desc \r\nlimit 1 offset 1"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":10,""y"":25},""id"":30,""options"":{""content"":""<div class=\""card\"">\r\n  <div class=\""container3\"">\r\n    {{top}}\r\n  </div>\r\n  <div class=\""bookmark3\"">TOP 3</div>\r\n</div>\r\n\r\n<style type=\""text/css\"">\r\n  .card {\r\n    box-shadow: 0 4px 8px 0 rgba(254, 250, 231, 0.3);\r\n    transition: 0.3s;\r\n    width: 100%;\r\n    height: 85%;\r\n    background-color: rgb(254, 250, 231);\r\n    border-radius: 30px;\r\n  }\r\n\r\n  .card:hover {\r\n    box-shadow: 0 8px 16px 0 rgba(254, 250, 231, 0.3);\r\n  }\r\n\r\n  .container3 {\r\n    padding: 120px 50px 30px 20px;\r\n    /*上 右 下 左*/\r\n    font-size: 200px;\r\n    color: #2C74B3;\r\n    text-align: center;\r\n  }\r\n\r\n  .bookmark3 {\r\n    position: absolute;\r\n    top: 3%;\r\n    right: 10%;\r\n    height: 2.2em;\r\n    width: 5em;\r\n    background-color: hsl(212, 100%, 18%);\r\n    background-image:\r\n      linear-gradient(hsla(0, 0%, 100%, 0),\r\n        hsla(0, 0%, 100%, 0.5) 5px,\r\n        hsla(0, 0%, 100%, 0) 25px);\r\n    -webkit-filter: drop-shadow(0 2px 6px hsla(0, 0%, 0%, 0.75));\r\n    box-sizing: border-box;\r\n    padding-top: 35px;\r\n    text-align: center;\r\n    color: #F5F0DD;\r\n    font-size: 65px;\r\n    font-family: Arial Black;\r\n    text-shadow: 0 -1px 0 hsla(0, 0%, 0%, 0.5);\r\n  }\r\n\r\n  .bookmark3:before,\r\n  .bookmark3:after {\r\n    content: '';\r\n    display: block;\r\n    position: absolute;\r\n  }\r\n\r\n  .bookmark3:before {\r\n    bottom: -50%;\r\n    height: 100%;\r\n    width: 100%;\r\n    background-image:\r\n      linear-gradient(-10deg,\r\n        transparent 50%,\r\n        hsl(212, 100%, 18%) 50%),\r\n      linear-gradient(10deg,\r\n        transparent 50%,\r\n        hsl(212, 100%, 18%) 50%);\r\n    z-index: -1;\r\n  }\r\n\r\n  .bookmark3:after {\r\n    height: 115%;\r\n    width: 86%;\r\n    left: 7%;\r\n    top: 1px;\r\n    border-style: solid;\r\n    /*solid*/\r\n    border-color: rgb(254, 250, 231);\r\n    border-width: 0 8px;\r\n    pointer-events: none;\r\n  }\r\n</style>"",""defaultContent"":"""",""editor"":{""format"":""auto"",""height"":200,""language"":""html""},""everyRow"":true,""helpers"":""""},""pluginVersion"":""2.0.4"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select  SUM(defectqty)as top\r\n from kbn_sole_defect \r\n   where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\n group by  facility, productkind,workdate,workshift,stepname,defectcode\r\norder by top desc \r\nlimit 1 offset 2"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":14,""y"":25},""id"":31,""options"":{""content"":""<div class=\""card\"">\r\n  <div class=\""container4\"">\r\n    {{top}}\r\n  </div>\r\n  <div class=\""bookmark4\"">TOP 4</div>\r\n</div>\r\n\r\n<style type=\""text/css\"">\r\n  .card {\r\n    box-shadow: 0 4px 8px 0 rgba(254, 250, 231, 0.3);\r\n    transition: 0.3s;\r\n    width: 100%;\r\n    height: 85%;\r\n    background-color: rgb(254, 250, 231);\r\n    border-radius: 30px;\r\n  }\r\n\r\n  .card:hover {\r\n    box-shadow: 0 8px 16px 0 rgba(254, 250, 231, 0.3);\r\n  }\r\n\r\n  .container4 {\r\n    padding: 120px 50px 30px 20px;\r\n    /*上 右 下 左*/\r\n    font-size: 200px;\r\n    color: #088395;\r\n    text-align: center;\r\n  }\r\n\r\n  .bookmark4 {\r\n    position: absolute;\r\n    top: 3%;\r\n    right: 10%;\r\n    height: 2.2em;\r\n    width: 5em;\r\n    background-color: hsl(197, 82%, 22%);\r\n    background-image:\r\n      linear-gradient(hsla(0, 0%, 100%, 0),\r\n        hsla(0, 0%, 100%, 0.5) 5px,\r\n        hsla(0, 0%, 100%, 0) 25px);\r\n    -webkit-filter: drop-shadow(0 2px 6px hsla(0, 0%, 0%, 0.75));\r\n    box-sizing: border-box;\r\n    padding-top: 35px;\r\n    text-align: center;\r\n    color: #F5F0DD;\r\n    font-size: 65px;\r\n    font-family: Arial Black;\r\n    text-shadow: 0 -1px 0 hsla(0, 0%, 0%, 0.5);\r\n  }\r\n\r\n  .bookmark4:before,\r\n  .bookmark4:after {\r\n    content: '';\r\n    display: block;\r\n    position: absolute;\r\n  }\r\n\r\n  .bookmark4:before {\r\n    bottom: -50%;\r\n    height: 100%;\r\n    width: 100%;\r\n    background-image:\r\n      linear-gradient(-10deg,\r\n        transparent 50%,\r\n        hsl(197, 82%, 22%) 50%),\r\n      linear-gradient(10deg,\r\n        transparent 50%,\r\n        hsl(197, 82%, 22%) 50%);\r\n    z-index: -1;\r\n  }\r\n\r\n  .bookmark4:after {\r\n    height: 115%;\r\n    width: 86%;\r\n    left: 7%;\r\n    top: 1px;\r\n    border-style: solid;\r\n    /*solid*/\r\n    border-color: rgb(254, 250, 231);\r\n    border-width: 0 8px;\r\n    pointer-events: none;\r\n  }\r\n</style>"",""defaultContent"":""<p style=\""font-size:45px; color:rgb(204, 204, 220); text-align:center;\"">\r\n  </p>"",""editor"":{""format"":""auto"",""height"":200,""language"":""html""},""everyRow"":true,""helpers"":""""},""pluginVersion"":""2.0.4"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select  SUM(defectqty)as top\r\n from kbn_sole_defect \r\n    where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\n group by  facility, productkind,workdate,workshift,stepname,defectcode\r\norder by top desc \r\nlimit 1 offset 3"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":18,""y"":25},""id"":32,""options"":{""content"":""<div class=\""card\"">\r\n  <div class=\""container5\"">\r\n    {{top}}\r\n  </div>\r\n  <div class=\""bookmark5\"">TOP 5</div>\r\n</div>\r\n\r\n<style type=\""text/css\"">\r\n  .card {\r\n    box-shadow: 0 4px 8px 0 rgba(254, 250, 231, 0.3);\r\n    transition: 0.3s;\r\n    width: 100%;\r\n    height: 85%;\r\n    background-color: rgb(254, 250, 231);\r\n    border-radius: 30px;\r\n  }\r\n\r\n  .card:hover {\r\n    box-shadow: 0 8px 16px 0 rgba(254, 250, 231, 0.3);\r\n  }\r\n\r\n  .container5 {\r\n    padding: 120px 50px 30px 20px;\r\n    /*上 右 下 左*/\r\n    font-size: 200px;\r\n    color: #F16821;\r\n    text-align: center;\r\n  }\r\n\r\n  .bookmark5 {\r\n    position: absolute;\r\n    top: 3%;\r\n    right: 10%;\r\n    height: 2.2em;\r\n    width: 5em;\r\n    background-color: hsl(20, 80%, 44%);\r\n    background-image:\r\n      linear-gradient(hsla(0, 0%, 100%, 0),\r\n        hsla(0, 0%, 100%, 0.5) 5px,\r\n        hsla(0, 0%, 100%, 0) 25px);\r\n    -webkit-filter: drop-shadow(0 2px 6px hsla(0, 0%, 0%, 0.75));\r\n    box-sizing: border-box;\r\n    padding-top: 35px;\r\n    text-align: center;\r\n    color: #F5F0DD;\r\n    font-size: 65px;\r\n    font-family: Arial Black;\r\n    text-shadow: 0 -1px 0 hsla(0, 0%, 0%, 0.5);\r\n  }\r\n\r\n  .bookmark5:before,\r\n  .bookmark5:after {\r\n    content: '';\r\n    display: block;\r\n    position: absolute;\r\n  }\r\n\r\n  .bookmark5:before {\r\n    bottom: -50%;\r\n    height: 100%;\r\n    width: 100%;\r\n    background-image:\r\n      linear-gradient(-10deg,\r\n        transparent 50%,\r\n        hsl(20, 80%, 44%) 50%),\r\n      linear-gradient(10deg,\r\n        transparent 50%,\r\n        hsl(20, 80%, 44%) 50%);\r\n    z-index: -1;\r\n  }\r\n\r\n  .bookmark5:after {\r\n    height: 115%;\r\n    width: 86%;\r\n    left: 7%;\r\n    top: 1px;\r\n    border-style: solid;\r\n    /*solid*/\r\n    border-color: rgb(254, 250, 231);\r\n    border-width: 0 8px;\r\n    pointer-events: none;\r\n  }\r\n</style>"",""defaultContent"":""<p style=\""font-size:45px; color:rgb(204, 204, 220); text-align:center;\"">\r\n  </p>"",""editor"":{""format"":""auto"",""height"":200,""language"":""html""},""everyRow"":true,""helpers"":""""},""pluginVersion"":""2.0.4"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select  SUM(defectqty)as top\r\n from kbn_sole_defect \r\n    where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and  workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\n group by  facility, productkind,workdate,workshift,stepname,defectcode\r\norder by top desc \r\nlimit 1 offset 4"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[{Datagroupvariable.ToString()}],""value"":[{Datagroupvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct data_group from parm_line_m"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Datagroup"",""options"":[],""query"":""select distinct data_group from parm_line_m"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":[{shiftvariable.ToString()}],""value"":[{shiftvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""\nselect distinct shift from parm_time_std"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""WorkShift"",""options"":[],""query"":""\nselect distinct shift from parm_time_std"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Stepnamevariable.ToString()}],""value"":[{Stepnamevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""StepName"",""options"":[],""query"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Resourcevariable.ToString()}],""value"":[{Resourcevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Resourcegroup"",""options"":[],""query"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Productkindvariable.ToString()}],""value"":[{Productkindvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""ProductKind"",""options"":[],""query"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{language}"",""value"":""{language}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""前 5 大不良原因"",""value"":""前 5 大不良原因""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_defect_reason_top5'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_defect_reason_top5"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_defect_reason_top5'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""2022-11-27T22:32:23.519Z"",""to"":""2022-11-28T10:32:23.519Z""},""timepicker"":{""refresh_intervals"":[""5s"",""10s"",""30s"",""1m"",""5m"",""15m"",""30m"",""1h"",""2h"",""1d""]},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20210800000428,1704959122207
"9S-NFYvYSF67gllnGKVFo9",mes-sole,sole_style9,Type9:前五大不良型體,"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""target"":{""limit"":100,""matchAny"":false,""tags"":[],""type"":""dashboard""},""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":1355,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":13,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""sole\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n\n\n<script>\n  \n  var WorkShift = \""$WorkShift\"";\n  var n = 8; // 取前三位\n  var resultWorkShift = WorkShift.slice(-n);\n  document.getElementById(\""sole\"").innerText =\""\\xa0\\xa0\"" +  \""${ProductKind}_\"" + resultWorkShift;\n\n   //右側時間\n    $(\""#clock\"").ready(function(){\n        updateClock();\n    });\n\n    function updateClock(){\n        let d = new Date();\n        let year = d.getFullYear();\n        let month = pad(d.getMonth()+1);\n        let day = pad(d.getDate());\n        $(\""#clock\"").html(year+\""/\""+month+\""/\""+day+\"" \""+\""\\xa0\\xa0\\xa0\"");\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n\n\n</script>\n\n\n\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:65px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":4,""w"":12,""x"":6,""y"":5},""id"":15,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div\n  style=\""border-radius:200px 10px; font-size:100px; color:white; text-align:center; font-weight:bold; background-image: linear-gradient(to right, #000046, #1CB5E0);\"">\n  <p>${lang_defect_article_top5}</p>\n</div>"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":29,""w"":24,""x"":0,""y"":9},""id"":14,""options"":{""baidu"":{""callback"":""bmapReady"",""key"":""""},""editor"":{""format"":""auto"",""height"":600},""gaode"":{""key"":"""",""plugin"":""AMap.Scale,AMap.ToolBar""},""getOption"":""let defectqtys = [];\nlet defect_model = [];\nlet colorvalues;\n\ndata.series.forEach((s) => {\n  const fielddefectqtys = s.fields.find((f) => f.name === 'defectqty');\n  const fielddefect_models = s.fields.find((f) => f.name === 'defect_model');\n  \n\n  if (fielddefectqtys && fielddefect_models) {\n    defectqtys = defectqtys.concat(fielddefectqtys.values);\n    defect_model = defect_model.concat(fielddefect_models.values);\n   \n  }\n});\n\n\n\n\n\n\n\n\n//顏色 Function=====================================================================================\nfunction colorFormat(params) {\n\n  if (params > 0) {\n    colorvalues = 'red'    //red\n  }\n  else if (params > 40) {\n    colorvalues = 'blue)'      //blue\n  }\n  else if (params > 50) {\n    colorvalues = 'greem'     //greem\n  }\n  return colorvalues\n};\n\n\n\n\n\n\n\n\n\nif (defectqtys.length == 0) {  //暂无数据\n  return {\n    title: {\n      text: 'No Defect Data',\n      x: 'center',\n      y: 'center',\n      textStyle: {\n        fontSize: 100,\n        fontWeight: 'normal',\n      }\n    }\n  }\n\n}\n\n\n\n\n\n\n\nreturn {\n  backgroundColor: 'black',//背景色\n\n  grid: {\n    left: \""40%\"",\n    // top: \""100%\"",\n    right: \""5%\"",\n    // bottom: \""100%\"",\n    containLabel: false  // \n  },\n\n\n\n\n\n  yAxis: {\n    data: defect_models,\n    axisLabel: {\n      textStyle: {\n        show: true,\n        fontFamily: 'Arial',\n        color: \""#fff\"",\n        fontSize: '50',\n      },\n    }\n\n  },\n  xAxis: {\n    axisLabel: {\n      textStyle: {\n        show: true,\n        fontFamily: '微软雅黑',\n        color: \""#fff\"",\n        fontSize: '65',\n      },\n    }\n  },\n  series: [\n    {\n      type: 'bar',\n      label: {\n        show: true,\n        fontSize: '85',\n        fontWeight: 'bolder',\n        color: 'black'\n\n\n      },\n      data: [\n\n        {\n          value: defectqtys[0],\n          itemStyle: {\n            color: colorFormat(defectqtys[0]),\n            opacity: 1\n\n          }\n        },\n\n\n        {\n          value: defectqtys[1],\n          itemStyle: {\n            color: colorFormat(defectqtys[1]),\n            opacity: 1\n\n          }\n        },\n\n        {\n          value: defectqtys[2],\n          itemStyle: {\n            color: colorFormat(defectqtys[2]),\n            opacity: 1\n          }\n        },\n\n        {\n          value: defectqtys[3],\n          itemStyle: {\n            color: colorFormat(defectqtys[3]),\n            opacity: 1\n          }\n        },\n\n        {\n          value: defectqtys[4],\n          itemStyle: {\n            color: colorFormat(defectqtys[4]),\n            opacity: 1\n          }\n        },\n\n\n\n\n\n      ],\n\n\n\n    }\n  ]\n};"",""google"":{""callback"":""gmapReady"",""key"":""""},""map"":""json"",""renderer"":""canvas"",""themeEditor"":{""config"":""{}"",""height"":400,""name"":""default""}},""pluginVersion"":""9.0.6"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""\tselect  substring( mold ||'_'||zzatcolr||'-'||zzcolorcode,0,30) as defect_model  ,SUM(defectqty)as defectqty,workdate\r\n from kbn_sole_defect \r\n  where workshift IN ($WorkShift)\r\n  and   datagroup IN ($Datagroup)\r\n  and   stepname IN ($StepName)\r\n  and   resourcegroup IN ($Resourcegroup)\r\n  and   workdate = TO_CHAR(CURRENT_DATE, 'YYYYMMDD')\r\n group by  facility, productkind,workdate,workshift,stepname,mold,zzatcolr,zzcolorcode\r\norder by defectqty desc limit 5"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""type"":""volkovlabs-echarts-panel""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[{Datagroupvariable.ToString()}],""value"":[{Datagroupvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct data_group from parm_line_m"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Datagroup"",""options"":[],""query"":""select distinct data_group from parm_line_m"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{shiftvariable.ToString()}],""value"":[{shiftvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct shift from parm_time_std"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""WorkShift"",""options"":[],""query"":""select distinct shift from parm_time_std"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Stepnamevariable.ToString()}],""value"":[{Stepnamevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""StepName"",""options"":[],""query"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Resourcevariable.ToString()}],""value"":[{Resourcevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Resourcegroup"",""options"":[],""query"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Productkindvariable.ToString()}],""value"":[{Productkindvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""\nselect distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""ProductKind"",""options"":[],""query"":""\nselect distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{language}"",""value"":""{language}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""前 5 大不良型体"",""value"":""前 5 大不良型体""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_defect_article_top5'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_defect_article_top5"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_defect_article_top5'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""2022-11-27T22:32:23.519Z"",""to"":""2022-11-28T10:32:23.519Z""},""timepicker"":{""refresh_intervals"":[""5s"",""10s"",""30s"",""1m"",""5m"",""15m"",""30m"",""1h"",""2h"",""1d""]},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20210800000428,1704959130689
AI6WTfXeRyGocD0zZHl7u6,mes-shoe,shoe_style6,Type6:前五大不良原因,"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":510,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":13,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""shoe\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n<script>\n    document.getElementById(\""shoe\"").innerText = \""\\xa0\\xa0\"" + \""$stepname\"" + \""\\xa0\\xa0\"" + \""$sublineno\"";\n    \n    // 初始執行\n    updateClock();\n    \n    // 每秒更新一次\n    setInterval(updateClock, 1000);\n\n    function updateClock(){\n        var d = new Date();\n        var year = d.getFullYear();\n        var month = pad(d.getMonth()+1);\n        var day = pad(d.getDate());\n        var hour = pad(d.getHours());\n        var min = pad(d.getMinutes());\n        var sec = pad(d.getSeconds());\n\n        document.getElementById(\""clock\"").innerHTML = year+\""/\""+month+\""/\""+day+\"" \""+hour+\"":\""+min+\"":\""+sec+\""\\xa0\\xa0\\xa0\"" ;\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n</script>\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:80px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""html""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":20,""x"":2,""y"":5},""id"":16,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div\n  style=\""border-radius:160px 10px; font-size:100px; color:white; text-align:center; font-weight:bold; background-image: linear-gradient(to right, #000046, #1CB5E0);\"">\n  <p>${lang_defect_reason_top5}</p>\n</div>\n\n\n\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""fieldConfig"":{""defaults"":{""color"":{""mode"":""continuous-RdYlGr""},""mappings"":[],""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]}},""overrides"":[]},""gridPos"":{""h"":4,""w"":4,""x"":2,""y"":10},""id"":24,""options"":{""colorMode"":""none"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""vertical"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":""/^defect$/"",""values"":true},""text"":{""valueSize"":45},""textMode"":""value""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT\r\n  Sum(de.defectqty) AS Top,\r\n  im.defect\r\nFROM\r\n  rp_qm_defect de\r\n  LEFT JOIN kbn_shoe_defectimage im ON de.defectcode = im.defectcode\r\nWHERE\r\n  datagroup in ($datagroup)\r\n  AND sublineno = '$sublineno'\r\n  AND productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n  AND stepname = '$stepname'\r\nGROUP BY\r\n  de.sublineno,\r\n  de.datagroup,\r\n  de.defectcode,\r\n  im.defect,\r\n  im.image\r\nORDER BY\r\n  top desc\r\nlimit\r\n  1 offset 0"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""fieldConfig"":{""defaults"":{""color"":{""mode"":""continuous-RdYlGr""},""mappings"":[],""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]}},""overrides"":[]},""gridPos"":{""h"":4,""w"":4,""x"":6,""y"":10},""id"":25,""options"":{""colorMode"":""none"",""graphMode"":""none"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":""/^defect$/"",""values"":true},""text"":{""valueSize"":45},""textMode"":""value""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT Sum(de.defectqty) AS Top,\r\n       im.defect\r\nFROM   rp_qm_defect de\r\n       LEFT JOIN kbn_shoe_defectimage im\r\n              ON de.defectcode = im.defectcode\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n       AND stepname = '$stepname'\r\nGROUP  BY de.sublineno,\r\n          de.datagroup,\r\n          de.defectcode,\r\n          im.defect,\r\n          im.image\r\nORDER  BY top desc\r\nlimit 1 offset 1"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""fieldConfig"":{""defaults"":{""color"":{""mode"":""continuous-RdYlGr""},""mappings"":[],""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]}},""overrides"":[]},""gridPos"":{""h"":4,""w"":4,""x"":10,""y"":10},""id"":26,""options"":{""colorMode"":""none"",""graphMode"":""none"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":""/^defect$/"",""values"":true},""text"":{""valueSize"":45},""textMode"":""value""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT Sum(de.defectqty) AS Top,\r\n       im.defect\r\nFROM   rp_qm_defect de\r\n       LEFT JOIN kbn_shoe_defectimage im\r\n              ON de.defectcode = im.defectcode\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n       AND stepname = '$stepname'\r\nGROUP  BY de.sublineno,\r\n          de.datagroup,\r\n          de.defectcode,\r\n          im.defect,\r\n          im.image\r\nORDER  BY top desc\r\nlimit 1 offset 2"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""fieldConfig"":{""defaults"":{""color"":{""mode"":""continuous-RdYlGr""},""mappings"":[],""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]}},""overrides"":[]},""gridPos"":{""h"":4,""w"":4,""x"":14,""y"":10},""id"":27,""options"":{""colorMode"":""none"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":""/^defect$/"",""values"":true},""text"":{""valueSize"":45},""textMode"":""value""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT Sum(de.defectqty) AS Top,\r\n       im.defect\r\nFROM   rp_qm_defect de\r\n       LEFT JOIN kbn_shoe_defectimage im\r\n              ON de.defectcode = im.defectcode\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n       AND stepname = '$stepname'\r\nGROUP  BY de.sublineno,\r\n          de.datagroup,\r\n          de.defectcode,\r\n          im.defect,\r\n          im.image\r\nORDER  BY top desc\r\nlimit 1 offset 3"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""fieldConfig"":{""defaults"":{""color"":{""mode"":""continuous-RdYlGr""},""mappings"":[],""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]}},""overrides"":[]},""gridPos"":{""h"":4,""w"":4,""x"":18,""y"":10},""id"":28,""options"":{""colorMode"":""none"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":""/^defect$/"",""values"":true},""text"":{""valueSize"":45},""textMode"":""value""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT Sum(de.defectqty) AS Top,\r\n       im.defect\r\nFROM   rp_qm_defect de\r\n       LEFT JOIN kbn_shoe_defectimage im\r\n              ON de.defectcode = im.defectcode\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n       AND stepname = '$stepname'\r\nGROUP  BY de.sublineno,\r\n          de.datagroup,\r\n          de.defectcode,\r\n          im.defect,\r\n          im.image\r\nORDER  BY top desc\r\nlimit 1 offset 4"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":2,""y"":14},""id"":18,""options"":{""autoPlay"":true,""controls"":true,""height"":0,""heightMode"":""auto"",""name"":""image"",""toolbar"":true,""width"":0,""widthMode"":""auto""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""WITH temp1 AS\r\n(\r\n\tSELECT    Sum(de.defectqty) AS TOP ,\r\n\t\t\t  im.defect,\r\n\t\t\t  im.image,\r\n\t\t\t  de.defectcode\r\n\tFROM      rp_qm_defect de\r\n\tLEFT JOIN kbn_shoe_defectimage im\r\n\tON        de.defectcode=im.defectcode\r\n\tWHERE     datagroup in ($datagroup)\r\n\tAND       sublineno = '$sublineno'\r\n\tAND       stepname ='$stepname'\r\n\tAND       productdate= To_char(CURRENT_DATE, 'YYYYMMDD')\r\n\tGROUP BY  de.sublineno ,\r\n\t\t\t  de.datagroup,\r\n\t\t\t  de.defectcode ,\r\n\t\t\t  im.defect,\r\n\t\t\t  im.image\r\n\tORDER BY  top DESC )\r\nSELECT (\r\n    CASE\r\n           WHEN (\r\n                    SELECT Count(*)\r\n                    FROM   temp1)='0' THEN\r\n                (\r\n                    SELECT image\r\n                    FROM   kbn_shoe_defectimage\r\n                    WHERE  defect = 'No')\r\n           WHEN\r\n                (\r\n                    SELECT image\r\n                    FROM   temp1 limit 1 offset 0) IS NOT NULL THEN\r\n                (\r\n                    SELECT image\r\n                    FROM   temp1 limit 1 offset 0)\r\n           ELSE\r\n                (\r\n\t\t\t\t\tSELECT image\r\n\t\t\t\t\tFROM   kbn_shoe_defectimage\r\n\t\t\t\t\tWHERE  defect ='No')\r\n    END )image"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""volkovlabs-image-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":6,""y"":14},""id"":20,""options"":{""autoPlay"":true,""controls"":true,""height"":0,""heightMode"":""auto"",""name"":""image"",""toolbar"":true,""width"":0,""widthMode"":""auto""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""WITH temp1 AS\r\n(\r\n\tSELECT    Sum(de.defectqty) AS TOP ,\r\n\t\t\t  im.defect,\r\n\t\t\t  im.image,\r\n\t\t\t  de.defectcode\r\n\tFROM      rp_qm_defect de\r\n\tLEFT JOIN kbn_shoe_defectimage im\r\n\tON        de.defectcode=im.defectcode\r\n\tWHERE     datagroup in ($datagroup)\r\n\tAND       sublineno = '$sublineno'\r\n\tAND       stepname ='$stepname'\r\n\tAND       productdate= To_char(CURRENT_DATE, 'YYYYMMDD')\r\n\tGROUP BY  de.sublineno ,\r\n\t\t\t  de.datagroup,\r\n\t\t\t  de.defectcode ,\r\n\t\t\t  im.defect,\r\n\t\t\t  im.image\r\n\tORDER BY  top DESC )\r\nSELECT (\r\n    CASE\r\n           WHEN (\r\n                    SELECT Count(*)\r\n                    FROM   temp1)='0' THEN\r\n                (\r\n                    SELECT image\r\n                    FROM   kbn_shoe_defectimage\r\n                    WHERE  defect = 'No')\r\n           WHEN\r\n                (\r\n                    SELECT image\r\n                    FROM   temp1 limit 1 offset 1) IS NOT NULL THEN\r\n                (\r\n                    SELECT image\r\n                    FROM   temp1 limit 1 offset 1)\r\n           ELSE\r\n                (\r\n\t\t\t\t\tSELECT image\r\n\t\t\t\t\tFROM   kbn_shoe_defectimage\r\n\t\t\t\t\tWHERE  defect ='No')\r\n    END )image"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""volkovlabs-image-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":10,""y"":14},""id"":22,""options"":{""autoPlay"":true,""controls"":true,""height"":0,""heightMode"":""auto"",""name"":""image"",""toolbar"":true,""width"":0,""widthMode"":""auto""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""WITH temp1 AS\r\n(\r\n\tSELECT    Sum(de.defectqty) AS TOP ,\r\n\t\t\t  im.defect,\r\n\t\t\t  im.image,\r\n\t\t\t  de.defectcode\r\n\tFROM      rp_qm_defect de\r\n\tLEFT JOIN kbn_shoe_defectimage im\r\n\tON        de.defectcode=im.defectcode\r\n\tWHERE     datagroup in ($datagroup)\r\n\tAND       sublineno = '$sublineno'\r\n\tAND       stepname ='$stepname'\r\n\tAND       productdate= To_char(CURRENT_DATE, 'YYYYMMDD')\r\n\tGROUP BY  de.sublineno ,\r\n\t\t\t  de.datagroup,\r\n\t\t\t  de.defectcode ,\r\n\t\t\t  im.defect,\r\n\t\t\t  im.image\r\n\tORDER BY  top DESC )\r\nSELECT (\r\n    CASE\r\n           WHEN (\r\n                    SELECT Count(*)\r\n                    FROM   temp1)='0' THEN\r\n                (\r\n                    SELECT image\r\n                    FROM   kbn_shoe_defectimage\r\n                    WHERE  defect = 'No')\r\n           WHEN\r\n                (\r\n                    SELECT image\r\n                    FROM   temp1 limit 1 offset 2) IS NOT NULL THEN\r\n                (\r\n                    SELECT image\r\n                    FROM   temp1 limit 1 offset 2)\r\n           ELSE\r\n                (\r\n\t\t\t\t\tSELECT image\r\n\t\t\t\t\tFROM   kbn_shoe_defectimage\r\n\t\t\t\t\tWHERE  defect ='No')\r\n    END )image"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""volkovlabs-image-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":14,""y"":14},""id"":19,""options"":{""autoPlay"":true,""controls"":true,""height"":0,""heightMode"":""auto"",""name"":""image"",""toolbar"":true,""width"":0,""widthMode"":""auto""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""WITH temp1 AS\r\n(\r\n\tSELECT    Sum(de.defectqty) AS TOP ,\r\n\t\t\t  im.defect,\r\n\t\t\t  im.image,\r\n\t\t\t  de.defectcode\r\n\tFROM      rp_qm_defect de\r\n\tLEFT JOIN kbn_shoe_defectimage im\r\n\tON        de.defectcode=im.defectcode\r\n\tWHERE     datagroup in ($datagroup)\r\n\tAND       sublineno = '$sublineno'\r\n\tAND       stepname ='$stepname'\r\n\tAND       productdate= To_char(CURRENT_DATE, 'YYYYMMDD')\r\n\tGROUP BY  de.sublineno ,\r\n\t\t\t  de.datagroup,\r\n\t\t\t  de.defectcode ,\r\n\t\t\t  im.defect,\r\n\t\t\t  im.image\r\n\tORDER BY  top DESC )\r\nSELECT (\r\n    CASE\r\n           WHEN (\r\n                    SELECT Count(*)\r\n                    FROM   temp1)='0' THEN\r\n                (\r\n                    SELECT image\r\n                    FROM   kbn_shoe_defectimage\r\n                    WHERE  defect = 'No')\r\n           WHEN\r\n                (\r\n                    SELECT image\r\n                    FROM   temp1 limit 1 offset 3) IS NOT NULL THEN\r\n                (\r\n                    SELECT image\r\n                    FROM   temp1 limit 1 offset 3)\r\n           ELSE\r\n                (\r\n\t\t\t\t\tSELECT image\r\n\t\t\t\t\tFROM   kbn_shoe_defectimage\r\n\t\t\t\t\tWHERE  defect ='No')\r\n    END )image"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""volkovlabs-image-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":12,""w"":4,""x"":18,""y"":14},""id"":21,""options"":{""autoPlay"":true,""controls"":true,""height"":0,""heightMode"":""auto"",""name"":""image"",""toolbar"":true,""width"":0,""widthMode"":""auto""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""WITH temp1 AS\r\n(\r\n\tSELECT    Sum(de.defectqty) AS TOP ,\r\n\t\t\t  im.defect,\r\n\t\t\t  im.image,\r\n\t\t\t  de.defectcode\r\n\tFROM      rp_qm_defect de\r\n\tLEFT JOIN kbn_shoe_defectimage im\r\n\tON        de.defectcode=im.defectcode\r\n\tWHERE     datagroup in ($datagroup)\r\n\tAND       sublineno = '$sublineno'\r\n\tAND       stepname ='$stepname'\r\n\tAND       productdate= To_char(CURRENT_DATE, 'YYYYMMDD')\r\n\tGROUP BY  de.sublineno ,\r\n\t\t\t  de.datagroup,\r\n\t\t\t  de.defectcode ,\r\n\t\t\t  im.defect,\r\n\t\t\t  im.image\r\n\tORDER BY  top DESC )\r\nSELECT (\r\n    CASE\r\n           WHEN (\r\n                    SELECT Count(*)\r\n                    FROM   temp1)='0' THEN\r\n                (\r\n                    SELECT image\r\n                    FROM   kbn_shoe_defectimage\r\n                    WHERE  defect = 'No')\r\n           WHEN\r\n                (\r\n                    SELECT image\r\n                    FROM   temp1 limit 1 offset 4) IS NOT NULL THEN\r\n                (\r\n                    SELECT image\r\n                    FROM   temp1 limit 1 offset 4)\r\n           ELSE\r\n                (\r\n\t\t\t\t\tSELECT image\r\n\t\t\t\t\tFROM   kbn_shoe_defectimage\r\n\t\t\t\t\tWHERE  defect ='No')\r\n    END )image"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""volkovlabs-image-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":14,""w"":4,""x"":2,""y"":26},""id"":30,""options"":{""content"":""<div class=\""card\"">\r\n  <div class=\""container1\"">\r\n    {{data.[0].top}}\r\n  </div>\r\n  <div class=\""bookmark1\"">TOP 1</div>\r\n</div>\r\n\r\n<style type=\""text/css\"">\r\n  .card {\r\n    box-shadow: 0 4px 8px 0 rgba(254, 250, 231, 0.3);\r\n    transition: 0.3s;\r\n    width: 100%;\r\n    height: 85%;\r\n    background-color: rgb(254, 250, 231);\r\n    border-radius: 30px;\r\n  }\r\n\r\n  .card:hover {\r\n    box-shadow: 0 8px 16px 0 rgba(254, 250, 231, 0.3);\r\n  }\r\n\r\n  .container1 {\r\n    padding: 120px 50px 30px 20px;\r\n    /*上 右 下 左*/\r\n    font-size: 200px;\r\n    color: #B73E3E;\r\n    text-align: center;\r\n  }\r\n\r\n  .bookmark1 {\r\n    position: absolute;\r\n    top: 3%;\r\n    right: 10%;\r\n    height: 2.2em;\r\n    width: 5em;\r\n    background-color: hsl(1, 83%, 29%);\r\n    background-image:\r\n      linear-gradient(hsla(0, 0%, 100%, 0),\r\n        hsla(0, 0%, 100%, 0.5) 5px,\r\n        hsla(0, 0%, 100%, 0) 25px);\r\n    -webkit-filter: drop-shadow(0 2px 6px hsla(0, 0%, 0%, 0.75));\r\n    box-sizing: border-box;\r\n    padding-top: 35px;\r\n    text-align: center;\r\n    color: #F5F0DD;\r\n    font-size: 65px;\r\n    font-family: Arial Black;\r\n    text-shadow: 0 -1px 0 hsla(0, 0%, 0%, 0.5);\r\n  }\r\n\r\n  .bookmark1:before,\r\n  .bookmark1:after {\r\n    content: '';\r\n    display: block;\r\n    position: absolute;\r\n  }\r\n\r\n  .bookmark1:before {\r\n    bottom: -50%;\r\n    height: 100%;\r\n    width: 100%;\r\n    background-image:\r\n      linear-gradient(-10deg,\r\n        transparent 50%,\r\n        hsl(1, 83%, 29%) 50%),\r\n      linear-gradient(10deg,\r\n        transparent 50%,\r\n        hsl(1, 83%, 29%)50%);\r\n    z-index: -1;\r\n  }\r\n\r\n  .bookmark1:after {\r\n    height: 115%;\r\n    width: 86%;\r\n    left: 7%;\r\n    top: 1px;\r\n    border-style: solid;\r\n    /*solid*/\r\n    border-color: rgb(254, 250, 231);\r\n    border-width: 0 8px;\r\n    pointer-events: none;\r\n  }\r\n</style>"",""defaultContent"":""<p style=\""font-size:45px; color:rgb(204, 204, 220); text-align:center;\"">\r\n  {{ variable \""lang_no_data\"" }}</p>"",""editor"":{""format"":""auto"",""height"":428,""language"":""html""},""everyRow"":false,""helpers"":""""},""pluginVersion"":""9.3.6"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT Sum(defectqty)AS Top\r\nFROM   rp_qm_defect\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n       AND stepname = '$stepname'\r\nGROUP  BY sublineno,\r\n          datagroup,\r\n          defectcode\r\nORDER  BY top DESC\r\nLIMIT  1 offset 0"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":14,""w"":4,""x"":6,""y"":26},""id"":32,""options"":{""content"":""<div class=\""card\"">\r\n  <div class=\""container2\"">\r\n    {{data.[0].top}}\r\n  </div>\r\n  <div class=\""bookmark2\"">TOP 2</div>\r\n</div>\r\n\r\n<style type=\""text/css\"">\r\n  .card {\r\n    box-shadow: 0 4px 8px 0 rgba(254, 250, 231, 0.3);\r\n    transition: 0.3s;\r\n    width: 100%;\r\n    height: 85%;\r\n    background-color: rgb(254, 250, 231);\r\n    border-radius: 30px;\r\n  }\r\n\r\n  .card:hover {\r\n    box-shadow: 0 8px 16px 0 rgba(254, 250, 231, 0.3);\r\n  }\r\n\r\n  .container2 {\r\n    padding: 120px 50px 30px 20px;\r\n    /*上 右 下 左*/\r\n    font-size: 200px;\r\n    color: #7A3E65;\r\n    text-align: center;\r\n  }\r\n\r\n  .bookmark2 {\r\n    position: absolute;\r\n    top: 3%;\r\n    right: 10%;\r\n    height: 2.2em;\r\n    width: 5em;\r\n    background-color: hsl(291, 36%, 22%);\r\n    background-image:\r\n      linear-gradient(hsla(0, 0%, 100%, 0),\r\n        hsla(0, 0%, 100%, 0.5) 5px,\r\n        hsla(0, 0%, 100%, 0) 25px);\r\n    -webkit-filter: drop-shadow(0 2px 6px hsla(0, 0%, 0%, 0.75));\r\n    box-sizing: border-box;\r\n    padding-top: 35px;\r\n    text-align: center;\r\n    color: #F5F0DD;\r\n    font-size: 65px;\r\n    font-family: Arial Black;\r\n    text-shadow: 0 -1px 0 hsla(0, 0%, 0%, 0.5);\r\n  }\r\n\r\n  .bookmark2:before,\r\n  .bookmark2:after {\r\n    content: '';\r\n    display: block;\r\n    position: absolute;\r\n  }\r\n\r\n  .bookmark2:before {\r\n    bottom: -50%;\r\n    height: 100%;\r\n    width: 100%;\r\n    background-image:\r\n      linear-gradient(-10deg,\r\n        transparent 50%,\r\n        hsl(291, 36%, 22%) 50%),\r\n      linear-gradient(10deg,\r\n        transparent 50%,\r\n        hsl(291, 36%, 22%) 50%);\r\n    z-index: -1;\r\n  }\r\n\r\n  .bookmark2:after {\r\n    height: 115%;\r\n    width: 86%;\r\n    left: 7%;\r\n    top: 1px;\r\n    border-style: solid;\r\n    /*solid*/\r\n    border-color: rgb(254, 250, 231);\r\n    border-width: 0 8px;\r\n    pointer-events: none;\r\n  }\r\n</style>"",""defaultContent"":""<p style=\""font-size:45px; color:rgb(204, 204, 220); text-align:center;\"">\r\n  {{ variable \""lang_no_data\"" }}</p>"",""editor"":{""format"":""auto"",""height"":439,""language"":""html""},""everyRow"":false,""helpers"":""""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT Sum(defectqty)AS Top\r\nFROM   rp_qm_defect\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n       AND stepname = '$stepname'\r\nGROUP  BY sublineno,\r\n          datagroup,\r\n          defectcode\r\nORDER  BY top DESC\r\nLIMIT  1 offset 1"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":14,""w"":4,""x"":10,""y"":26},""id"":34,""options"":{""content"":""<div class=\""card\"">\r\n  <div class=\""container3\"">\r\n    {{data.[0].top}}\r\n  </div>\r\n  <div class=\""bookmark3\"">TOP 3</div>\r\n</div>\r\n\r\n<style type=\""text/css\"">\r\n  .card {\r\n    box-shadow: 0 4px 8px 0 rgba(254, 250, 231, 0.3);\r\n    transition: 0.3s;\r\n    width: 100%;\r\n    height: 85%;\r\n    background-color: rgb(254, 250, 231);\r\n    border-radius: 30px;\r\n  }\r\n\r\n  .card:hover {\r\n    box-shadow: 0 8px 16px 0 rgba(254, 250, 231, 0.3);\r\n  }\r\n\r\n  .container3 {\r\n    padding: 120px 50px 30px 20px;\r\n    /*上 右 下 左*/\r\n    font-size: 200px;\r\n    color: #2C74B3;\r\n    text-align: center;\r\n  }\r\n\r\n  .bookmark3 {\r\n    position: absolute;\r\n    top: 3%;\r\n    right: 10%;\r\n    height: 2.2em;\r\n    width: 5em;\r\n    background-color: hsl(212, 100%, 18%);\r\n    background-image:\r\n      linear-gradient(hsla(0, 0%, 100%, 0),\r\n        hsla(0, 0%, 100%, 0.5) 5px,\r\n        hsla(0, 0%, 100%, 0) 25px);\r\n    -webkit-filter: drop-shadow(0 2px 6px hsla(0, 0%, 0%, 0.75));\r\n    box-sizing: border-box;\r\n    padding-top: 35px;\r\n    text-align: center;\r\n    color: #F5F0DD;\r\n    font-size: 65px;\r\n    font-family: Arial Black;\r\n    text-shadow: 0 -1px 0 hsla(0, 0%, 0%, 0.5);\r\n  }\r\n\r\n  .bookmark3:before,\r\n  .bookmark3:after {\r\n    content: '';\r\n    display: block;\r\n    position: absolute;\r\n  }\r\n\r\n  .bookmark3:before {\r\n    bottom: -50%;\r\n    height: 100%;\r\n    width: 100%;\r\n    background-image:\r\n      linear-gradient(-10deg,\r\n        transparent 50%,\r\n        hsl(212, 100%, 18%) 50%),\r\n      linear-gradient(10deg,\r\n        transparent 50%,\r\n        hsl(212, 100%, 18%) 50%);\r\n    z-index: -1;\r\n  }\r\n\r\n  .bookmark3:after {\r\n    height: 115%;\r\n    width: 86%;\r\n    left: 7%;\r\n    top: 1px;\r\n    border-style: solid;\r\n    /*solid*/\r\n    border-color: rgb(254, 250, 231);\r\n    border-width: 0 8px;\r\n    pointer-events: none;\r\n  }\r\n</style>"",""defaultContent"":""<p style=\""font-size:45px; color:rgb(204, 204, 220); text-align:center;\"">\r\n  {{ variable \""lang_no_data\"" }}</p>"",""editor"":{""format"":""auto"",""height"":470,""language"":""html""},""everyRow"":false,""helpers"":""""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT Sum(defectqty)AS Top\r\nFROM   rp_qm_defect\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n       AND stepname = '$stepname'\r\nGROUP  BY sublineno,\r\n          datagroup,\r\n          defectcode\r\nORDER  BY top DESC\r\nLIMIT  1 offset 2"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":14,""w"":4,""x"":14,""y"":26},""id"":36,""options"":{""content"":""<div class=\""card\"">\r\n  <div class=\""container4\"">\r\n    {{data.[0].top}}\r\n  </div>\r\n  <div class=\""bookmark4\"">TOP 4</div>\r\n</div>\r\n\r\n<style type=\""text/css\"">\r\n  .card {\r\n    box-shadow: 0 4px 8px 0 rgba(254, 250, 231, 0.3);\r\n    transition: 0.3s;\r\n    width: 100%;\r\n    height: 85%;\r\n    background-color: rgb(254, 250, 231);\r\n    border-radius: 30px;\r\n  }\r\n\r\n  .card:hover {\r\n    box-shadow: 0 8px 16px 0 rgba(254, 250, 231, 0.3);\r\n  }\r\n\r\n  .container4 {\r\n    padding: 120px 50px 30px 20px;\r\n    /*上 右 下 左*/\r\n    font-size: 200px;\r\n    color: #088395;\r\n    text-align: center;\r\n  }\r\n\r\n  .bookmark4 {\r\n    position: absolute;\r\n    top: 3%;\r\n    right: 10%;\r\n    height: 2.2em;\r\n    width: 5em;\r\n    background-color: hsl(197, 82%, 22%);\r\n    background-image:\r\n      linear-gradient(hsla(0, 0%, 100%, 0),\r\n        hsla(0, 0%, 100%, 0.5) 5px,\r\n        hsla(0, 0%, 100%, 0) 25px);\r\n    -webkit-filter: drop-shadow(0 2px 6px hsla(0, 0%, 0%, 0.75));\r\n    box-sizing: border-box;\r\n    padding-top: 35px;\r\n    text-align: center;\r\n    color: #F5F0DD;\r\n    font-size: 65px;\r\n    font-family: Arial Black;\r\n    text-shadow: 0 -1px 0 hsla(0, 0%, 0%, 0.5);\r\n  }\r\n\r\n  .bookmark4:before,\r\n  .bookmark4:after {\r\n    content: '';\r\n    display: block;\r\n    position: absolute;\r\n  }\r\n\r\n  .bookmark4:before {\r\n    bottom: -50%;\r\n    height: 100%;\r\n    width: 100%;\r\n    background-image:\r\n      linear-gradient(-10deg,\r\n        transparent 50%,\r\n        hsl(197, 82%, 22%) 50%),\r\n      linear-gradient(10deg,\r\n        transparent 50%,\r\n        hsl(197, 82%, 22%) 50%);\r\n    z-index: -1;\r\n  }\r\n\r\n  .bookmark4:after {\r\n    height: 115%;\r\n    width: 86%;\r\n    left: 7%;\r\n    top: 1px;\r\n    border-style: solid;\r\n    /*solid*/\r\n    border-color: rgb(254, 250, 231);\r\n    border-width: 0 8px;\r\n    pointer-events: none;\r\n  }\r\n</style>"",""defaultContent"":""<p style=\""font-size:45px; color:rgb(204, 204, 220); text-align:center;\"">\r\n  {{ variable \""lang_no_data\"" }}</p>"",""editor"":{""format"":""auto"",""height"":474,""language"":""html""},""everyRow"":false,""helpers"":""""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT Sum(defectqty)AS Top\r\nFROM   rp_qm_defect\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n       AND stepname = '$stepname'\r\nGROUP  BY sublineno,\r\n          datagroup,\r\n          defectcode\r\nORDER  BY top DESC\r\nLIMIT  1 offset 3"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":14,""w"":4,""x"":18,""y"":26},""id"":38,""options"":{""content"":""<div class=\""card\"">\r\n  <div class=\""container5\"">\r\n    {{data.[0].top}}\r\n  </div>\r\n  <div class=\""bookmark5\"">TOP 5</div>\r\n</div>\r\n\r\n<style type=\""text/css\"">\r\n  .card {\r\n    box-shadow: 0 4px 8px 0 rgba(254, 250, 231, 0.3);\r\n    transition: 0.3s;\r\n    width: 100%;\r\n    height: 85%;\r\n    background-color: rgb(254, 250, 231);\r\n    border-radius: 30px;\r\n  }\r\n\r\n  .card:hover {\r\n    box-shadow: 0 8px 16px 0 rgba(254, 250, 231, 0.3);\r\n  }\r\n\r\n  .container5 {\r\n    padding: 120px 50px 30px 20px;\r\n    /*上 右 下 左*/\r\n    font-size: 200px;\r\n    color: #F16821;\r\n    text-align: center;\r\n  }\r\n\r\n  .bookmark5 {\r\n    position: absolute;\r\n    top: 3%;\r\n    right: 10%;\r\n    height: 2.2em;\r\n    width: 5em;\r\n    background-color: hsl(20, 80%, 44%);\r\n    background-image:\r\n      linear-gradient(hsla(0, 0%, 100%, 0),\r\n        hsla(0, 0%, 100%, 0.5) 5px,\r\n        hsla(0, 0%, 100%, 0) 25px);\r\n    -webkit-filter: drop-shadow(0 2px 6px hsla(0, 0%, 0%, 0.75));\r\n    box-sizing: border-box;\r\n    padding-top: 35px;\r\n    text-align: center;\r\n    color: #F5F0DD;\r\n    font-size: 65px;\r\n    font-family: Arial Black;\r\n    text-shadow: 0 -1px 0 hsla(0, 0%, 0%, 0.5);\r\n  }\r\n\r\n  .bookmark5:before,\r\n  .bookmark5:after {\r\n    content: '';\r\n    display: block;\r\n    position: absolute;\r\n  }\r\n\r\n  .bookmark5:before {\r\n    bottom: -50%;\r\n    height: 100%;\r\n    width: 100%;\r\n    background-image:\r\n      linear-gradient(-10deg,\r\n        transparent 50%,\r\n        hsl(20, 80%, 44%) 50%),\r\n      linear-gradient(10deg,\r\n        transparent 50%,\r\n        hsl(20, 80%, 44%) 50%);\r\n    z-index: -1;\r\n  }\r\n\r\n  .bookmark5:after {\r\n    height: 115%;\r\n    width: 86%;\r\n    left: 7%;\r\n    top: 1px;\r\n    border-style: solid;\r\n    /*solid*/\r\n    border-color: rgb(254, 250, 231);\r\n    border-width: 0 8px;\r\n    pointer-events: none;\r\n  }\r\n</style>"",""defaultContent"":""<p style=\""font-size:45px; color:rgb(204, 204, 220); text-align:center;\"">\r\n  {{ variable \""lang_no_data\"" }}</p>"",""editor"":{""format"":""auto"",""height"":472,""language"":""html""},""everyRow"":false,""helpers"":""""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT Sum(defectqty)AS Top\r\nFROM   rp_qm_defect\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n       AND stepname = '$stepname'\r\nGROUP  BY sublineno,\r\n          datagroup,\r\n          defectcode\r\nORDER  BY top DESC\r\nLIMIT  1 offset 4"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[{Datagroupvariable.ToString()}],""value"":[{Datagroupvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""description"":""廠別+樓層"",""hide"":0,""includeAll"":false,""label"":""Facility_Floor"",""multi"":true,""name"":""datagroup"",""options"":[],""query"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{Buildno}"",""value"":""{Buildno}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""description"":""棟別"",""hide"":0,""includeAll"":false,""label"":""Build"",""multi"":false,""name"":""buildno"",""options"":[],""query"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{Sublineno}"",""value"":""{Sublineno}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT sublineno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY sublineno"",""description"":""線別"",""hide"":0,""includeAll"":false,""label"":""Line"",""multi"":false,""name"":""sublineno"",""options"":[],""query"":""SELECT DISTINCT sublineno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY sublineno"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{Stepname}"",""value"":""{Stepname}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT stepname\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND sublineno = '$sublineno'\nORDER  BY stepname"",""description"":""站點"",""hide"":0,""includeAll"":false,""label"":""Step"",""multi"":false,""name"":""stepname"",""options"":[],""query"":""SELECT DISTINCT stepname\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND sublineno = '$sublineno'\nORDER  BY stepname"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{language}"",""value"":""{language}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""前 5 大不良原因"",""value"":""前 5 大不良原因""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_defect_reason_top5'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_defect_reason_top5"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_defect_reason_top5'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""无资料"",""value"":""无资料""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_no_data'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_no_data"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_no_data'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""now-6h"",""to"":""now""},""timepicker"":{},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20121100001451,1703465550749
AI6WTfXeRyGocD0zZHl7u7,mes-shoe,shoe_style7,Type7:前五大不良型體,"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":511,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":13,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""shoe\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n<script>\n    document.getElementById(\""shoe\"").innerText = \""\\xa0\\xa0\"" + \""$stepname\"" + \""\\xa0\\xa0\"" + \""$sublineno\"";\n    \n    // 初始執行\n    updateClock();\n    \n    // 每秒更新一次\n    setInterval(updateClock, 1000);\n\n    function updateClock(){\n        var d = new Date();\n        var year = d.getFullYear();\n        var month = pad(d.getMonth()+1);\n        var day = pad(d.getDate());\n        var hour = pad(d.getHours());\n        var min = pad(d.getMinutes());\n        var sec = pad(d.getSeconds());\n\n        document.getElementById(\""clock\"").innerHTML = year+\""/\""+month+\""/\""+day+\"" \""+hour+\"":\""+min+\"":\""+sec+\""\\xa0\\xa0\\xa0\"" ;\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n</script>\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:80px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":16,""x"":4,""y"":5},""id"":17,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div\n  style=\""border-radius:200px 10px; font-size:100px; color:white; text-align:center; font-weight:bold; background-image: linear-gradient(to right, #000046, #1CB5E0);\"">\n  <p>${lang_defect_article_top5}</p>\n</div>"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":24,""w"":24,""x"":0,""y"":10},""id"":14,""options"":{""baidu"":{""callback"":""bmapReady"",""key"":""""},""editor"":{""format"":""auto"",""height"":600},""gaode"":{""key"":"""",""plugin"":""AMap.Scale,AMap.ToolBar""},""getOption"":""let defectqtys = [];\nlet defect_model = [];\nlet colorvalues;\ndata.series.map((s) => {\n  let cmp_defectqtys = s.fields.find((f) => f.name === 'defectqty');\n  let cmp_defect_models = s.fields.find((f) => f.name === 'zzmdnam');\n\n  if (cmp_defectqtys) {\n    defectqtys = cmp_defectqtys.values;\n  }\n  if (cmp_defect_models) {\n    defect_models = cmp_defect_models.values;\n  }\n});\n\n//顏色 Function=====================================================================================\nfunction colorFormat(params) {\n  if (params > 0) {\n    colorvalues = '#FE2E64'    //red\n  }\n  else if (params > 40) {\n    colorvalues = '#5470C6'      //blue\n  }\n  else if (params > 50) {\n    colorvalues = '#04B404'     //green\n  }\n  return colorvalues\n};\n\n\n\n\n\n\n\n\n\nif (defectqtys.length == 0) {  //暂无数据\n  return {\n    title: {\n      text: 'No Defect Data',\n      x: 'center',\n      y: 'center',\n      textStyle: {\n        fontSize: 100,\n        fontWeight: 'normal',\n      }\n    }\n  }\n\n}\n\n\n\n\n\n\n\nreturn {\n  backgroundColor: 'black',//背景色\n\n  grid: {\n    left: \""40%\"",\n    // top: \""100%\"",\n    right: \""5%\"",\n    // bottom: \""100%\"",\n    containLabel: false  // \n  },\n\n\n\n\n\n  yAxis: {\n    data: defect_models,\n    axisLabel: {\n      textStyle: {\n        show: true,\n        fontFamily: 'Arial',\n        color: \""#fff\"",\n        fontSize: '50',\n      },\n    }\n\n  },\n  xAxis: {\n    axisLabel: {\n      textStyle: {\n        show: true,\n        fontFamily: '微软雅黑',\n        color: \""#fff\"",\n        fontSize: '65',\n      },\n    }\n  },\n  series: [\n    {\n      type: 'bar',\n      label: {\n        show: true,\n        fontSize: '85',\n        fontWeight: 'bolder',\n        color: 'black'\n\n\n      },\n      data: [\n\n        {\n          value: defectqtys[0],\n          itemStyle: {\n            color: colorFormat(defectqtys[0]),\n            opacity: 1\n\n          }\n        },\n\n\n        {\n          value: defectqtys[1],\n          itemStyle: {\n            color: colorFormat(defectqtys[1]),\n            opacity: 1\n\n          }\n        },\n\n        {\n          value: defectqtys[2],\n          itemStyle: {\n            color: colorFormat(defectqtys[2]),\n            opacity: 1\n          }\n        },\n\n        {\n          value: defectqtys[3],\n          itemStyle: {\n            color: colorFormat(defectqtys[3]),\n            opacity: 1\n          }\n        },\n\n        {\n          value: defectqtys[4],\n          itemStyle: {\n            color: colorFormat(defectqtys[4]),\n            opacity: 1\n          }\n        },\n\n\n\n\n\n      ],\n\n\n\n    }\n  ]\n};"",""google"":{""callback"":""gmapReady"",""key"":""""},""map"":""json"",""renderer"":""canvas"",""themeEditor"":{""config"":""{}"",""height"":400,""name"":""default""}},""pluginVersion"":""9.0.6"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT fact_no,\r\n       sublineno,\r\n       datagroup,\r\n       zzmdnam,\r\n       Sum(defectqty) AS defectqty ---V1.3  2023/1/14增加datagroup\r\nFROM   rp_qm_article\r\nWHERE  productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n       AND datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND stepname  = '$stepname'\r\nGROUP  BY fact_no,\r\n          sublineno,\r\n          datagroup,\r\n          zzmdnam\r\nORDER  BY defectqty DESC\r\nLIMIT  5 "",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""volkovlabs-echarts-panel""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[{Datagroupvariable.ToString()}],""value"":[{Datagroupvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""description"":""廠別+樓層"",""hide"":0,""includeAll"":false,""label"":""Facility_Floor"",""multi"":true,""name"":""datagroup"",""options"":[],""query"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{Buildno}"",""value"":""{Buildno}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""description"":""棟別"",""hide"":0,""includeAll"":false,""label"":""Build"",""multi"":false,""name"":""buildno"",""options"":[],""query"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{Sublineno}"",""value"":""{Sublineno}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT sublineno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY sublineno"",""description"":""線別"",""hide"":0,""includeAll"":false,""label"":""Line"",""multi"":false,""name"":""sublineno"",""options"":[],""query"":""SELECT DISTINCT sublineno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY sublineno"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{Stepname}"",""value"":""{Stepname}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT stepname\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND sublineno = '$sublineno'\nORDER  BY stepname"",""description"":""站點"",""hide"":0,""includeAll"":false,""label"":""Step"",""multi"":false,""name"":""stepname"",""options"":[],""query"":""SELECT DISTINCT stepname\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND sublineno = '$sublineno'\nORDER  BY stepname"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{language}"",""value"":""{language}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""前 5 大不良型体"",""value"":""前 5 大不良型体""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_defect_article_top5'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_defect_article_top5"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_defect_article_top5'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""now-6h"",""to"":""now""},""timepicker"":{},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20121100001451,1703465559039
AI6WTfXeRyGocD0zZHl7u1,mes-shoe,shoe_style1,Type1:線別生產進度(含Defect),"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""target"":{""limit"":100,""matchAny"":false,""tags"":[],""type"":""dashboard""},""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":501,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":17,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""shoe\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n<script>\n    document.getElementById(\""shoe\"").innerText = \""\\xa0\\xa0\"" + \""$stepname\"" + \""\\xa0\\xa0\"" + \""$sublineno\"";\n    \n    // 初始執行\n    updateClock();\n    \n    // 每秒更新一次\n    setInterval(updateClock, 1000);\n\n    function updateClock(){\n        var d = new Date();\n        var year = d.getFullYear();\n        var month = pad(d.getMonth()+1);\n        var day = pad(d.getDate());\n        var hour = pad(d.getHours());\n        var min = pad(d.getMinutes());\n        var sec = pad(d.getSeconds());\n\n        document.getElementById(\""clock\"").innerHTML = year+\""/\""+month+\""/\""+day+\"" \""+hour+\"":\""+min+\"":\""+sec+\""\\xa0\\xa0\\xa0\"" ;\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n</script>\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:80px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""html""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""fieldConfig"":{""defaults"":{""color"":{""mode"":""thresholds""},""displayName"":""${lang_target_achieve_rate}"",""mappings"":[],""max"":106,""min"":0,""noValue"":""0"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""dark-green"",""value"":null},{""color"":""#90908e"",""value"":0},{""color"":""#1f8fff"",""value"":1},{""color"":""#1f8fff"",""value"":99},{""color"":""#04b404"",""value"":100},{""color"":""#facc2e"",""value"":101}]},""unit"":""percent""},""overrides"":[]},""gridPos"":{""h"":17,""w"":13,""x"":0,""y"":5},""id"":6,""options"":{""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":true},""showThresholdLabels"":false,""showThresholdMarkers"":true,""text"":{""titleSize"":90,""valueSize"":160}},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT CASE WHEN max(plan_qty) > 0 THEN (sum(time_yield)/max(plan_qty))*100 ELSE 0 END AS qty\r\n--SELECT (sum(time_yield)/max(plan_qty))*100 AS qty\r\nFROM  rp_time_yield\r\nWHERE datagroup in ($datagroup)\r\nand sublineno='$sublineno'\r\nand stepname='$stepname' \r\nAND productdate = to_char(current_timestamp ,'YYYYMMDD')\r\n"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""transformations"":[],""type"":""gauge""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""mode"":""thresholds""},""displayName"":""${lang_rft}"",""mappings"":[],""max"":100,""min"":0,""noValue"":""100%"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""#bdbdbd"",""value"":null},{""color"":""#fe2e64"",""value"":1},{""color"":""#fe2e64"",""value"":85},{""color"":""#04b404"",""value"":90}]},""unit"":""percent""},""overrides"":[]},""gridPos"":{""h"":17,""w"":11,""x"":13,""y"":5},""id"":7,""options"":{""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""showThresholdLabels"":false,""showThresholdMarkers"":true,""text"":{""titleSize"":90,""valueSize"":160}},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""SELECT ( 1 - COALESCE(( B.defectqty / A.yield_qty ) ,0) ) * 100 AS percentage\r\nFROM   (SELECT Sum(time_yield) AS yield_qty\r\n        FROM   rp_time_yield\r\n        WHERE  datagroup in ($datagroup)\r\n               AND sublineno = '$sublineno'\r\n               AND stepname = '$stepname'\r\n               AND productdate = To_char(CURRENT_DATE, 'YYYYMMDD')) A,\r\n       (SELECT Sum(defectqty) AS defectqty\r\n        FROM   rp_qm_defect\r\n        WHERE  datagroup in ($datagroup)\r\n               AND sublineno = '$sublineno'\r\n               AND stepname = '$stepname'\r\n               AND productdate = To_char(CURRENT_TIMESTAMP, 'YYYYMMDD')) B; \r\n"",""refId"":""defect"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""type"":""gauge""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""fixedColor"":""#bdbdbd"",""mode"":""fixed""},""displayName"":""${lang_target_qty}"",""mappings"":[],""noValue"":""0"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""#73BF69""}]},""unit"":""locale""},""overrides"":[]},""gridPos"":{""h"":15,""w"":8,""x"":0,""y"":22},""id"":2,""options"":{""colorMode"":""background"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""text"":{""titleSize"":90,""valueSize"":250},""textMode"":""auto""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""SELECT Max(plan_qty) AS qty\r\nFROM   rp_time_yield\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND stepname = '$stepname'\r\n       AND productdate = To_char(CURRENT_TIMESTAMP, 'YYYYMMDD') "",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""transformations"":[],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""fixedColor"":""#04b404"",""mode"":""fixed""},""displayName"":""${lang_output_qty}"",""mappings"":[],""noValue"":""0"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green""}]},""unit"":""locale""},""overrides"":[]},""gridPos"":{""h"":15,""w"":8,""x"":8,""y"":22},""id"":3,""options"":{""colorMode"":""background"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""text"":{""titleSize"":90,""valueSize"":250},""textMode"":""auto""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""hide"":false,""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""SELECT Sum(time_yield) AS qty\r\nFROM   rp_time_yield\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND stepname = '$stepname'\r\n       AND productdate = To_char(CURRENT_TIMESTAMP, 'YYYYMMDD') "",""refId"":""yield_qty"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""fixedColor"":""#fe2e64"",""mode"":""fixed""},""displayName"":""${lang_defect_qty}"",""mappings"":[],""noValue"":""0"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green""}]},""unit"":""locale""},""overrides"":[]},""gridPos"":{""h"":15,""w"":8,""x"":16,""y"":22},""id"":4,""options"":{""colorMode"":""background"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""text"":{""titleSize"":90,""valueSize"":250},""textMode"":""auto""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""SELECT Sum(defectqty)\r\nFROM   rp_qm_defect\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND stepname = '$stepname'\r\n       AND productdate = To_char(CURRENT_TIMESTAMP, 'YYYYMMDD') \r\n"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""type"":""stat""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[""6030_VNbc_3F"",""6030_VNbc_4F""],""value"":[""6030_VNbc_3F"",""6030_VNbc_4F""]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""description"":""廠別+樓層"",""hide"":0,""includeAll"":false,""label"":""Facility_Floor"",""multi"":true,""name"":""datagroup"",""options"":[],""query"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""C5"",""value"":""C5""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""description"":""棟別"",""hide"":0,""includeAll"":false,""label"":""Build"",""multi"":false,""name"":""buildno"",""options"":[],""query"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""C5-4E"",""value"":""C5-4E""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT sublineno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY sublineno"",""description"":""線別"",""hide"":0,""includeAll"":false,""label"":""Line"",""multi"":false,""name"":""sublineno"",""options"":[],""query"":""SELECT DISTINCT sublineno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY sublineno"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""ASB"",""value"":""ASB""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT stepname\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND sublineno = '$sublineno'\nORDER  BY stepname"",""description"":""站點"",""hide"":0,""includeAll"":false,""label"":""Step"",""multi"":false,""name"":""stepname"",""options"":[],""query"":""SELECT DISTINCT stepname\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND sublineno = '$sublineno'\nORDER  BY stepname"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""简体中文"",""value"":""zh_CN""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""目标达成率"",""value"":""目标达成率""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_achieve_rate'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_achieve_rate"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_achieve_rate'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""首次合格率"",""value"":""首次合格率""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_rft'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_rft"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_rft'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""目标数"",""value"":""目标数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产数"",""value"":""生产数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_output_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""不良数"",""value"":""不良数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_defect_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_defect_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_defect_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""2023-05-30T05:09:48.262Z"",""to"":""2023-06-01T05:09:48.262Z""},""timepicker"":{""refresh_intervals"":[""5s"",""10s"",""30s"",""1m"",""5m"",""15m"",""30m"",""1h"",""2h"",""1d""]},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20210900002148,1704704459124
AI6WTfXeRyGocD0zZHl7u2,mes-shoe,shoe_style2,Type2:線別生產進度(不含Defect),"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""target"":{""limit"":100,""matchAny"":false,""tags"":[],""type"":""dashboard""},""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":502,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":17,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""shoe\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n<script>\n    document.getElementById(\""shoe\"").innerText = \""\\xa0\\xa0\"" + \""$stepname\"" + \""\\xa0\\xa0\"" + \""$sublineno\"";\n    \n    // 初始執行\n    updateClock();\n    \n    // 每秒更新一次\n    setInterval(updateClock, 1000);\n\n    function updateClock(){\n        var d = new Date();\n        var year = d.getFullYear();\n        var month = pad(d.getMonth()+1);\n        var day = pad(d.getDate());\n        var hour = pad(d.getHours());\n        var min = pad(d.getMinutes());\n        var sec = pad(d.getSeconds());\n\n        document.getElementById(\""clock\"").innerHTML = year+\""/\""+month+\""/\""+day+\"" \""+hour+\"":\""+min+\"":\""+sec+\""\\xa0\\xa0\\xa0\"" ;\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n</script>\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:80px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""html""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""fixedColor"":""#04b404"",""mode"":""fixed""},""displayName"":""${lang_output_qty}"",""mappings"":[],""noValue"":""0"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]},""unit"":""locale""},""overrides"":[]},""gridPos"":{""h"":17,""w"":11,""x"":0,""y"":5},""id"":3,""options"":{""colorMode"":""background"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""text"":{""titleSize"":90,""valueSize"":250},""textMode"":""auto""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""hide"":false,""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""SELECT Sum(time_yield) AS qty\r\nFROM   rp_time_yield\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND stepname = '$stepname'\r\n       AND productdate = To_char(CURRENT_TIMESTAMP, 'YYYYMMDD') "",""refId"":""yield_qty"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""gridPos"":{""h"":32,""w"":13,""x"":11,""y"":5},""id"":6,""options"":{""baidu"":{""callback"":""bmapReady"",""key"":""""},""editor"":{""format"":""auto"",""height"":600},""gaode"":{""key"":"""",""plugin"":""AMap.Scale,AMap.ToolBar""},""getOption"":""let complete_rate = [];\nlet range_1 = [];\nlet range_2 = [];\nlet range_3 = [];\n\ndata.series.map((s) => {\n  let cmp_complete_rate = s.fields.find((f) => f.name === 'rate');\n\n  if (cmp_complete_rate) {\n    complete_rate = cmp_complete_rate.values;\n\n    range_1 = complete_rate[0] - 0.05;\n    range_2 = complete_rate[0] - 0.1;\n    range_3 = complete_rate[0] - 0.15;\n  }\n});\n\nreturn {\n  title: {\n    text: replaceVariables(\""${lang_target_achieve_rate}\"") + '\\n',\n    textStyle: {\n      color: 'white',\n      fontfamily: 'Microsoft YaHei',\n      align: 'center',\n      verticalAlibn: 'middle',\n      fontSize: 90\n    },\n    left: 'center'\n  },\n  series: [{\n    type: 'liquidFill',\n    data: [{\n      name: 'no data',\n      value: complete_rate[0]\n    }, range_1, range_2, range_3],\n    radius: '90%',\n    outline: {\n      show: true\n    },\n    backgroundStyle: {\n      borderColor: '#156ACF',\n      borderWidth: 1,\n      shadowColor: 'rgba(0, 0, 0, 0.4)',\n      shadowBlur: 20\n    },\n    shape: 'path://M367.855,428.202c-3.674-1.385-7.452-1.966-11.146-1.794c0.659-2.922,0.844-5.85,0.58-8.719 c-0.937-10.407-7.663-19.864-18.063-23.834c-10.697-4.043-22.298-1.168-29.902,6.403c3.015,0.026,6.074,0.594,9.035,1.728 c13.626,5.151,20.465,20.379,15.32,34.004c-1.905,5.02-5.177,9.115-9.22,12.05c-6.951,4.992-16.19,6.536-24.777,3.271 c-13.625-5.137-20.471-20.371-15.32-34.004c0.673-1.768,1.523-3.423,2.526-4.992h-0.014c0,0,0,0,0,0.014 c4.386-6.853,8.145-14.279,11.146-22.187c23.294-61.505-7.689-130.278-69.215-153.579c-61.532-23.293-130.279,7.69-153.579,69.202 c-6.371,16.785-8.679,34.097-7.426,50.901c0.026,0.554,0.079,1.121,0.132,1.688c4.973,57.107,41.767,109.148,98.945,130.793 c58.162,22.008,121.303,6.529,162.839-34.465c7.103-6.893,17.826-9.444,27.679-5.719c11.858,4.491,18.565,16.6,16.719,28.643 c4.438-3.126,8.033-7.564,10.117-13.045C389.751,449.992,382.411,433.709,367.855,428.202z',\n    label: {\n      position: ['38%', '40%'],\n      fontSize: 250,\n      color: '#D94854'\n    }\n  }]\n};"",""google"":{""callback"":""gmapReady"",""key"":""""},""map"":""json"",""renderer"":""canvas"",""themeEditor"":{""config"":""{}"",""height"":400,""name"":""default""}},""pluginVersion"":""9.3.6"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT CASE WHEN max(plan_qty) > 0 THEN (sum(time_yield)/max(plan_qty)) ELSE 0 END AS rate\r\nFROM  rp_time_yield\r\nWHERE datagroup in ($datagroup)\r\nand sublineno='$sublineno'\r\nand stepname='$stepname' \r\nAND productdate = to_char(current_timestamp ,'YYYYMMDD')"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""transformations"":[],""transparent"":true,""type"":""volkovlabs-echarts-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""fixedColor"":""#bdbdbd"",""mode"":""fixed""},""displayName"":""${lang_target_qty}"",""mappings"":[],""noValue"":""0"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""#73BF69"",""value"":null}]},""unit"":""locale""},""overrides"":[]},""gridPos"":{""h"":15,""w"":11,""x"":0,""y"":22},""id"":2,""options"":{""colorMode"":""background"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""text"":{""titleSize"":90,""valueSize"":250},""textMode"":""auto""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""SELECT Max(plan_qty) AS qty\r\nFROM   rp_time_yield\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND stepname = '$stepname'\r\n       AND productdate = To_char(CURRENT_TIMESTAMP, 'YYYYMMDD') "",""refId"":""plan_qty"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""transformations"":[],""type"":""stat""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[""6030_VNbc_3F"",""6030_VNbc_4F""],""value"":[""6030_VNbc_3F"",""6030_VNbc_4F""]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""description"":""廠別+樓層"",""hide"":0,""includeAll"":false,""label"":""Facility_Floor"",""multi"":true,""name"":""datagroup"",""options"":[],""query"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""C5"",""value"":""C5""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""description"":""棟別"",""hide"":0,""includeAll"":false,""label"":""Build"",""multi"":false,""name"":""buildno"",""options"":[],""query"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""C5-4E"",""value"":""C5-4E""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT sublineno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY sublineno"",""description"":""線別"",""hide"":0,""includeAll"":false,""label"":""Line"",""multi"":false,""name"":""sublineno"",""options"":[],""query"":""SELECT DISTINCT sublineno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY sublineno"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""ASB"",""value"":""ASB""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT stepname\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND sublineno = '$sublineno'\nORDER  BY stepname"",""description"":""站點"",""hide"":0,""includeAll"":false,""label"":""Step"",""multi"":false,""name"":""stepname"",""options"":[],""query"":""SELECT DISTINCT stepname\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND sublineno = '$sublineno'\nORDER  BY stepname"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""简体中文"",""value"":""zh_CN""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""目标达成率"",""value"":""目标达成率""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_achieve_rate'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_achieve_rate"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_achieve_rate'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""目标数"",""value"":""目标数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产数"",""value"":""生产数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_output_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""2023-05-30T05:09:48.262Z"",""to"":""2023-06-01T05:09:48.262Z""},""timepicker"":{""refresh_intervals"":[""5s"",""10s"",""30s"",""1m"",""5m"",""15m"",""30m"",""1h"",""2h"",""1d""]},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20210900002148,1704704494490
AI6WTfXeRyGocD0zZHl7u3,mes-shoe,shoe_style3,Type3:現場-投產狀況(含Defect),"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""target"":{""limit"":100,""matchAny"":false,""tags"":[],""type"":""dashboard""},""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":503,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":26,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""shoe\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n<script>\n    document.getElementById(\""shoe\"").innerText = \""\\xa0\\xa0${lang_production_progress_by_line}\"";\n    \n    // 初始執行\n    updateClock();\n    \n    // 每秒更新一次\n    setInterval(updateClock, 1000);\n\n    function updateClock(){\n        var d = new Date();\n        var year = d.getFullYear();\n        var month = pad(d.getMonth()+1);\n        var day = pad(d.getDate());\n        var hour = pad(d.getHours());\n        var min = pad(d.getMinutes());\n        var sec = pad(d.getSeconds());\n\n        document.getElementById(\""clock\"").innerHTML = year+\""/\""+month+\""/\""+day+\"" \""+hour+\"":\""+min+\"":\""+sec+\""\\xa0\\xa0\\xa0\"" ;\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n</script>\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:80px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":4,""y"":5},""id"":13,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" behavior=\""alternate\"">\n  <p style=\""line-height:160px; font-size:80px; color:White; background-color:#FACC2E;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_over_target}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":9,""y"":5},""id"":16,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" behavior=\""alternate\"">\n  <p style=\""line-height:160px; font-size:80px;  color:White; background-color:#04B404; text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_completed}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":14,""y"":5},""id"":17,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" behavior=\""alternate\"">\n  <p style=\""line-height:160px; font-size:80px;  color:White; background-color:rgb(31, 143, 255);  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_ongoing}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":19,""y"":5},""id"":18,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" behavior=\""alternate\"">\n  <p style=\""line-height:160px; font-size:80px;  color:White; background-color:#BDBDBD;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_not_start}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":1,""w"":24,""x"":0,""y"":10},""id"":15,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<style>\r\n\r\nth, td {\r\n  border: 3px solid black;\r\n  border-collapse: collapse;\r\n  height:180px;\r\n  width:750px;\r\n  font-weight:bold;\r\n}\r\n\r\n.PcgTable {\r\n  width: auto;\r\n  heigh: auto;\r\n  font-size: 75px;\r\n  text-align:center;\r\n  color : black;\r\n}\r\n.Pcgcolumn {\r\n background-color:#003377;\r\n  color : white;\r\n}\r\n\r\n</style>\r\n"",""mode"":""html""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""gridPos"":{""h"":21,""w"":24,""x"":0,""y"":11},""id"":24,""options"":{""content"":""<table class=\"" PcgTable\"">\r\n  <tr class=\""Pcgcolumn\"">\r\n    <td>{{ variable \""lang_line\"" }}</td>\r\n    <td>{{ variable \""lang_pdstatus\"" }}</td>\r\n    <td>{{ variable \""lang_target_qty\"" }}</td>\r\n    <td>{{ variable \""lang_output_qty\"" }}</td>\r\n    <td>{{ variable \""lang_achieve_rate\"" }}</td>\r\n    <td>{{ variable \""lang_rft\"" }}</td>\r\n  </tr>\r\n\r\n  {{#each data}}\r\n  {{#if (eq color \""Yellow\"")}}\r\n  <tr class=\""yellow-row\"">\r\n    {{else if (eq color \""Green\"")}}\r\n  <tr class=\""green-row\"">\r\n    {{else if (eq color \""Blue\"")}}\r\n  <tr class=\""blue-row\"">\r\n    {{else if (eq color \""Gray\"")}}\r\n  <tr class=\""gray-row\"">\r\n    {{/if}}\r\n    <td>{{newline}}</td>\r\n    <td>{{status}}</td>\r\n    <td>{{formatnumber plan_qty}}</td>\r\n    <td>{{formatnumber output_qty}}</td>\r\n    <td>{{formatpercent rate}}</td>\r\n    <td>{{formatpercent rft}}</td>\r\n  </tr>\r\n  {{/each}}\r\n</table>\r\n\r\n<style>\r\n  th,\r\n  td {\r\n    border: 3px solid black;\r\n    border-collapse: collapse;\r\n    height: auto;\r\n    width: auto;\r\n    font-weight: bold;\r\n\r\n  }\r\n\r\n  .PcgTable {\r\n    width: 100%;\r\n    height: auto;\r\n    font-size: 85px;\r\n    text-align: center;\r\n    color: black;\r\n  }\r\n\r\n  .Pcgcolumn {\r\n    background-color: #003377;\r\n    color: white;\r\n    /* width: auto; */\r\n    /* 不需要再次?置?度 */\r\n  }\r\n\r\n  .yellow-row {\r\n    background-color: rgb(250, 204, 46);\r\n  }\r\n\r\n  .green-row {\r\n    background-color: rgb(4, 180, 4);\r\n  }\r\n\r\n  .blue-row {\r\n    background-color: rgb(31, 143, 255);\r\n  }\r\n\r\n  .gray-row {\r\n    background-color: rgb(189, 189, 189);\r\n  }\r\n</style>"",""defaultContent"":""<div direction=\""right\"" height=\""150px\"" behavior=\""alternate\"">\r\n  <p style=\""font-size:100px; color:black; background-color:red;  text-align:center; font-weight:bold;\"">\r\n    {{ variable \""lang_no_data\"" }}</p>\r\n</div>"",""editor"":{""format"":""auto"",""height"":364,""language"":""html""},""everyRow"":false,""helpers"":""// 實現千分位\r\nhandlebars.registerHelper('formatnumber', function (num) {\r\n  num = num + '';\r\n  return num.replace(/(?=(?!^)(?:\\d{3})+(?:\\.|$))(\\d{3}(\\.\\d+$)?)/g, ',$1');\r\n});\r\n\r\n\r\n//實現%\r\n\r\n// 實現千分位\r\nhandlebars.registerHelper('formatpercent', function (num) {\r\n  num = num + '%';\r\n  return num;\r\n});\r\n""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""WITH temp1 AS (\r\n         SELECT sublineno,\r\n         \t\tstepname,\r\n                Max(plan_qty)   AS plan_qty,\r\n                Sum(time_yield) AS output_qty,\r\n                CASE WHEN Max(plan_qty) > 0 THEN Round((Sum(time_yield)/Max(plan_qty)) * 100, 2) ELSE 0 END AS rate\r\n         FROM   rp_time_yield\r\n         WHERE  productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n                AND datagroup in ($datagroup)\r\n                AND stepname = 'ASB'\r\n                AND '$buildno' = Substr(sublineno, 1, 2)\r\n         GROUP  BY sublineno,\r\n         \t\t   stepname,\r\n                   plan_qty), --temp1 從rp_time_yield取得配套、針車、成型站的計畫量和產量\r\n     temp2 AS (\r\n         SELECT sublineno,\r\n                Sum(defectqty) AS defect_qty\r\n         FROM   rp_qm_defect\r\n         WHERE  productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n                AND datagroup in ($datagroup)\r\n                AND stepname = 'ASB'\r\n                AND '$buildno' = Substr(sublineno, 1, 2)\r\n         GROUP  BY sublineno) --temp2 從rp_qm_defect取得配套、針車、成型站的不良數\r\nSELECT temp1.stepname || '_' || temp1.sublineno AS newline,\r\n       temp1.plan_qty,\r\n       temp1.output_qty,\r\n       temp1.rate,\r\n       Round(( temp1.output_qty - COALESCE(temp2.defect_qty, 0) ) / temp1.output_qty * 100, 2) AS rft,\r\n       CASE\r\n         WHEN temp1.rate = 0 THEN 'Not start'\r\n         WHEN temp1.rate > 100 THEN 'Over Target'\r\n         WHEN temp1.rate = 100 THEN 'Completed'\r\n         WHEN temp1.rate < 100 THEN 'On Going'\r\n       END AS status,\r\n       CASE\r\n         WHEN temp1.rate = 0 THEN 'Gray'\r\n         WHEN temp1.rate > 100 THEN 'Yellow'\r\n         WHEN temp1.rate = 100 THEN 'Green'\r\n         WHEN temp1.rate < 100 THEN 'Blue'\r\n       END AS color\r\nFROM   temp1\r\n       LEFT JOIN temp2\r\n              ON temp1.sublineno = temp2.sublineno"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""transformations"":[{""id"":""convertFieldType"",""options"":{""conversions"":[],""fields"":{}}}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[""6030_VNbc_3F"",""6030_VNbc_4F""],""value"":[""6030_VNbc_3F"",""6030_VNbc_4F""]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""description"":""廠別+樓層"",""hide"":0,""includeAll"":false,""label"":""Facility_Floor"",""multi"":true,""name"":""datagroup"",""options"":[],""query"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""C5"",""value"":""C5""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""description"":""棟別"",""hide"":0,""includeAll"":false,""label"":""Build"",""multi"":false,""name"":""buildno"",""options"":[],""query"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""简体中文"",""value"":""zh_CN""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""产线生产进度"",""value"":""产线生产进度""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_production_progress_by_line'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_production_progress_by_line"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_production_progress_by_line'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""超产"",""value"":""超产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_over_target"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""完工"",""value"":""完工""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_completed"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产中"",""value"":""生产中""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_ongoing"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""未投产"",""value"":""未投产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_not_start"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""线别"",""value"":""线别""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_line'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_line"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_line'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产状态"",""value"":""生产状态""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""目标数"",""value"":""目标数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产数"",""value"":""生产数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_output_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""达成率"",""value"":""达成率""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_achieve_rate'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_achieve_rate"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_achieve_rate'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""首次合格率"",""value"":""首次合格率""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_rft'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_rft"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_rft'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""无资料"",""value"":""无资料""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_no_data'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_no_data"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_no_data'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""now-6h"",""to"":""now""},""timepicker"":{""refresh_intervals"":[""5s"",""10s"",""30s"",""1m"",""5m"",""15m"",""30m"",""1h"",""2h"",""1d""]},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20210900002148,1704704529605
AI6WTfXeRyGocD0zZHl7u4,mes-shoe,shoe_style4,Type4:投產狀況(不含Defect),"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""target"":{""limit"":100,""matchAny"":false,""tags"":[],""type"":""dashboard""},""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":508,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":26,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""shoe\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n<script>\n    document.getElementById(\""shoe\"").innerText = \""\\xa0\\xa0${lang_production_progress_by_line}\"";\n    \n    // 初始執行\n    updateClock();\n    \n    // 每秒更新一次\n    setInterval(updateClock, 1000);\n\n    function updateClock(){\n        var d = new Date();\n        var year = d.getFullYear();\n        var month = pad(d.getMonth()+1);\n        var day = pad(d.getDate());\n        var hour = pad(d.getHours());\n        var min = pad(d.getMinutes());\n        var sec = pad(d.getSeconds());\n\n        document.getElementById(\""clock\"").innerHTML = year+\""/\""+month+\""/\""+day+\"" \""+hour+\"":\""+min+\"":\""+sec+\""\\xa0\\xa0\\xa0\"" ;\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n</script>\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:80px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":4,""y"":5},""id"":13,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" behavior=\""alternate\"">\n  <p style=\""line-height:160px; font-size:80px; color:White; background-color:#FACC2E;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_over_target}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":9,""y"":5},""id"":16,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\""  behavior=\""alternate\"">\n  <p style=\""line-height:160px; font-size:80px;  color:White; background-color:#04B404; text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_completed}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":14,""y"":5},""id"":17,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" behavior=\""alternate\"">\n  <p style=\""line-height:160px; font-size:80px; color:White; background-color:rgb(31, 143, 255);  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_ongoing}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":19,""y"":5},""id"":18,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" behavior=\""alternate\"">\n  <p style=\""line-height:160px; font-size:80px; color:White; background-color:#BDBDBD;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_not_start}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":1,""w"":24,""x"":0,""y"":10},""id"":15,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<style>\r\n\r\nth, td {\r\n  border: 3px solid black;\r\n  border-collapse: collapse;\r\n  height:180px;\r\n  width:750px;\r\n  font-weight:bold;\r\n}\r\n\r\n.PcgTable {\r\n  width: auto;\r\n  heigh: auto;\r\n  font-size: 75px;\r\n  text-align:center;\r\n  color : black;\r\n}\r\n.Pcgcolumn {\r\n background-color:#003377;\r\n  color : white;\r\n}\r\n\r\n</style>\r\n"",""mode"":""html""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""gridPos"":{""h"":21,""w"":24,""x"":0,""y"":11},""id"":24,""options"":{""content"":""<table class=\"" PcgTable\"">\r\n  <tr class=\""Pcgcolumn\"">\r\n    <td>{{ variable \""lang_line\"" }}</td>\r\n    <td>{{ variable \""lang_pdstatus\"" }}</td>\r\n    <td>{{ variable \""lang_target_qty\"" }}</td>\r\n    <td>{{ variable \""lang_output_qty\"" }}</td>\r\n    <td>{{ variable \""lang_achieve_rate\"" }}</td>\r\n  </tr>\r\n\r\n  {{#each data}}\r\n  {{#if (eq color \""Yellow\"")}}\r\n  <tr class=\""yellow-row\"">\r\n    {{else if (eq color \""Green\"")}}\r\n  <tr class=\""green-row\"">\r\n    {{else if (eq color \""Blue\"")}}\r\n  <tr class=\""blue-row\"">\r\n    {{else if (eq color \""Gray\"")}}\r\n  <tr class=\""gray-row\"">\r\n    {{/if}}\r\n    <td>{{newline}}</td>\r\n    <td>{{status}}</td>\r\n    <td>{{formatnumber plan_qty}}</td>\r\n    <td>{{formatnumber output_qty}}</td>\r\n    <td>{{formatpercent rate}}</td>\r\n  </tr>\r\n  {{/each}}\r\n</table>\r\n\r\n<style>\r\n  th,\r\n  td {\r\n    border: 3px solid black;\r\n    border-collapse: collapse;\r\n    height: auto;\r\n    width: auto;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .PcgTable {\r\n    width: 100%;\r\n    height: auto;\r\n    font-size: 85px;\r\n    text-align: center;\r\n    color: black;\r\n  }\r\n\r\n  .Pcgcolumn {\r\n    background-color: #003377;\r\n    color: white;\r\n    /* width: auto; */\r\n    /* 不需要再次?置?度 */\r\n  }\r\n\r\n  .yellow-row {\r\n    background-color: rgb(250, 204, 46);\r\n  }\r\n\r\n  .green-row {\r\n    background-color: rgb(4, 180, 4);\r\n  }\r\n\r\n  .blue-row {\r\n    background-color: rgb(31, 143, 255);\r\n  }\r\n\r\n  .gray-row {\r\n    background-color: rgb(189, 189, 189);\r\n  }\r\n</style>"",""defaultContent"":""<div direction=\""right\"" height=\""150px\"" behavior=\""alternate\"">\r\n  <p style=\""font-size:100px; color:black; background-color:red;  text-align:center; font-weight:bold;\"">\r\n    {{ variable: \""lang_no_data\"" }}</p>\r\n</div>"",""editor"":{""format"":""auto"",""height"":364,""language"":""html""},""everyRow"":false,""helpers"":""// 實現千分位\r\nhandlebars.registerHelper('formatnumber', function (num) {\r\n  num = num + '';\r\n  return num.replace(/(?=(?!^)(?:\\d{3})+(?:\\.|$))(\\d{3}(\\.\\d+$)?)/g, ',$1');\r\n});\r\n\r\n\r\n//實現%\r\n\r\n// 實現千分位\r\nhandlebars.registerHelper('formatpercent', function (num) {\r\n  num = num + '%';\r\n  return num;\r\n});\r\n""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""WITH temp1 AS (\r\n         SELECT sublineno,\r\n         \t\tstepname,\r\n                Max(plan_qty)   AS plan_qty,\r\n                Sum(time_yield) AS output_qty,\r\n                CASE WHEN Max(plan_qty) > 0 THEN Round((Sum(time_yield)/Max(plan_qty)) * 100, 2) ELSE 0 END AS rate\r\n         FROM   rp_time_yield\r\n         WHERE  productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n                AND datagroup in ($datagroup)\r\n                AND stepname = 'ASB'\r\n                AND '$buildno' = Substr(sublineno, 1, 2)\r\n         GROUP  BY sublineno,\r\n         \t\t   stepname,\r\n                   plan_qty), --temp1 從rp_time_yield取得配套、針車、成型站的計畫量和產量\r\n     temp2 AS (\r\n         SELECT sublineno,\r\n                Sum(defectqty) AS defect_qty\r\n         FROM   rp_qm_defect\r\n         WHERE  productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n                AND datagroup in ($datagroup)\r\n                AND stepname = 'ASB'\r\n                AND '$buildno' = Substr(sublineno, 1, 2)\r\n         GROUP  BY sublineno) --temp2 從rp_qm_defect取得配套、針車、成型站的不良數\r\nSELECT temp1.stepname || '_' || temp1.sublineno AS newline,\r\n       temp1.plan_qty,\r\n       temp1.output_qty,\r\n       temp1.rate,\r\n       CASE\r\n         WHEN temp1.rate = 0 THEN 'Not start'\r\n         WHEN temp1.rate > 100 THEN 'Over Target'\r\n         WHEN temp1.rate = 100 THEN 'Completed'\r\n         WHEN temp1.rate < 100 THEN 'On Going'\r\n       END AS status,\r\n       CASE\r\n         WHEN temp1.rate = 0 THEN 'Gray'\r\n         WHEN temp1.rate > 100 THEN 'Yellow'\r\n         WHEN temp1.rate = 100 THEN 'Green'\r\n         WHEN temp1.rate < 100 THEN 'Blue'\r\n       END AS color\r\nFROM   temp1\r\n       LEFT JOIN temp2\r\n              ON temp1.sublineno = temp2.sublineno"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""transformations"":[{""id"":""convertFieldType"",""options"":{""conversions"":[],""fields"":{}}}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[""6030_VNbc_4F"",""6030_VNbc_3F""],""value"":[""6030_VNbc_4F"",""6030_VNbc_3F""]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""description"":""廠別+樓層"",""hide"":0,""includeAll"":false,""label"":""Facility_Floor"",""multi"":true,""name"":""datagroup"",""options"":[],""query"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""C5"",""value"":""C5""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""description"":""棟別"",""hide"":0,""includeAll"":false,""label"":""Build"",""multi"":false,""name"":""buildno"",""options"":[],""query"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""简体中文"",""value"":""zh_CN""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""产线生产进度"",""value"":""产线生产进度""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_production_progress_by_line'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_production_progress_by_line"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_production_progress_by_line'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""超产"",""value"":""超产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_over_target"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""完工"",""value"":""完工""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_completed"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产中"",""value"":""生产中""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_ongoing"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""未投产"",""value"":""未投产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_not_start"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""线别"",""value"":""线别""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_line'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_line"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_line'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产状态"",""value"":""生产状态""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""目标数"",""value"":""目标数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产数"",""value"":""生产数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_output_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""达成率"",""value"":""达成率""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_achieve_rate'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_achieve_rate"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_achieve_rate'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""now-6h"",""to"":""now""},""timepicker"":{""refresh_intervals"":[""5s"",""10s"",""30s"",""1m"",""5m"",""15m"",""30m"",""1h"",""2h"",""1d""]},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20210900002148,1704704559762
AI6WTfXeRyGocD0zZHl7u5,mes-shoe,shoe_style5,Type5:組別時段產能,"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":509,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":27,""options"":{""code"":{""language"":""typescript"",""showLineNumbers"":true,""showMiniMap"":true},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""shoe\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n<script>\n    document.getElementById(\""shoe\"").innerText = \""\\xa0\\xa0\"" + \""$stepname\"" + \""\\xa0\\xa0\"" + \""$sublineno\"";\n    \n    // 初始執行\n    updateClock();\n    \n    // 每秒更新一次\n    setInterval(updateClock, 1000);\n\n    function updateClock(){\n        var d = new Date();\n        var year = d.getFullYear();\n        var month = pad(d.getMonth()+1);\n        var day = pad(d.getDate());\n        var hour = pad(d.getHours());\n        var min = pad(d.getMinutes());\n        var sec = pad(d.getSeconds());\n\n        document.getElementById(\""clock\"").innerHTML = year+\""/\""+month+\""/\""+day+\"" \""+hour+\"":\""+min+\"":\""+sec+\""\\xa0\\xa0\\xa0\"" ;\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n</script>\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:80px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":4,""w"":4,""x"":2,""y"":5},""id"":13,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\""  behavior=\""alternate\"">\n  <p style=\""line-height:120px; font-size:58px; color:White; background-color:#FACC2E;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_over_target}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":4,""w"":4,""x"":6,""y"":5},""id"":16,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""line-height:120px; font-size:58px; color:White; background-color:#04B404; text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_completed}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":4,""w"":4,""x"":10,""y"":5},""id"":17,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""line-height:120px; font-size:58px; color:White; background-color:rgb(31, 143, 255);  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_ongoing}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":4,""w"":4,""x"":14,""y"":5},""id"":18,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""line-height:120px; font-size:58px; color:White; background-color:#BDBDBD;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_not_start}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":4,""w"":4,""x"":18,""y"":5},""id"":37,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""line-height:120px; font-size:58px; color:White; background-color:#FE2E64;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_missed}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":28,""w"":19,""x"":0,""y"":9},""id"":26,""options"":{""baidu"":{""callback"":""bmapReady"",""key"":""""},""editor"":{""format"":""none"",""height"":1845},""gaode"":{""key"":"""",""plugin"":""AMap.Scale,AMap.ToolBar""},""getOption"":""let time_no = [];\nlet targets = [];\nlet outputs = [];\nlet sumoutputs = [];\nlet colorvalues = [];\nlet colortargets = [];\nlet nowtimes = [];\ndata.series.map((s) => {\n  let cmp_time_no = s.fields.find((f) => f.name === 'time_zone');\n  let cmp_targets = s.fields.find((f) => f.name === 'plan_qty');\n  let cmp_outputs = s.fields.find((f) => f.name === 'time_yield');\n  let cmp_nowtimes = s.fields.find((f) => f.name === 'nowtime');\n\n  if (cmp_time_no) {\n    time_no = cmp_time_no.values;\n  }\n  if (cmp_targets) {\n    targets = cmp_targets.values;\n  }\n  if (cmp_outputs) {\n    outputs = cmp_outputs.values;\n  }\n  if (cmp_nowtimes) {\n    nowtimes = cmp_nowtimes.values;\n  }\n});\n\n //千分位 Function\nfunction totalFormat(params) {\n  const str = params.toString();\n  const reg = str.indexOf('.') > -1 ? /(\\d)(?=(\\d{3})+\\.)/g : /(\\d)(?=(?:\\d{3})+$)/g;\n  return str.replace(reg, '$1,');\n};\n\n //顏色 Function=====================================================================================\nfunction colorFormat(params) {    \n for (i = 0; i < params.length; i++) {\nif(nowtimes[i]>time_no[i])\n    {\n       if(params[i]==0)  \n    {  \n     colorvalues[i]='rgba(189, 189, 189,1)'   //gray\n    }\n else if(params[i]>targets[i])  \n    {  \n     colorvalues[i]='rgba(250, 202, 46,1)'    //yellow\n    }\n  else if(params[i]<targets[i])\n    {\n       colorvalues[i]='rgba(254, 47, 102, 1)'   //red\n    }\n  else if(params[i]==targets[i])\n    {\n      colorvalues[i]=  'rgba(4, 180, 4,1)'     //green\n    }\n    }\nelse{\n\n if(params[i]==0)  \n    {  \n     colorvalues[i]='rgba(189, 189, 189,1)'   //gray\n    }\n else if(params[i]>targets[i])  \n    {  \n     colorvalues[i]='rgba(250, 202, 46,1)'    //yellow\n    }\n  else if(params[i]<targets[i])\n    {\n       colorvalues[i]='rgb(31, 143, 255)'   //blue\n    }\n  else if(params[i]==targets[i])\n    {\n      colorvalues[i]=  'rgba(4, 180, 4,1)'     //green\n    }\n\n \n      }\n\n\n\n\n\n\n                                      }\n  return colorvalues\n                            };\n//=============================================================================================================\n\nfunction colorFormattarget(params) {    \n for (i = 0; i < params.length; i++) {\n\nif(nowtimes[i]>time_no[i])\n    {\n       if(params[i]==0)  \n    {  \n     colortargets[i]='rgba(189, 189, 189,0.5)'   //gray\n    }\n else if(params[i]>targets[i])  \n    {  \n     colortargets[i]='rgba(250, 202, 46,0.5)'    //yellow\n    }\n  else if(params[i]<targets[i])\n    {\n       colortargets[i]='rgba(254, 47, 102, 0.5)'   //red\n    }\n  else if(params[i]==targets[i])\n    {\n      colortargets[i]=  'rgba(4, 180, 4,0.5)'     //green\n    }\n    }\nelse{\n\n if(params[i]==0)  \n    {  \n     colortargets[i]='rgba(189, 189, 189,0.5)'   //gray\n    }\n else if(params[i]>targets[i])  \n    {  \n     colortargets[i]='rgba(250, 202, 46,0.5)'    //yellow\n    }\n  else if(params[i]<targets[i])\n    {\n       colortargets[i]='rgb(31, 143, 255)'   //blue\n    }\n  else if(params[i]==targets[i])\n    {\n      colortargets[i]=  'rgba(4, 180, 4,0.5)'     //green\n    }\n\n\n\n}\n\n \n\n }\n  return colortargets\n  };\n\n\n//長條顯示label Function=====================================================================================\n\n\nif (time_no.length == 0) {  //暂无数据\n  return {\n    title: {\n      text: 'No  Produce Data',\n      x: 'center',\n      y: 'center',\n      textStyle: {\n        fontSize: 100,\n        fontWeight: 'normal',\n      }\n    }\n  }\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nreturn  {\n    backgroundColor: '#D9D2E9',//背景色\n    title: {\n        text: '',\n    },\n\n    // legend: {\n    //     data:['target','outputs']\n    // },\n\n    xAxis : [\n        {\n            type : 'category',\n            data : time_no,\n            axisLabel: {\n            formatter: '{value}',\n            textStyle: {\n            color: \""black\"",\n            fontSize: '46',\n            fontWeight: 'bolder',\n                       },\n                   }   \n        },\n\n         {\n      axisLine: { show: true },\n      axisTick: { show: true },\n      axisLabel: { show: false },\n      splitArea: { show: true },\n      splitLine: { show: true },\n      data: time_no,\n    },\n\n    ],\n\n    yAxis : [\n        {\n        type : 'value',\n        axisLabel: {\n            formatter: '{value}',\n            textStyle: {\n            color: \""black\"",\n            fontSize: '50',\n            fontWeight: 'bolder',\n                       },\n                   }   \n        }\n    ],\n    series : [\n     \n        {   type:'bar',\n            name:'outputs',\n            data: outputs,\n            stack: '總量',\n            itemStyle : {\n            color: function (params) {\n            var colorList = colorFormat(outputs);\n            return colorList[params.dataIndex]\n          },\n            },\n            label: {\n            show: true, fontSize: '40', fontWeight: 'bolder', position: 'top',\n            color: 'dark',\n              formatter:function (data) {\n                   if(data.value==0){  //為0時不顯示\n                       return ''\n                   }else{\n                         return totalFormat(data.value) //千分位 Function\n                        }\n                                        }\n                   }\n\n        },\n\n        {\n            type: 'bar',\n            xAxisIndex: 1,\n            name:'target',\n            data:[targets[0], targets[1], targets[2], targets[3], targets[4], targets[5], targets[6], targets[7], targets[8]],\n            itemStyle: {\n                           color: function (params) {\n                           var colorList = colorFormattarget(outputs);\n                           return colorList[params.dataIndex]\n          },\n                       },\n            label: {\n            show: false, fontSize: '50', fontWeight: 'bolder', position: 'top',\n            color: 'dark',\n                   }\n        \n         \n        }\n    ]\n};\n                    "",""google"":{""callback"":""gmapReady"",""key"":""""},""map"":""json"",""renderer"":""svg"",""themeEditor"":{""config"":""{}"",""height"":400,""name"":""default""}},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""WITH fact AS (\r\n       SELECT DISTINCT Substr(facilityname, 1, 4) AS fac_no\r\n       FROM   mes_outboundaopgroupctrl\r\n       WHERE  datagroup IN ($datagroup)\r\n), temp1 AS (\r\n       SELECT a.guide_sub,  --時段\r\n              --a.guide_type, --廠別\r\n              a.time_zone,  --每時段start\r\n              b.plan_qty,\r\n              b.productdate,\r\n              b.sublineno,\r\n              b.stepname,\r\n              To_char(current_timestamp, 'HH24')AS nowtime\r\n       FROM   (\r\n                     SELECT guide_sub,\r\n                            --guide_type,\r\n                            To_char(sub1::time,'HH24:MI') AS time_zone\r\n                     FROM   parm_guides par\r\n                     WHERE  guide_no = 'C03'\r\n                     AND    sub3='Y'\r\n                     AND    guide_type IN (SELECT fac_no FROM fact)\r\n                     GROUP BY guide_sub,\r\n                              time_zone)A,\r\n              (\r\n                              SELECT DISTINCT plan_qty,\r\n                                              productdate,\r\n                                              sublineno,\r\n                                              stepname\r\n                              FROM            rp_time_yield\r\n                              WHERE           datagroup IN ($datagroup)\r\n                              AND             sublineno = '$sublineno'\r\n                              AND             stepname = '$stepname'\r\n                              AND             productdate= To_char(CURRENT_DATE, 'YYYYMMDD'))B\r\n              --temp1 先將PLAN_QTY 抓出來　因為原本的SQL　PLAN_QTY與time_yield是同時出來　會導致看板　一開始PLAN_QTY會是0\r\n) ,temp2 AS (\r\n          SELECT    temp1.guide_sub,\r\n                    --temp1.guide_type,\r\n                    temp1.time_zone,\r\n                    temp1.plan_qty,\r\n                    temp1.productdate,\r\n                    rp.time_yield,\r\n                    temp1.nowtime\r\n          FROM      temp1\r\n          LEFT JOIN rp_time_yield rp\r\n          ON        temp1.productdate = rp.productdate\r\n          --AND       temp1.guide_type=rp.fact_no\r\n          AND       temp1.sublineno=rp.sublineno\r\n          AND       temp1.stepname=rp.stepname\r\n          AND       temp1.guide_sub=rp.time_id\r\n                    --temp2　再回left join　time_yield\r\n)\r\nSELECT   temp2.guide_sub,\r\n         temp2.time_zone,\r\n         (temp2.plan_qty/\r\n         (\r\n                SELECT Count(DISTINCT guide_sub)\r\n                FROM   parm_guides\r\n                WHERE  guide_no = 'C03'\r\n                AND    sub3='Y'\r\n                AND    guide_type IN (SELECT fac_no FROM fact))) AS plan_qty ,\r\n         COALESCE (temp2.time_yield,0)                           AS time_yield ,\r\n         temp2.nowtime\r\nFROM     temp2\r\nORDER BY time_zone;\r\n--最後plan_qty　要除於一天工時的比數　才是該時段的目標"",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""transparent"":true,""type"":""volkovlabs-echarts-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""mode"":""thresholds""},""displayName"":""${lang_target_achieve_rate}"",""mappings"":[],""max"":106,""min"":0,""noValue"":""0%"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null},{""color"":""#bdbdbd"",""value"":0},{""color"":""#1f8fff"",""value"":1},{""color"":""#1f8fff"",""value"":99},{""color"":""#04b404"",""value"":100},{""color"":""#facc2e"",""value"":101}]},""unit"":""percent""},""overrides"":[]},""gridPos"":{""h"":10,""w"":5,""x"":19,""y"":9},""id"":31,""options"":{""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""showThresholdLabels"":false,""showThresholdMarkers"":true,""text"":{""titleSize"":50,""valueSize"":100}},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT CASE WHEN Max(plan_qty) > 0 THEN ( Sum(time_yield) / Max(plan_qty) * 100 ) ELSE 0 END AS finsih\r\nFROM   rp_time_yield\r\nWHERE  productdate = To_char(CURRENT_DATE, 'YYYYMMDD')\r\n       AND datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND stepname = '$stepname' "",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""gauge""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""fixedColor"":""#04b404"",""mode"":""fixed""},""displayName"":""${lang_output_qty}"",""mappings"":[],""noValue"":""0"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]},""unit"":""locale""},""overrides"":[]},""gridPos"":{""h"":9,""w"":5,""x"":19,""y"":19},""id"":36,""options"":{""colorMode"":""background"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""text"":{""titleSize"":80,""valueSize"":150},""textMode"":""auto""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT Sum(time_yield) AS out_qty\r\nFROM   rp_time_yield\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND stepname = '$stepname'\r\n       AND productdate = To_char(CURRENT_DATE, 'YYYYMMDD') "",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""fixedColor"":""#bdbdbd"",""mode"":""fixed""},""displayName"":""${lang_target_qty}"",""mappings"":[],""noValue"":""0"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]},""unit"":""locale""},""overrides"":[]},""gridPos"":{""h"":9,""w"":5,""x"":19,""y"":28},""id"":35,""options"":{""colorMode"":""background"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""text"":{""titleSize"":80,""valueSize"":150},""textMode"":""auto""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""rawQuery"":true,""rawSql"":""SELECT DISTINCT plan_qty\r\nFROM   rp_time_yield\r\nWHERE  datagroup in ($datagroup)\r\n       AND sublineno = '$sublineno'\r\n       AND stepname = '$stepname'\r\n       AND productdate = To_char(CURRENT_DATE, 'YYYYMMDD') "",""refId"":""A"",""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50}}],""type"":""stat""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[""6030_VNbc_4F"",""6030_VNbc_3F""],""value"":[""6030_VNbc_4F"",""6030_VNbc_3F""]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""description"":""廠別+樓層"",""hide"":0,""includeAll"":false,""label"":""Facility_Floor"",""multi"":true,""name"":""datagroup"",""options"":[],""query"":""SELECT DISTINCT datagroup\nFROM   mes_outboundaopgroupctrl\nWHERE  ( datagroup IS NOT NULL AND datagroup <> '' )\n       AND stepname <> 'STF' --排除底加\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY datagroup"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""C5"",""value"":""C5""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""description"":""棟別"",""hide"":0,""includeAll"":false,""label"":""Build"",""multi"":false,""name"":""buildno"",""options"":[],""query"":""SELECT DISTINCT buildno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND char_length(buildno) > 1\nORDER  BY buildno"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""C5-4F"",""value"":""C5-4F""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT sublineno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY sublineno"",""description"":""線別"",""hide"":0,""includeAll"":false,""label"":""Line"",""multi"":false,""name"":""sublineno"",""options"":[],""query"":""SELECT DISTINCT sublineno\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND Substring(mainlineno, '99') IS NULL --排除機動線\nORDER  BY sublineno"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""ASB"",""value"":""ASB""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""SELECT DISTINCT stepname\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND sublineno = '$sublineno'\nORDER  BY stepname"",""description"":""站點"",""hide"":0,""includeAll"":false,""label"":""Step"",""multi"":false,""name"":""stepname"",""options"":[],""query"":""SELECT DISTINCT stepname\nFROM   mes_outboundaopgroupctrl\nWHERE  datagroup in ($datagroup)\n       AND buildno = '$buildno'\n       AND sublineno = '$sublineno'\nORDER  BY stepname"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""简体中文"",""value"":""zh_CN""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""产线生产进度"",""value"":""产线生产进度""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_production_progress_by_line'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_production_progress_by_line"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_production_progress_by_line'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""超产"",""value"":""超产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_over_target"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""完工"",""value"":""完工""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_completed"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产中"",""value"":""生产中""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_ongoing"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""未投产"",""value"":""未投产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_not_start"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""目标数"",""value"":""目标数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产数"",""value"":""生产数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_output_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""目标达成率"",""value"":""目标达成率""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_achieve_rate'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_achieve_rate"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_achieve_rate'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""未达标"",""value"":""未达标""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_missed'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_missed"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_missed'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""now-6h"",""to"":""now""},""timepicker"":{},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20210900002148,1704704582695
"9S-NFYvYSF67gllnGKVFo1",mes-sole,sole_style1,Type1:線別生產進度(含Defect),"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""target"":{""limit"":100,""matchAny"":false,""tags"":[],""type"":""dashboard""},""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":1281,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":13,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""sole\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n\n\n<script>\n  \n  var WorkShift = \""$WorkShift\"";\n  var n = 8; // 取前三位\n  var resultWorkShift = WorkShift.slice(-n);\n  document.getElementById(\""sole\"").innerText =\""\\xa0\\xa0\"" + \""${lang_product_progress} /\"" + \""\\xa0\\xa0\"" +  \""${ProductKind}_\"" + resultWorkShift;\n\n    //右側時間\n    $(\""#clock\"").ready(function(){\n        updateClock();\n    });\n\n    function updateClock(){\n        let d = new Date();\n        let year = d.getFullYear();\n        let month = pad(d.getMonth()+1);\n        let day = pad(d.getDate());\n        $(\""#clock\"").html(year+\""/\""+month+\""/\""+day+\"" \""+\""\\xa0\\xa0\\xa0\"");\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n\n\n</script>\n\n\n\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:80px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""html""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""fieldConfig"":{""defaults"":{""color"":{""mode"":""thresholds""},""displayName"":""${lang_target_achieve_rate}"",""mappings"":[],""max"":106,""min"":0,""noValue"":""0%"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null},{""color"":""#90908e"",""value"":0},{""color"":""#1e90ff"",""value"":1},{""color"":""#1e90ff"",""value"":99},{""color"":""#04b404"",""value"":100},{""color"":""#facc2e"",""value"":101}]},""unit"":""percent""},""overrides"":[]},""gridPos"":{""h"":17,""w"":12,""x"":0,""y"":5},""id"":6,""options"":{""orientation"":""vertical"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""showThresholdLabels"":false,""showThresholdMarkers"":true,""text"":{""titleSize"":65,""valueSize"":150}},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""SELECT (b.outputssum2 / a.targetsum1 * 100) AS FinishPercent\r\nFROM (\r\n  SELECT SUM(target) AS targetsum1\r\n  FROM kbn_sole_target t\r\n  WHERE datagroup IN ($Datagroup)\r\n    AND t.workdate = (SELECT TO_CHAR(CURRENT_DATE, 'YYYYMMDD'))\r\n    AND t.workshift in ($WorkShift)\r\n    AND t.stepname IN ($StepName)\r\n    AND t.resourcegroup IN ($Resourcegroup)\r\n) AS a,\r\n(\r\n  SELECT SUM(outputs) AS outputssum2\r\n  FROM kbn_sole_output t\r\n   WHERE datagroup IN ($Datagroup)\r\n    AND t.workdate = (SELECT TO_CHAR(CURRENT_DATE, 'YYYYMMDD'))\r\n    AND t.workshift in ($WorkShift)\r\n   AND t.stepname IN ($StepName)\r\n    AND t.resourcegroup IN ($Resourcegroup)\r\n) AS b;\r\n"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""type"":""gauge""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""fieldConfig"":{""defaults"":{""color"":{""mode"":""thresholds""},""displayName"":""$lang_rft"",""mappings"":[],""max"":100,""min"":0,""noValue"":""100%"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null},{""color"":""#fe2e64"",""value"":1},{""color"":""#fe2e64"",""value"":85},{""color"":""#04b404"",""value"":90}]},""unit"":""percent""},""overrides"":[]},""gridPos"":{""h"":17,""w"":12,""x"":12,""y"":5},""id"":14,""options"":{""orientation"":""vertical"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""showThresholdLabels"":false,""showThresholdMarkers"":true,""text"":{""titleSize"":70,""valueSize"":150}},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""SELECT COALESCE((1 - (COALESCE(a.defectsum1, 0) / COALESCE(b.outputssum2, 1))) * 100, 100) AS DefectPercent\r\nFROM (\r\n  SELECT SUM(defectqty) AS defectsum1\r\n  FROM kbn_sole_defect d\r\n  WHERE datagroup IN ($Datagroup)\r\n    AND d.workdate = (SELECT TO_CHAR(CURRENT_DATE, 'YYYYMMDD'))\r\n    AND d.workshift in ($WorkShift)\r\n    AND d.stepname IN ($StepName)\r\n    AND d.resourcegroup IN ($Resourcegroup)\r\n) AS a,\r\n(\r\n  SELECT SUM(outputs) AS outputssum2\r\n  FROM kbn_sole_output o\r\n   WHERE datagroup IN ($Datagroup)\r\n    AND o.workdate = (SELECT TO_CHAR(CURRENT_DATE, 'YYYYMMDD'))\r\n    AND workshift in ($WorkShift)\r\n    AND o.stepname IN ($StepName)\r\n    AND o.resourcegroup IN ($Resourcegroup)\r\n) AS b;\r\n"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""type"":""gauge""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""fixedColor"":""#bdbdbd"",""mode"":""fixed""},""displayName"":""${lang_target_qty}"",""mappings"":[],""noValue"":""0"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]},""unit"":""locale""},""overrides"":[]},""gridPos"":{""h"":16,""w"":8,""x"":0,""y"":22},""id"":2,""options"":{""colorMode"":""background"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""text"":{""titleSize"":90,""valueSize"":250},""textMode"":""auto""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select sum(target) as targetsum1 from kbn_sole_target t\r\n\t WHERE datagroup IN ($Datagroup)\r\n\tand       t.workdate=(select to_char(current_date, 'YYYYMMDD'))\r\n\tand       t.workshift in ($WorkShift)\r\n\tand       t.stepname IN ($StepName)\r\n\tand       t.resourcegroup IN ($Resourcegroup)"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""fixedColor"":""#04b404"",""mode"":""fixed""},""displayName"":""${lang_output_qty}"",""mappings"":[],""noValue"":""0"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]},""unit"":""locale""},""overrides"":[]},""gridPos"":{""h"":16,""w"":8,""x"":8,""y"":22},""id"":3,""options"":{""colorMode"":""background"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""text"":{""titleSize"":90,""valueSize"":250},""textMode"":""auto""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select sum(outputs) as outputssum2 from kbn_sole_output t\r\n\tWHERE    t.datagroup IN ($Datagroup)\r\n\tand       t.workdate=(select to_char(current_date, 'YYYYMMDD'))\r\n\tand       t.workshift in ($WorkShift)\r\n\tand       t.stepname IN ($StepName)\r\n\tand       t.resourcegroup IN ($Resourcegroup)"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""fixedColor"":""#fe2e64"",""mode"":""fixed""},""displayName"":""${lang_defect_qty}"",""mappings"":[],""noValue"":""0"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]},""unit"":""locale""},""overrides"":[]},""gridPos"":{""h"":16,""w"":8,""x"":16,""y"":22},""id"":4,""options"":{""colorMode"":""background"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""text"":{""titleSize"":90,""valueSize"":250},""textMode"":""auto""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select sum(defectqty) as defectsum1 from kbn_sole_defect d\r\n\tWHERE     d.datagroup IN ($Datagroup)\r\n\tand       d.workdate=(select to_char(current_date, 'YYYYMMDD'))\r\n\tand       d.workshift in ($WorkShift)\r\n\tand       d.stepname IN ($StepName)\r\n\tand       d.resourcegroup IN ($Resourcegroup)"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""type"":""stat""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[{Datagroupvariable.ToString()}],""value"":[{Datagroupvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct data_group from parm_line_m"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Datagroup"",""options"":[],""query"":""select distinct data_group from parm_line_m"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":[{shiftvariable.ToString()}],""value"":[{shiftvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct shift from parm_time_std"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""WorkShift"",""options"":[],""query"":""select distinct shift from parm_time_std"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Stepnamevariable.ToString()}],""value"":[{Stepnamevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""StepName"",""options"":[],""query"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Resourcevariable.ToString()}],""value"":[{Resourcevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Resourcegroup"",""options"":[],""query"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Productkindvariable.ToString()}],""value"":[{Productkindvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""ProductKind"",""options"":[],""query"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{language}"",""value"":""{language}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""Production Progress"",""value"":""Production Progress""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_product_progress'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_product_progress"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_product_progress'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""Target Achieve Rate"",""value"":""Target Achieve Rate""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_achieve_rate'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_achieve_rate"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_achieve_rate'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""RFT"",""value"":""RFT""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_rft'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_rft"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_rft'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""Target"",""value"":""Target""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""Output"",""value"":""Output""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_output_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""Defect Qty"",""value"":""Defect Qty""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_defect_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_defect_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_defect_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""now-6h"",""to"":""now""},""timepicker"":{""refresh_intervals"":[""5s"",""10s"",""30s"",""1m"",""5m"",""15m"",""30m"",""1h"",""2h"",""1d""]},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20210800000428,1704959050956
"9S-NFYvYSF67gllnGKVFo2",mes-sole,sole_style2,Type2:線別生產進度(不含Defect),"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""target"":{""limit"":100,""matchAny"":false,""tags"":[],""type"":""dashboard""},""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":1315,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":13,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""sole\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n\n\n<script>\n  \n  var WorkShift = \""$WorkShift\"";\n  var n = 8; // 取前三位\n  var resultWorkShift = WorkShift.slice(-n);\n  document.getElementById(\""sole\"").innerText =\""\\xa0\\xa0\"" + \""${lang_product_progress} /\"" + \""\\xa0\\xa0\"" +  \""${ProductKind}_\"" + resultWorkShift;\n\n  //右側時間\n    $(\""#clock\"").ready(function(){\n        updateClock();\n    });\n\n    function updateClock(){\n        let d = new Date();\n        let year = d.getFullYear();\n        let month = pad(d.getMonth()+1);\n        let day = pad(d.getDate());\n        $(\""#clock\"").html(year+\""/\""+month+\""/\""+day+\"" \""+\""\\xa0\\xa0\\xa0\"");\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n\n\n</script>\n\n\n\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:80px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""fixedColor"":""#04b404"",""mode"":""fixed""},""displayName"":""${lang_output_qty}"",""mappings"":[],""noValue"":""0"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]},""unit"":""locale""},""overrides"":[]},""gridPos"":{""h"":17,""w"":12,""x"":0,""y"":5},""id"":3,""options"":{""colorMode"":""background"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""text"":{""titleSize"":150,""valueSize"":250},""textMode"":""auto""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select sum(outputs) as outputssum2 from kbn_sole_output t\r\nWHERE datagroup IN ($Datagroup)  \r\n\tand       t.workdate=(select to_char(current_date, 'YYYYMMDD'))\r\n\tand       t.workshift in ($WorkShift)\r\n\tand       t.stepname IN ($StepName)\r\n\tand       t.resourcegroup IN ($Resourcegroup)"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""type"":""stat""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""gridPos"":{""h"":34,""w"":12,""x"":12,""y"":5},""id"":6,""options"":{""baidu"":{""callback"":""bmapReady"",""key"":""""},""editor"":{""format"":""auto"",""height"":600},""gaode"":{""key"":"""",""plugin"":""AMap.Scale,AMap.ToolBar""},""getOption"":""let complete_rate = [];\nlet range_1 = [];\nlet range_2 = [];\nlet range_3 = [];\n\ndata.series.map((s) => {\n  complete_rate = s.fields.find((f) => f.name === 'rate').values;\n  range_1 = complete_rate[0] - 0.05;\n  range_2 = complete_rate[0] - 0.1;\n  range_3 = complete_rate[0] - 0.15;\n});\n\nreturn {\n  title: {\n    text: replaceVariables(\""${lang_target_achieve_rate}\"") + '\\n',\n    textStyle: {\n      color: 'white',\n      fontfamily: 'Microsoft YaHei',\n      align: 'center',\n      verticalAlibn: 'middle',\n      fontSize: 70\n    },\n    left: 'center'\n  },\n  series: [{\n    type: 'liquidFill',\n    waveAnimation: false, // 關閉波浪動畫\n    animationDuration: 2000, // 初始動畫持續時間為2秒\n    animationDurationUpdate: 1000, // 更新動畫持續時間為1秒\n    data: [{\n      name: 'no data',\n      value: complete_rate[0]\n    }, range_1, range_2, range_3],\n    radius: '90%',\n    outline: {\n      show: true\n    },\n    backgroundStyle: {\n      borderColor: '#156ACF',\n      borderWidth: 1,\n      shadowColor: 'rgba(0, 0, 0, 0.4)',\n      shadowBlur: 20\n    },\n    shape: 'path://M367.855,428.202c-3.674-1.385-7.452-1.966-11.146-1.794c0.659-2.922,0.844-5.85,0.58-8.719 c-0.937-10.407-7.663-19.864-18.063-23.834c-10.697-4.043-22.298-1.168-29.902,6.403c3.015,0.026,6.074,0.594,9.035,1.728 c13.626,5.151,20.465,20.379,15.32,34.004c-1.905,5.02-5.177,9.115-9.22,12.05c-6.951,4.992-16.19,6.536-24.777,3.271 c-13.625-5.137-20.471-20.371-15.32-34.004c0.673-1.768,1.523-3.423,2.526-4.992h-0.014c0,0,0,0,0,0.014 c4.386-6.853,8.145-14.279,11.146-22.187c23.294-61.505-7.689-130.278-69.215-153.579c-61.532-23.293-130.279,7.69-153.579,69.202 c-6.371,16.785-8.679,34.097-7.426,50.901c0.026,0.554,0.079,1.121,0.132,1.688c4.973,57.107,41.767,109.148,98.945,130.793 c58.162,22.008,121.303,6.529,162.839-34.465c7.103-6.893,17.826-9.444,27.679-5.719c11.858,4.491,18.565,16.6,16.719,28.643 c4.438-3.126,8.033-7.564,10.117-13.045C389.751,449.992,382.411,433.709,367.855,428.202z',\n    label: {\n      position: ['38%', '40%'],\n      fontSize: 150,\n      color: '#D94854'\n    }\n  }]\n};"",""google"":{""callback"":""gmapReady"",""key"":""""},""map"":""none"",""renderer"":""canvas"",""themeEditor"":{""config"":""{}"",""height"":400,""name"":""default""}},""pluginVersion"":""9.3.6"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""SELECT (b.outputssum2 / a.targetsum1) AS rate\r\nFROM (\r\n  SELECT SUM(target) AS targetsum1\r\n  FROM kbn_sole_target t\r\n  WHERE t.datagroup IN ($Datagroup)\r\n    AND t.workdate = (SELECT TO_CHAR(CURRENT_DATE, 'YYYYMMDD'))\r\n    AND t.workshift in ($WorkShift)\r\n    and t.stepname IN ($StepName)\r\n    AND t.resourcegroup IN ($Resourcegroup)\r\n) AS a,\r\n(\r\n  SELECT SUM(outputs) AS outputssum2\r\n  FROM kbn_sole_output t\r\n  WHERE t.datagroup IN ($Datagroup)\r\n    AND t.workdate = (SELECT TO_CHAR(CURRENT_DATE, 'YYYYMMDD'))\r\n    AND t.workshift in ($WorkShift)\r\n    AND t.stepname IN ($StepName)\r\n    AND t.resourcegroup IN ($Resourcegroup)\r\n) AS b;\r\n"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""type"":""volkovlabs-echarts-panel""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""fieldConfig"":{""defaults"":{""color"":{""fixedColor"":""#bdbdbd"",""mode"":""fixed""},""displayName"":""${lang_target_qty}"",""mappings"":[],""noValue"":""0"",""thresholds"":{""mode"":""absolute"",""steps"":[{""color"":""green"",""value"":null}]},""unit"":""locale""},""overrides"":[]},""gridPos"":{""h"":17,""w"":12,""x"":0,""y"":22},""id"":2,""options"":{""colorMode"":""background"",""graphMode"":""area"",""justifyMode"":""center"",""orientation"":""auto"",""reduceOptions"":{""calcs"":[""lastNotNull""],""fields"":"""",""values"":false},""text"":{""titleSize"":150,""valueSize"":250},""textMode"":""auto""},""pluginVersion"":""10.1.2"",""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""select sum(target) as targetsum1 from kbn_sole_target t\r\n   WHERE datagroup IN ($Datagroup)  \r\n\tand       t.workdate=(select to_char(current_date, 'YYYYMMDD'))\r\n\tand       t.workshift in ($WorkShift)\r\n\tand       t.stepname IN ($StepName)\r\n\tand       t.resourcegroup IN ($Resourcegroup)"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""type"":""stat""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[{Datagroupvariable.ToString()}],""value"":[{Datagroupvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct data_group from parm_line_m"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Datagroup"",""options"":[],""query"":""select distinct data_group from parm_line_m"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""text"":[{shiftvariable.ToString()}],""value"":[{shiftvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct shift from parm_time_std"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""WorkShift"",""options"":[],""query"":""select distinct shift from parm_time_std"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Stepnamevariable.ToString()}],""value"":[{Stepnamevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""StepName"",""options"":[],""query"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Resourcevariable.ToString()}],""value"":[{Resourcevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""\nselect distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no\n"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Resourcegroup"",""options"":[],""query"":""\nselect distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no\n"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Productkindvariable.ToString()}],""value"":[{Productkindvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)\n"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""ProductKind"",""options"":[],""query"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)\n"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{language}"",""value"":""{language}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""Production Progress"",""value"":""Production Progress""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_product_progress'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_product_progress"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_product_progress'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""Target Achieve Rate"",""value"":""Target Achieve Rate""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_achieve_rate'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_achieve_rate"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_achieve_rate'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""Target"",""value"":""Target""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""Output"",""value"":""Output""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_output_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""now-6h"",""to"":""now""},""timepicker"":{""refresh_intervals"":[""5s"",""10s"",""30s"",""1m"",""5m"",""15m"",""30m"",""1h"",""2h"",""1d""]},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20210800000428,1704959061691
"9S-NFYvYSF67gllnGKVFo3",mes-sole,sole_style3,Type3:投產狀況(含Defect),"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""target"":{""limit"":100,""matchAny"":false,""tags"":[],""type"":""dashboard""},""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":1320,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":25,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""sole\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n\n\n<script>\n  \n  var WorkShift = \""$WorkShift\"";\n  var n = 8; // 取前三位\n  var resultWorkShift = WorkShift.slice(-n);\n  document.getElementById(\""sole\"").innerText =\""\\xa0\\xa0\"" + \""${lang_resource_product_progress} /\"" + \""\\xa0\\xa0\"" +  \""${ProductKind}_\"" + resultWorkShift;\n\n    //右側時間\n    $(\""#clock\"").ready(function(){\n        updateClock();\n    });\n\n    function updateClock(){\n        let d = new Date();\n        let year = d.getFullYear();\n        let month = pad(d.getMonth()+1);\n        let day = pad(d.getDate());\n        $(\""#clock\"").html(year+\""/\""+month+\""/\""+day+\"" \""+\""\\xa0\\xa0\\xa0\"");\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n\n\n</script>\n\n\n\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:62px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        font-size: 58px;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":4,""y"":5},""id"":13,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:85px; color:White; background-color:#FACC2E;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_over_target}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":9,""y"":5},""id"":16,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:90px; color:White; background-color:#04B404; text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_completed}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":14,""y"":5},""id"":17,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:100px; color:White; background-color:DodgerBlue;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_ongoing}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":19,""y"":5},""id"":18,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:92px; color:White; background-color:#BDBDBD;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_not_start}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""gridPos"":{""h"":26,""w"":24,""x"":0,""y"":10},""id"":24,""options"":{""content"":""<table class=\""PcgTable\"">\r\n  <tr class=\""Pcgcolumn\"">\r\n    <td>{{ variable \""lang_shift\"" }}</td>\r\n    <td>{{ variable \""lang_resource_group\"" }}</td>\r\n    <td>{{ variable \""lang_pdstatus\"" }}</td>\r\n    <td>{{ variable \""lang_target_qty\"" }}</td>\r\n    <td>{{ variable \""lang_output_qty\"" }}</td>\r\n    <td>{{ variable \""lang_achieve_rate\"" }}</td>\r\n    <td>{{ variable \""lang_rft\"" }}</td>\r\n  </tr>\r\n\r\n  {{#each data}}\r\n  {{#if (eq color \""Yellow\"")}}\r\n  <tr class=\""yellow-row\"">\r\n    {{else if (eq color \""Green\"")}}\r\n  <tr class=\""green-row\"">\r\n    {{else if (eq color \""Blue\"")}}\r\n  <tr class=\""blue-row\"">\r\n    {{else if (eq color \""Gray\"")}}\r\n  <tr class=\""gray-row\"">\r\n    {{/if}}\r\n    <td>{{workshift}}</td>\r\n    <td>{{resourcegroup}}</td>\r\n    <td>{{status}}</td>\r\n    <td>{{formatnumber target}}</td>\r\n    <td>{{formatnumber outputs}}</td>\r\n    <td>{{formatpercent archieverate}}</td>\r\n    <td>{{formatpercent rft}}</td>\r\n  </tr>\r\n  {{/each}}\r\n</table>\r\n\r\n<style>\r\n  th,\r\n  td {\r\n    border: 3px solid black;\r\n    border-collapse: collapse;\r\n    height: auto;\r\n    width: auto;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .PcgTable {\r\n    width: 100%;\r\n    height: 100%;\r\n    font-size: 70px;\r\n    text-align: center;\r\n    color: black;\r\n  }\r\n\r\n  .Pcgcolumn {\r\n    background-color: #003377;\r\n    color: white;\r\n    /* width: auto; */\r\n    /* 不需要再次设置宽度 */\r\n  }\r\n\r\n  /* 調整 shift 欄位寬度 */\r\n  /*\r\n  td:nth-child(1) {\r\n    width: 25%;\r\n  }\r\n\r\n  td:nth-child(2) {\r\n    width: 35%;\r\n  }\r\n\r\n  td:nth-child(6) {\r\n    width: 30%;\r\n  }\r\n  */\r\n\r\n  /* 調整 RFT 欄位寬度 */\r\n  /*\r\n  td:nth-child(7) {\r\n    width: 30%;\r\n  }\r\n  */\r\n\r\n\r\n  .yellow-row {\r\n    background-color: rgb(250, 204, 46);\r\n  }\r\n\r\n  .green-row {\r\n    background-color: rgb(4, 180, 4);\r\n  }\r\n\r\n  .blue-row {\r\n    background-color: DodgerBlue;\r\n  }\r\n\r\n  .gray-row {\r\n    background-color: rgb(189, 189, 189);\r\n  }\r\n</style>"",""defaultContent"":""<div direction=\""right\"" height=\""150px\"" behavior=\""alternate\"">\r\n  <p style=\""font-size:100px; color:black; background-color:red;  text-align:center; font-weight:bold;\"">\r\n    No Produce Data</p>\r\n</div>"",""editor"":{""format"":""auto"",""height"":1721,""language"":""html""},""everyRow"":false,""helpers"":""// 實現千分位\r\nhandlebars.registerHelper('formatnumber', function (num) {\r\n  num = num + '';\r\n  return num.replace(/(?=(?!^)(?:\\d{3})+(?:\\.|$))(\\d{3}(\\.\\d+$)?)/g, ',$1');\r\n});\r\n\r\n\r\n\r\n//實現%\r\nhandlebars.registerHelper('formatpercent', function (num) {\r\n  num = num + '%';\r\n  return num;\r\n});\r\n""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""  WITH Temp1 as(\r\n  select SPLIT_PART(workshift, '_', 3) AS workshift, sum(target)target,resourcegroup  from kbn_sole_target where\r\n     workdate= (select to_char(current_date, 'YYYYMMDD'))\r\n     and datagroup IN ($Datagroup)\r\n     and workshift IN ($WorkShift)\r\n     and  stepname IN ($StepName)\r\n     and resourcegroup IN ($Resourcegroup)\r\n     group by SPLIT_PART(workshift, '_', 3),resourcegroup\r\n   ),\r\n    Temp2 as(\r\n  select SPLIT_PART(workshift, '_', 3) AS workshift, sum(outputs)outputs,resourcegroup from kbn_sole_output where \r\n     workdate= (select to_char(current_date, 'YYYYMMDD'))\r\n     and datagroup IN ($Datagroup)\r\n     and workshift IN ($WorkShift)\r\n     and  stepname IN ($StepName)\r\n     and  resourcegroup IN ($Resourcegroup)\r\n     group by SPLIT_PART(workshift, '_', 3),resourcegroup\r\n   ) ,\r\n     Temp3 as (\r\n   select SPLIT_PART(workshift, '_', 3) AS workshift, sum(defectqty)defectqty,resourcegroup from kbn_sole_defect  where \r\n     workdate= (select to_char(current_date, 'YYYYMMDD'))\r\n     and datagroup IN ($Datagroup)\r\n     and   workshift IN ($WorkShift)\r\n     and  stepname IN ($StepName)\r\n     and resourcegroup IN ($Resourcegroup)\r\n     group by SPLIT_PART(workshift, '_', 3),resourcegroup\r\n   ),\r\n   \r\n   Temp4 as (\r\n    SELECT substring(Temp1.workshift FROM LENGTH(Temp1.workshift) - 7) AS workshift ,\r\n    substring( Temp1.resourcegroup FROM LENGTH(Temp1.resourcegroup) - 6) AS resourcegroup ,\r\n    coalesce(Temp1.target,0)as target ,\r\n    coalesce(Temp2.outputs,0)as outputs , \r\n    coalesce(round(Temp2.outputs/Temp1.target*100,1),0) as ArchieveRate,\r\n    ROUND(COALESCE((1 - (COALESCE(Temp3.defectqty, 0) / COALESCE(Temp2.outputs, 1))) * 100, 100), 1) AS RFT\r\n    from Temp1 left join temp2 on Temp1.workshift=Temp2.workshift and temp1.resourcegroup=temp2.resourcegroup\r\n    left join temp3  on Temp1.workshift=Temp3.workshift and temp1.resourcegroup=temp3.resourcegroup\r\n   \r\n   ) select workshift,resourcegroup,\r\n   CASE  \r\n   when (outputs)=0        then 'Not Start'\r\n   when (outputs-target)>0 then 'Over Target'\r\n   when (outputs-target)=0 then 'Completed'\r\n   when (outputs-target)<0 then 'On Going'\r\n   end  as status\r\n   ,target,outputs,ArchieveRate,RFT,\r\n   CASE  \r\n   when (outputs)=0        then 'Gray'\r\n   when (outputs-target)>0 then 'Yellow'\r\n   when (outputs-target)=0 then 'Green'\r\n   when (outputs-target)<0 then 'Blue'\r\n   end  as color\r\n   from  Temp4\r\n   order by workshift, resourcegroup\r\n   limit 5 "",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""},{""collapsed"":false,""gridPos"":{""h"":1,""w"":24,""x"":0,""y"":36},""id"":9,""panels"":[],""type"":""row""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[{Datagroupvariable.ToString()}],""value"":[{Datagroupvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct data_group from parm_line_m"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Datagroup"",""options"":[],""query"":""select distinct data_group from parm_line_m"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{shiftvariable.ToString()}],""value"":[{shiftvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct shift from parm_time_std"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""WorkShift"",""options"":[],""query"":""select distinct shift from parm_time_std"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Stepnamevariable.ToString()}],""value"":[{Stepnamevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""StepName"",""options"":[],""query"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Resourcevariable.ToString()}],""value"":[{Resourcevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""\nselect distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Resourcegroup"",""options"":[],""query"":""\nselect distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Productkindvariable.ToString()}],""value"":[{Productkindvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)\n"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""ProductKind"",""options"":[],""query"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)\n"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{language}"",""value"":""{language}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""各机群生产进度"",""value"":""各机群生产进度""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_resource_product_progress'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_resource_product_progress"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_resource_product_progress'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""超产"",""value"":""超产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_over_target"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""完工"",""value"":""完工""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_completed"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产中"",""value"":""生产中""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_ongoing"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""未投产"",""value"":""未投产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_not_start"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""Shift"",""value"":""Shift""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_shift'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_shift"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_shift'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""机群"",""value"":""机群""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_resource_group'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_resource_group"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_resource_group'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产状态"",""value"":""生产状态""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""达成率"",""value"":""达成率""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_achieve_rate'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_achieve_rate"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_achieve_rate'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""目标数"",""value"":""目标数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产数"",""value"":""生产数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_output_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""首次合格率"",""value"":""首次合格率""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_rft'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_rft"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_rft'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""now-6h"",""to"":""now""},""timepicker"":{""refresh_intervals"":[""5s"",""10s"",""30s"",""1m"",""5m"",""15m"",""30m"",""1h"",""2h"",""1d""]},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20210800000428,1704959075820
"9S-NFYvYSF67gllnGKVFo4",mes-sole,sole_style4,Type4:投產狀況(不含Defect),"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""target"":{""limit"":100,""matchAny"":false,""tags"":[],""type"":""dashboard""},""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":1323,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":25,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\n    <p class=\""active\"" id =\""sole\""></p>\n    <p id =\""clock\""></p>\n</ul>\n\n\n\n<script>\n  \n  var WorkShift = \""$WorkShift\"";\n  var n = 8; // 取前三位\n  var resultWorkShift = WorkShift.slice(-n);\n  document.getElementById(\""sole\"").innerText =\""\\xa0\\xa0\"" + \""${lang_resource_product_progress} /\"" + \""\\xa0\\xa0\"" +  \""${ProductKind}_\"" + resultWorkShift;\n\n    \n//右側時間\n    $(\""#clock\"").ready(function(){\n        updateClock();\n    });\n\n    function updateClock(){\n        let d = new Date();\n        let year = d.getFullYear();\n        let month = pad(d.getMonth()+1);\n        let day = pad(d.getDate());\n        $(\""#clock\"").html(year+\""/\""+month+\""/\""+day+\"" \""+\""\\xa0\\xa0\\xa0\"");\n    }\n\n    function pad(v){\n        return (v<10)?'0'+v:v\n    }    \n\n\n</script>\n\n\n\n\n<style type=\""text/css\"">\n    .example {\n        overflow: hidden;\n        background: #A7B6E2;\n        height: 160px;\n        padding: 0;\n        line-height: 160px;\n        color: #2B4182;\n        font-weight:bold;\n        font-size:62px;\n        margin:0px 0px 0px -24px; /*上右下左*/\n    }\n\n    .example > p {\n        float: left;\n        position: relative;\n        width: 50%;\n        text-align: right;\n        list-style: none;\n        height: 100%;\n    }\n\n    .example > p:before, .example > p:after {\n        position: absolute;\n        top: 0;\n    }\n\n    .example > p:before {\n        width: 160px;\n        height: 160px;\n        right: -159px;\n        background: inherit;\n    }\n\n    .example > p:after {\n        right: -160px;\n        border: 80px solid;\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\n        \n    }\n\n    .example > p.active {\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\n        text-align: left;\n        font-size: 58px;\n        color:#FCEC03;\n    }\n\n    .example > p.active:before, .example > p.active:after {\n        content: '';\n        \n    }\n</style>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":4,""y"":5},""id"":13,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:85px; color:White; background-color:#FACC2E;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_over_target}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":9,""y"":5},""id"":16,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:90px; color:White; background-color:#04B404; text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_completed}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":14,""y"":5},""id"":17,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:100px; color:White; background-color:DodgerBlue;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_ongoing}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":19,""y"":5},""id"":18,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:92px; color:White; background-color:#BDBDBD;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_not_start}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""gridPos"":{""h"":24,""w"":24,""x"":0,""y"":10},""id"":24,""options"":{""content"":""<table class=\""PcgTable\"">\r\n  <tr class=\""Pcgcolumn\"">\r\n    <td>{{ variable \""lang_shift\"" }}</td>\r\n    <td>{{ variable \""lang_resource_group\"" }}</td>\r\n    <td>{{ variable \""lang_pdstatus\"" }}</td>\r\n    <td>{{ variable \""lang_target_qty\"" }}</td>\r\n    <td>{{ variable \""lang_output_qty\"" }}</td>\r\n    <td>{{ variable \""lang_achieve_rate\"" }}</td>\r\n  </tr>\r\n\r\n  {{#each data}}\r\n  {{#if (eq color \""Yellow\"")}}\r\n  <tr class=\""yellow-row\"">\r\n    {{else if (eq color \""Green\"")}}\r\n  <tr class=\""green-row\"">\r\n    {{else if (eq color \""Blue\"")}}\r\n  <tr class=\""blue-row\"">\r\n    {{else if (eq color \""Gray\"")}}\r\n  <tr class=\""gray-row\"">\r\n    {{/if}}\r\n    <td>{{workshift}}</td>\r\n    <td>{{resourcegroup}}</td>\r\n    <td>{{status}}</td>\r\n    <td>{{formatnumber target}}</td>\r\n    <td>{{formatnumber outputs}}</td>\r\n    <td>{{formatpercent archieverate}}</td>\r\n  </tr>\r\n  {{/each}}\r\n</table>\r\n\r\n<style>\r\n  th,\r\n  td {\r\n    border: 3px solid black;\r\n    border-collapse: collapse;\r\n    height: auto;\r\n    width: auto;\r\n    font-weight: bold;\r\n  }\r\n\r\n  .PcgTable {\r\n    width: 100%;\r\n    height: 100%;\r\n    font-size: 85px;\r\n    text-align: center;\r\n    color: black;\r\n  }\r\n\r\n  .Pcgcolumn {\r\n    background-color: #003377;\r\n    color: white;\r\n    /* width: auto; */\r\n    /* 不需要再次设置宽度 */\r\n  }\r\n\r\n  .yellow-row {\r\n    background-color: rgb(250, 204, 46);\r\n  }\r\n\r\n  .green-row {\r\n    background-color: rgb(4, 180, 4);\r\n  }\r\n\r\n  .blue-row {\r\n    background-color: DodgerBlue;\r\n  }\r\n\r\n  .gray-row {\r\n    background-color: rgb(189, 189, 189);\r\n  }\r\n</style>"",""defaultContent"":""<div direction=\""right\"" height=\""150px\"" behavior=\""alternate\"">\r\n  <p style=\""font-size:100px; color:black; background-color:red;  text-align:center; font-weight:bold;\"">\r\n    No Produce Data</p>\r\n</div>"",""editor"":{""format"":""auto"",""height"":1721,""language"":""html""},""everyRow"":false,""helpers"":""// 實現千分位\r\nhandlebars.registerHelper('formatnumber', function (num) {\r\n  num = num + '';\r\n  return num.replace(/(?=(?!^)(?:\\d{3})+(?:\\.|$))(\\d{3}(\\.\\d+$)?)/g, ',$1');\r\n});\r\n\r\n\r\n\r\n//實現%\r\nhandlebars.registerHelper('formatpercent', function (num) {\r\n  num = num + '%';\r\n  return num;\r\n});\r\n""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""  WITH Temp1 as(\r\n  SELECT SPLIT_PART(workshift, '_', 3) AS workshift,\r\n  sum(target)target,resourcegroup  from kbn_sole_target where\r\n     workdate= (select to_char(current_date, 'YYYYMMDD'))\r\n     and datagroup IN ($Datagroup)\r\n     and workshift IN ($WorkShift)\r\n     and stepname IN ($StepName)\r\n     and resourcegroup IN ($Resourcegroup)\r\n     group by SPLIT_PART(workshift, '_', 3),resourcegroup\r\n   ),\r\n    Temp2 as(\r\n  SELECT SPLIT_PART(workshift, '_', 3) AS workshift,\r\n  sum(outputs)outputs,resourcegroup from kbn_sole_output where \r\n     workdate= (select to_char(current_date, 'YYYYMMDD'))\r\n     and datagroup IN ($Datagroup)\r\n     and workshift IN ($WorkShift)\r\n     and stepname IN ($StepName)\r\n     and resourcegroup IN ($Resourcegroup)\r\n     group by SPLIT_PART(workshift, '_', 3),resourcegroup\r\n   ) ,\r\n     Temp3 as (\r\n   SELECT SPLIT_PART(workshift, '_', 3) AS workshift,\r\n    sum(defectqty)defectqty,resourcegroup from kbn_sole_defect  where \r\n     workdate= (select to_char(current_date, 'YYYYMMDD'))\r\n     and datagroup IN ($Datagroup)\r\n     and workshift IN ($WorkShift)\r\n     and stepname IN ($StepName)\r\n     and resourcegroup IN ($Resourcegroup)\r\n     group by SPLIT_PART(workshift, '_', 3),resourcegroup\r\n   ),\r\n   \r\n   Temp4 as (\r\n    SELECT substring(Temp1.workshift FROM LENGTH(Temp1.workshift) - 7) AS workshift ,\r\n    substring( Temp1.resourcegroup FROM LENGTH(Temp1.resourcegroup) - 6) AS resourcegroup ,\r\n    coalesce(Temp1.target,0)as target ,\r\n    coalesce(Temp2.outputs,0)as outputs , \r\n    coalesce(round(Temp2.outputs/Temp1.target*100,1),0) as ArchieveRate,\r\n    coalesce((1 - (COALESCE(Temp3.defectqty, 0) / COALESCE(Temp2.outputs, 1))) * 100, 100) AS RFT\r\n\r\n    \r\n    from Temp1 left join temp2 on Temp1.workshift=Temp2.workshift and temp1.resourcegroup=temp2.resourcegroup\r\n    left join temp3  on Temp1.workshift=Temp3.workshift and temp1.resourcegroup=temp3.resourcegroup\r\n   \r\n   ) select workshift,resourcegroup,\r\n   CASE  \r\n   when (outputs)=0        then 'Not Start'\r\n   when (outputs-target)>0 then 'Over Target'\r\n   when (outputs-target)=0 then 'Completed'\r\n   when (outputs-target)<0 then 'On Going'\r\n   end  as status\r\n   ,target,outputs,ArchieveRate,RFT,\r\n   CASE  \r\n   when (outputs)=0        then 'Gray'\r\n   when (outputs-target)>0 then 'Yellow'\r\n   when (outputs-target)=0 then 'Green'\r\n   when (outputs-target)<0 then 'Blue'\r\n   end  as color\r\n   from  Temp4\r\n   order by workshift, resourcegroup\r\n   limit 5"",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""hide"":false,""refId"":""B""}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""},{""collapsed"":false,""gridPos"":{""h"":1,""w"":24,""x"":0,""y"":34},""id"":9,""panels"":[],""type"":""row""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[{Datagroupvariable.ToString()}],""value"":[{Datagroupvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct data_group from parm_line_m"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Datagroup"",""options"":[],""query"":""select distinct data_group from parm_line_m"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{shiftvariable.ToString()}],""value"":[{shiftvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct shift from parm_time_std"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""WorkShift"",""options"":[],""query"":""select distinct shift from parm_time_std"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Stepnamevariable.ToString()}],""value"":[{Stepnamevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""StepName"",""options"":[],""query"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Resourcevariable.ToString()}],""value"":[{Resourcevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Resourcegroup"",""options"":[],""query"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""isNone"":true,""selected"":false,""text"":[{Productkindvariable.ToString()}],""value"":[{Productkindvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""hide"":0,""includeAll"":false,""label"":""ProductKind"",""multi"":true,""name"":""ProductKind"",""options"":[],""query"":""select distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{language}"",""value"":""{language}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""超产"",""value"":""超产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_over_target"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""各机群生产进度"",""value"":""各机群生产进度""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_resource_product_progress'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_resource_product_progress"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_resource_product_progress'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""完工"",""value"":""完工""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_completed"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产中"",""value"":""生产中""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_ongoing"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""未投产"",""value"":""未投产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_not_start"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""Shift"",""value"":""Shift""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_shift'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_shift"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_shift'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""机群"",""value"":""机群""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_resource_group'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_resource_group"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_resource_group'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产状态"",""value"":""生产状态""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""达成率"",""value"":""达成率""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_achieve_rate'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_achieve_rate"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_achieve_rate'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""目标数"",""value"":""目标数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产数"",""value"":""生产数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_output_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_output_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""now-6h"",""to"":""now""},""timepicker"":{""refresh_intervals"":[""5s"",""10s"",""30s"",""1m"",""5m"",""15m"",""30m"",""1h"",""2h"",""1d""]},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20210800000428,1704959086696
"9S-NFYvYSF67gllnGKVFo5",mes-sole,sole_style5,Type5:投產狀況(by機群),"{""dashboard"":{""annotations"":{""list"":[{""builtIn"":1,""datasource"":{""type"":""grafana"",""uid"":""-- Grafana --""},""enable"":true,""hide"":true,""iconColor"":""rgba(0, 211, 255, 1)"",""name"":""Annotations & Alerts"",""target"":{""limit"":100,""matchAny"":false,""tags"":[],""type"":""dashboard""},""type"":""dashboard""}]},""editable"":true,""fiscalYearStartMonth"":0,""graphTooltip"":0,""id"":1328,""links"":[],""liveNow"":false,""panels"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":24,""x"":0,""y"":0},""id"":15,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<ul class=\""example\"">\r\n    <p class=\""active\"" id =\""sole\""></p>\r\n    <p id =\""clock\""></p>\r\n</ul>\r\n\r\n\r\n\r\n<script>\r\n  \r\n  var WorkShift = \""$WorkShift\"";\r\n  var n = 8; // 取前三位\r\n  var resultWorkShift = WorkShift.slice(-n);\r\n  document.getElementById(\""sole\"").innerText =\""\\xa0\\xa0\"" + \""${lang_resource_production_status} /\"" + \""\\xa0\\xa0\"" +  \""${ProductKind}_\"" + resultWorkShift;\r\n\r\n    //右側時間\r\n    $(\""#clock\"").ready(function(){\r\n        updateClock();\r\n    });\r\n\r\n    function updateClock(){\r\n        let d = new Date();\r\n        let year = d.getFullYear();\r\n        let month = pad(d.getMonth()+1);\r\n        let day = pad(d.getDate());\r\n        $(\""#clock\"").html(year+\""/\""+month+\""/\""+day+\"" \""+\""\\xa0\\xa0\\xa0\"");\r\n    }\r\n\r\n    function pad(v){\r\n        return (v<10)?'0'+v:v\r\n    }    \r\n\r\n\r\n</script>\r\n\r\n\r\n\r\n\r\n<style type=\""text/css\"">\r\n    .example {\r\n        overflow: hidden;\r\n        background: #A7B6E2;\r\n        height: 160px;\r\n        padding: 0;\r\n        line-height: 160px;\r\n        color: #2B4182;\r\n        font-weight:bold;\r\n        font-size:60px;\r\n        margin:0px 0px 0px -24px; /*上右下左*/\r\n    }\r\n\r\n    .example > p {\r\n        float: left;\r\n        position: relative;\r\n        width: 50%;\r\n        text-align: right;\r\n        list-style: none;\r\n        height: 100%;\r\n    }\r\n\r\n    .example > p:before, .example > p:after {\r\n        position: absolute;\r\n        top: 0;\r\n    }\r\n\r\n    .example > p:before {\r\n        width: 160px;\r\n        height: 160px;\r\n        right: -159px;\r\n        background: inherit;\r\n    }\r\n\r\n    .example > p:after {\r\n        right: -160px;\r\n        border: 80px solid;\r\n        border-color: transparent #A7B6E2 #A7B6E2 transparent;\r\n        \r\n    }\r\n\r\n    .example > p.active {\r\n        background: -webkit-linear-gradient(top, #627CCB, #627CCB 50%, #5470C6 50%, #5470C6);\r\n        text-align: left;\r\n        color:#FCEC03;\r\n    }\r\n\r\n    .example > p.active:before, .example > p.active:after {\r\n        content: '';\r\n        \r\n    }\r\n</style>\r\n"",""mode"":""html""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":4,""y"":5},""id"":13,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:85px; color:White; background-color:#FACC2E;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_over_target}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":9,""y"":5},""id"":16,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:90px; color:White; background-color:#04B404; text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_completed}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":14,""y"":5},""id"":17,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:100px; color:White; background-color:rgb(84, 112, 198);  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_ongoing}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""gridPos"":{""h"":5,""w"":5,""x"":19,""y"":5},""id"":18,""options"":{""code"":{""language"":""plaintext"",""showLineNumbers"":false,""showMiniMap"":false},""content"":""<div direction=\""right\"" height=\""150px\""  behavior=\""alternate\"">\n  <p style=\""font-size:92px; color:White; background-color:#BDBDBD;  text-align:center; font-weight:bold; border-radius: 30px;\"">${lang_pdstatus_not_start}</p>\n</div>\n"",""mode"":""markdown""},""pluginVersion"":""10.1.2"",""type"":""text""},{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""description"":"""",""gridPos"":{""h"":23,""w"":24,""x"":0,""y"":10},""id"":24,""options"":{""content"":""<style>\r\n  /* 設定表格的樣式 */\r\n  table {\r\n    font-size: 100px;\r\n    width: auto;\r\n    border-collapse: collapse;\r\n  }\r\n\r\n  /* 設定表格頭部和資料行的共用樣式 */\r\n  th,\r\n  td {\r\n    border: 3px solid white;\r\n    border-collapse: collapse;\r\n    width: auto;\r\n    font-weight: bold;\r\n    padding: 8px;\r\n    text-align: center;\r\n  }\r\n\r\n  /* 設定整個表格的樣式 */\r\n  .PcgTable {\r\n    width: 100%;\r\n    height: auto;\r\n    font-size: 75px;\r\n    text-align: center;\r\n  }\r\n\r\n  /* 設定表格頭部的樣式 */\r\n  .Pcgcolumn {\r\n    background-color: rgb(84, 112, 198);\r\n    color: white;\r\n    height: auto;\r\n  }\r\n\r\n  /* 設定表格資料行的樣式 */\r\n  .Pcgcolumn1 {\r\n    color: white;\r\n    height: auto;\r\n  }\r\n\r\n  /* 設定長條圖區塊的樣式 */\r\n  .bar-chart-cell {\r\n    position: relative;\r\n    display: flex;\r\n    align-items: center;\r\n    height: 60px;\r\n    background-color: #BDBDBD;\r\n    border-radius: 10px;\r\n  }\r\n\r\n  /* 設定長條圖的樣式 */\r\n  .bar-chart-bar {\r\n    position: relative;\r\n    height: 100%;\r\n    background-color: #3498db;\r\n    width: 0;\r\n    transition: width 0.5s ease-in-out;\r\n    animation: fillBar 1s ease-in-out forwards;\r\n  }\r\n\r\n  /* 設定長條圖數值的樣式 */\r\n  .bar-chart-value {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    font-weight: bold;\r\n    color: white;\r\n    transition: left 0.5s ease-in-out;\r\n  }\r\n\r\n  /* 設定長條圖為綠色的樣式 */\r\n  .bar-chart-bar.green {\r\n    background-color: #2ecc71;\r\n  }\r\n\r\n  /* 設定長條圖為黃色的樣式 */\r\n  .bar-chart-bar.yellow {\r\n    background-color: #f1c40f;\r\n  }\r\n\r\n  /* 設定長條圖為藍色的樣式 */\r\n  .bar-chart-bar.blue {\r\n    background-color: #3498db;\r\n  }\r\n\r\n  /* 調整 Productprogress 欄位寬度 */\r\n  td:nth-child(1) {\r\n    width: 30%;\r\n  }\r\n\r\n\r\n  td:nth-child(4) {\r\n    width: 25%;\r\n  }\r\n\r\n  td:nth-child(5) {\r\n    width: 50%;\r\n  }\r\n\r\n  @keyframes fillBar {\r\n    from {\r\n      width: 0;\r\n    }\r\n\r\n    to {\r\n      width: calc(var(--progress) * 100%);\r\n    }\r\n  }\r\n</style>\r\n\r\n<table class=\""PcgTable\"">\r\n  <tr class=\""Pcgcolumn\"">\r\n    <td>{{ variable \""lang_resource_group\"" }}</td>\r\n    <td>{{ variable \""lang_target_qty\""}}</td>\r\n    <td>{{ variable \""lang_shortage\"" }}</td>\r\n    <td>{{ variable \""lang_achieve_rate\"" }}</td>\r\n    <td>{{ variable \""lang_product_progress\"" }}</td>\r\n  </tr>\r\n\r\n  {{#each data}}\r\n  <tr class=\""Pcgcolumn1\"">\r\n    <td>{{resourcegroup}}</td>\r\n    <td>{{formatnumber target}}</td>\r\n    <td>{{formatnumber shortage}}</td>\r\n    <td>{{formatpercent archieverate}}</td>\r\n    <td>\r\n      <div class=\""bar-chart-cell\"">\r\n        <div\r\n          class=\""bar-chart-bar {{#if (eq outputs target)}}green{{else}}{{#if (gt outputs target)}}yellow{{else}}blue{{/if}}{{/if}}\""\r\n          style=\""--progress: {{outputs}} / {{target}};\"">\r\n          {{#if outputs}}\r\n          <div class=\""bar-chart-value\"">{{outputs}}</div>\r\n          {{/if}}\r\n        </div>\r\n      </div>\r\n    </td>\r\n  </tr>\r\n  {{/each}}\r\n</table>"",""defaultContent"":""<div direction=\""right\"" height=\""150px\"" behavior=\""alternate\"">\r\n  <p style=\""font-size:120px; color:black; background-color:red;  text-align:center; font-weight:bold;\"">\r\n    No Produce data</p>\r\n\r\n</div>"",""editor"":{""format"":""auto"",""height"":1051,""language"":""html""},""everyRow"":false,""helpers"":""// 實現千分位\r\nhandlebars.registerHelper('formatnumber', function (num) {\r\n     if (num === undefined) {\r\n          return '';\r\n     }\r\n     num = num + '';\r\n     return num.replace(/(?=(?!^)(?:\\d{3})+(?:\\.|$))(\\d{3}(\\.\\d+$)?)/g, ',$1');\r\n});\r\n\r\n\r\n//實現%\r\nhandlebars.registerHelper('formatpercent', function (num) {\r\n     num = num + '%';\r\n     return num;\r\n});""},""targets"":[{""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""editorMode"":""code"",""format"":""table"",""group"":[],""metricColumn"":""none"",""rawQuery"":true,""rawSql"":""   WITH Temp1 as(\r\n  SELECT SPLIT_PART(workshift, '_', 3) AS workshift,\r\n   sum(target)target,resourcegroup  from kbn_sole_target where\r\n     workdate=(select to_char(current_date, 'YYYYMMDD'))\r\n     and datagroup IN ($Datagroup)\r\n     and workshift IN ($WorkShift)\r\n     and stepname IN ($StepName)\r\n     and resourcegroup IN ($Resourcegroup)\r\n     group by SPLIT_PART(workshift, '_', 3),resourcegroup\r\n   ),\r\n    Temp2 as(\r\n   SELECT SPLIT_PART(workshift, '_', 3) AS workshift, sum(outputs)outputs,resourcegroup from kbn_sole_output where \r\n     workdate=(select to_char(current_date, 'YYYYMMDD'))\r\n     and datagroup IN ($Datagroup)\r\n     and workshift IN ($WorkShift)\r\n     and stepname IN ($StepName)\r\n     and resourcegroup IN ($Resourcegroup)\r\n     group by SPLIT_PART(workshift, '_', 3),resourcegroup\r\n   ) ,\r\n\r\n   Temp3 as (\r\n    select Temp1.workshift,\r\n    substring( Temp1.resourcegroup FROM LENGTH(Temp1.resourcegroup) - 6) AS resourcegroup ,\r\n    coalesce(Temp1.target,0)as target ,\r\n    coalesce(Temp2.outputs,0)as outputs , \r\n    coalesce((Temp1.target-Temp2.outputs),0)as Shortage,\r\n    coalesce(round(Temp2.outputs/Temp1.target*100,1),0) as ArchieveRate\r\n    from Temp1 left join temp2 on Temp1.workshift=Temp2.workshift and temp1.resourcegroup=temp2.resourcegroup\r\n   )select *from Temp3\r\norder by resourcegroup asc\r\nlimit 5 "",""refId"":""A"",""select"":[[{""params"":[""value""],""type"":""column""}]],""sql"":{""columns"":[{""parameters"":[],""type"":""function""}],""groupBy"":[{""property"":{""type"":""string""},""type"":""groupBy""}],""limit"":50},""timeColumn"":""time"",""where"":[{""name"":""$__timeFilter"",""params"":[],""type"":""macro""}]}],""transparent"":true,""type"":""marcusolsson-dynamictext-panel""},{""collapsed"":false,""gridPos"":{""h"":1,""w"":24,""x"":0,""y"":33},""id"":9,""panels"":[],""type"":""row""}],""refresh"":"""",""schemaVersion"":38,""style"":""dark"",""tags"":[],""templating"":{""list"":[{""current"":{""selected"":true,""text"":[{Datagroupvariable.ToString()}],""value"":[{Datagroupvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct data_group from parm_line_m"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""Datagroup"",""options"":[],""query"":""select distinct data_group from parm_line_m"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":[{shiftvariable.ToString()}],""value"":[{shiftvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct shift from parm_time_std"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""WorkShift"",""options"":[],""query"":""select distinct shift from parm_time_std"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Stepnamevariable.ToString()}],""value"":[{Stepnamevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""StepName"",""options"":[],""query"":""select distinct mes_step from parm_line_m      where data_group in  ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Resourcevariable.ToString()}],""value"":[{Resourcevariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""hide"":1,""includeAll"":false,""multi"":true,""name"":""Resourcegroup"",""options"":[],""query"":""select distinct line_no from  parm_line_m   where data_group in\n($Datagroup)  order by line_no"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":true,""text"":[{Productkindvariable.ToString()}],""value"":[{Productkindvariable.ToString()}]},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""\nselect distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""hide"":0,""includeAll"":false,""multi"":true,""name"":""ProductKind"",""options"":[],""query"":""\nselect distinct product_kind from parm_line_m\nWHERE data_group  IN ($Datagroup)"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""{language}"",""value"":""{language}""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""language"",""options"":[],""query"":""select lang_label as __text, lang_no as __value\nfrom v_language_list\nwhere app_no='kanban'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""各机群投产状况"",""value"":""各机群投产状况""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_resource_production_status'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_resource_production_status"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_resource_production_status'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""超产"",""value"":""超产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_over_target"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_over_target'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""完工"",""value"":""完工""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_completed"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_completed'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产中"",""value"":""生产中""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_ongoing"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_ongoing'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""未投产"",""value"":""未投产""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_pdstatus_not_start"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_pdstatus_not_start'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""机群"",""value"":""机群""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_resource_group'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_resource_group"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_resource_group'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""达成率"",""value"":""达成率""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_achieve_rate'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_achieve_rate"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_achieve_rate'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""欠数"",""value"":""欠数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_shortage'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_shortage"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_shortage'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""目标数"",""value"":""目标数""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_target_qty"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_target_qty'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""},{""current"":{""selected"":false,""text"":""生产进度"",""value"":""生产进度""},""datasource"":{""type"":""postgres"",""uid"":""{DataSourceUid}""},""definition"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_product_progress'"",""hide"":2,""includeAll"":false,""multi"":false,""name"":""lang_product_progress"",""options"":[],""query"":""select lang_data from v_key_translation\nwhere app_no='kanban'\nand lang_no='$language'\nand lang_key='lang_product_progress'"",""refresh"":1,""regex"":"""",""skipUrlSync"":false,""sort"":0,""type"":""query""}]},""time"":{""from"":""now-6h"",""to"":""now""},""timepicker"":{""refresh_intervals"":[""5s"",""10s"",""30s"",""1m"",""5m"",""15m"",""30m"",""1h"",""2h"",""1d""]},""timezone"":"""",""id"":null,""title"":""{title}"",""weekStart"":""""},""folderUid"":""{FolderUid}"",""overwrite"":true}",Y,20210800000428,1704959096675
